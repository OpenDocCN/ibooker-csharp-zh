<html><head></head><body><section class="pagenumrestart" data-pdf-bookmark="Chapter 1. Start Building with c#: Build something great&#x2026;fast!" data-type="chapter" epub:type="chapter"><div class="chapter" id="start_building_with_chash_build_somethin">
<h1><span class="label">Chapter 1. </span>Start Building with c#: <em>Build something great…fast!</em></h1>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/001fig01.png"/>
<h6/>
</div></figure>
<p><strong>Want to build great apps…right now?</strong></p>
<p>With C#, you’ve got a <strong>modern programming language</strong> and a <strong>valuable tool</strong> at your fingertips. And with <strong>Visual Studio</strong>, you’ve got an <strong>amazing development environment</strong> with highly intuitive features that make coding as easy as possible. Not only is Visual Studio a great tool for writing code, it’s also a <strong>really valuable learning tool</strong> for exploring C#. Sound appealing? Turn the page, and let’s get coding.</p>
<section data-pdf-bookmark="Why you should learn C#" data-type="sect1"><div class="sect1" id="why_you_should_learn_chash">
<h1>Why <u>you</u> should learn C#</h1>
<p><a data-primary=".NET Core" data-type="indexterm" id="idm46402350112968"/><a data-primary=".NET desktop development" data-type="indexterm" id="idm46402350111816"/><a data-primary="C#" data-secondary="benefits of learning" data-type="indexterm" id="idm46402350111048"/><a data-primary="Mac requirements" data-type="indexterm" id="idm46402350110040"/><a data-primary="Unity" data-secondary="installing with Unity Hub" data-type="indexterm" id="idm46402350109272"/><a data-primary="Visual Studio" data-secondary="website" data-type="indexterm" id="idm46402350108264"/><a data-primary="Windows" data-secondary="requirements for" data-type="indexterm" id="idm46402350107224"/>C# is a simple, modern language that lets you do incredible things. When you learn C#, you’re learning more than just a language. C# unlocks the whole world of .NET, an incredibly powerful open source platform for building all sorts of applications.</p>
<section data-pdf-bookmark="Visual Studio is your gateway to C#" data-type="sect2"><div class="sect2" id="visual_studio_is_your_gateway_to_chash">
<h2>Visual Studio is your gateway to C#</h2>
<p>If you haven’t installed Visual Studio 2019 yet, this is the time to do it. Go to <a href="https://visualstudio.microsoft.com/">https://visualstudio.microsoft.com</a> and <strong>download the Visual Studio Community edition</strong>. (If it’s already installed, run the Visual Studio Installer to update your installed options.)</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Make sure you’re installing Visual Studio, and <u>not</u> installing Visual Studio Code.</span></p>
<p><span style="color:#9D9EA0;">Visual Studio Code is an amazing open source, cross-platform code editor, but it’s not tailored to .NET development the way Visual Studio is. That’s why we can use Visual Studio throughout this book as a tool for learning and exploration.</span></p>
</div>
</div></section>
<section data-pdf-bookmark="If you’re on Windows..." data-type="sect2"><div class="sect2" id="if_youapostrophere_on_windowshellip">
<h2>If you’re on Windows...</h2>
<p>Make sure to check the options to install support for .NET Core cross-platform development and .NET desktop development. But <u>don’t</u> check the <em>Game development with Unity</em> option—you’ll be doing 3D game development with Unity later in the book, but you’ll install Unity separately.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/002fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="If you’re on a Mac..." data-type="sect2"><div class="sect2" id="if_youapostrophere_on_a_machellip">
<h2>If you’re on a Mac...</h2>
<p>Download and run the Visual Studio for Mac installer. Make sure the .NET Core target is checked.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/002fig02.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You can do the ASP.NET projects on Windows too! Just make sure that the “ASP.NET and web development” option is checked when you install Visual Studio.</span></p>
</div>
<p><strong>Most projects in this book are .NET Core console apps, which work on both Windows and Mac. Some chapters have a project—like the animal matching game later in this chapter—that are Windows desktop projects. For these projects, use the <span style="color:#9D9EA0;">ASP.NET Core Blazor projects</span> appendix. It has a <u><em>complete replacement</em></u> for <a href="#start_building_with_chash_build_somethin">#start_building_with_chash_build_somethin</a>, and ASP.NET Core Blazor versions of the other WPF projects.</strong></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Visual Studio is a tool for writing code and exploring C#" data-type="sect1"><div class="sect1" id="visual_studio_is_a_tool_for_writing_code">
<h1>Visual Studio is a tool for writing code <u>and</u> exploring C#</h1>
<p><a data-primary="UI (user interface)" data-secondary="creating using Visual Designer" data-type="indexterm" id="idm46402350085096"/><a data-primary="Visual Designer" data-type="indexterm" id="idm46402350084088"/><a data-primary="Visual Studio" data-secondary="about" data-type="indexterm" id="idm46402350081784"/><a data-primary="Visual Studio" data-secondary="for Mac" data-type="indexterm" id="idm46402350080776"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402350079768"/><a data-primary="XAML" data-secondary="combining with C#, creating wisual programs" data-type="indexterm" id="idm46402350079000"/>You could use Notepad or another text editor to write your C# code, but there’s a better way. An <strong>IDE</strong>—that’s short for <strong><em><u>i</u>ntegrated <u>d</u>evelopment <u>e</u>nvironment</em></strong>—is a text editor, visual designer, file manager, debugger…it’s like a multitool for everything you need to write code.</p>
<p>These are just a few of the things that Visual Studio helps you do:</p>
<ol>
<li><p><strong>Build an application, FAST.</strong> The C# language is flexible and easy to learn, and the Visual Studio IDE makes it easier by doing a lot of manual work for you automatically. Here are just a few things that Visual Studio does for you:</p>
<ul>
<li><p>Manages all your project files</p></li>
<li><p>Makes it easy to edit your project’s code</p></li>
<li><p>Keeps track of your project’s graphics, audio, icons, and other resources</p></li>
<li><p>Helps you debug your code by stepping through it line by line</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/003fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Design a great-looking user interface.</strong> The Visual Designer in the Visual Studio IDE is one of the easiest-to-use design tools out there. It does so much for you that you’ll find that creating user interfaces for your programs is one of the most satisfying parts of developing a C# application. You can build full-featured professional programs without having to spend hours tweaking your user interface (unless you want to).</p></li>
<li><p><strong>Build visually stunning programs.</strong> When you <strong>combine C# with XAML</strong>, the visual markup language for designing user interfaces for WPF desktop applications, you’re using one of the most effective tools around for creating visual programs... and you’ll use it to build software that looks as great as it acts.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">If you’re using Visual Studio for Mac, you’ll build the same great-looking apps, but instead of using XAML you’ll do it by combining C# with HTML.</span></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Visual Studio is an amazing development environment, but we’re also going to use it as a learning tool to explore C#.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>The</strong> <span style="color:#9D9EA0;">user interface</span> <strong>(or</strong> <span style="color:#9D9EA0;">UI</span><strong>) for any WPF is built with XAML (which stands for e<u>X</u>tensible</strong> <strong><u>A</u>pplication</strong> <strong><u>M</u>arkup</strong> <strong><u>L</u>anguage). Visual Studio makes it really easy to work with XAML.</strong></p>
</div>
</li>
<li><p><strong>Learn and explore C# and .NET.</strong> Visual Studio is a world-class development tool, but lucky for us it’s <u>also</u> a fantastic learning tool. <strong><em>We’re going to use <u>the IDE</u> to explore C#</em></strong>, which gives us a fast track for getting important programming concepts into your brain <em>fast</em>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">We’ll often refer to Visual Studio as just “the IDE” throughout this book.</span></p>
</div></li>
</ol>
</div></section>
<section data-pdf-bookmark="Create your first project in Visual Studio" data-type="sect1"><div class="sect1" id="create_your_first_project_in_visual_stud">
<h1>Create your first project in Visual Studio</h1>
<p><a data-primary="console applications" data-type="indexterm" id="idm46402349724072"/><a data-primary="Visual Studio" data-secondary="creating new project" data-type="indexterm" id="idm46402349723336"/>The best way to learn C# is to start writing code, so we’re going to use Visual Studio to <strong>create a new project</strong>…and start writing code immediately!</p>
<ol>
<li><p><strong>Create a new Console App (.NET Core) project.</strong></p>
<p>Start up Visual Studio 2019. When it first starts up, it shows you a “Create a new project” window with a few different options. Choose <strong>Create a new project</strong>. Don’t worry if you dismiss the window—you can always get it back by choosing File &gt;&gt; New &gt;&gt; Project from the menu.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="do_thisexclamation_mark">
<h5>Do this!</h5>
<p>When you see Do this! (or Now do this!, or Debug this!, etc.), go to Visual Studio and follow along. We’ll tell you exactly what to do, and point out what to look for to get the most out of the example we show you.</p>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/004fig01.png"/>
<h6/>
</div></figure>
<p>Choose the <strong>Console App (.NET Core)</strong> project type by clicking on it, then press the <strong>Next</strong> button.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/004fig02.png"/>
<h6/>
</div></figure>
<p>Name your project <strong>MyFirstConsoleApp</strong> and click the <strong>Create</strong> button.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/004fig03.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><em>If you’re using <strong>Visual Studio for Mac</strong>, the code for this project—and <u>all</u> .NET Core Console App projects in this book—will be the same, but some IDE features will be different. Go to the</em> <strong>Visual Studio for Mac Learner’s Guide</strong> <em>appendix for the Mac version of this chapter.</em></p>
</div>
</li>
<li><p><strong>Look at the code for your new app.</strong></p>
<p>When Visual Studio creates a new project, it gives you a starting point that you can build on. As soon as it finishes creating the new files for the app, it should open a file called <em>Program.cs</em> with this code:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/004fig05.png"/>
<h6/>
</div></figure>
</li>
<li><p><a data-primary="Microsoft Visual Studio Debug Console window" data-type="indexterm" id="idm46402349702952"/><strong>Run your new app.</strong></p>
<p>The app Visual Studio created for you is ready to run. At the top of the Visual Studio IDE, find the button with a green triangle and your app’s name and click it:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/005fig01.png"/>
<h6/>
</div></figure>
</li>
<li><p><strong>Look at your program’s output.</strong></p>
<p>When you run your program, the <strong>Microsoft Visual Studio Debug Console window</strong> will pop up and show you the output of the program:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/005fig02.png"/>
<h6/>
</div></figure>
</li>
</ol>
<p>The best way to learn a language is to write a lot of code in it, so you’re going to build a lot programs in this book. Many of them will be .NET Core Console App projects, so let’s have a closer look at what you just did.</p>
<p>At the top of the window is the <strong>output of the program</strong>:</p>
<p><strong>Hello World!</strong></p>
<p>Then there’s a line break, followed by some additional text:</p>
<pre data-type="programlisting">C:\<em>path-to-your-project-folder</em>\MyFirstConsoleApp\MyFirstConsoleApp\bin\Debug\
netcoreapp3.1\MyFirstConsoleApp.exe (process <em>####</em>) exited with code 0.
To automatically close the console when debugging stops, enable Tools-&gt;
Options-&gt;Debugging-&gt;Automatically close the console when debugging stops.
Press any key to close this window . . .</pre>
<p>You’ll see the same message at the bottom of every Debug Console window. Your program printed a single line of text (<code><strong>Hello World!</strong></code>) and then exited. Visual Studio is keeping the output window open until you press a key to close it so you can see the output before the window disappears.</p>
<p>Press a key to close the window. Then run your program again. This is how you’ll run all of the .NET Core Console App projects that you’ll build throughout the book.</p>
</div></section>
<section data-pdf-bookmark="Let’s build a game!" data-type="sect1"><div class="sect1" id="letapostrophes_build_a_gameexclamation_m">
<h1>Let’s build a game!</h1>
<p><a data-primary="ASP.NET Core" data-type="indexterm" id="idm46402349690600"/><a data-primary="Visual Studio" data-secondary="for Mac" data-type="indexterm" id="idm46402349689864"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402349685928"/>You’ve built your first C# app, and that’s great! Now that you’ve done that, let’s build something a little more complex. We’re going to build an <strong>animal matching game</strong>, where a player is shown a grid of 16 animals and needs to click on pairs to make them disappear.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/006fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00004">
<p><strong>Building different kinds of projects is an important tool in your C# learning toolbox. We chose WPF (or Windows Presentation Foundation) for some of the projects in this book because it gives you tools to design highly detailed user interfaces that run on many different versions of Windows, even very old editions like Windows XP.</strong></p>
<p><strong>But C# isn’t just for Windows!</strong></p>
<p><strong>Are you a Mac user? Well, then you’re in luck! We added a learning path just for you, featuring <span style="color:#9D9EA0;"><u>Visual Studio for Mac</u></span>. See the Visual Studio for Mac Learner’s Guide appendix at the end of this book. It has a complete replacement for this chapter, and Mac versions of all of the WPF projects that appear throughout the book.</strong></p>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The Mac versions of the WPF projects use ASP.NET Core. You can build ASP.NET Core projects on Windows, too.</span></p>
</div>
<section data-pdf-bookmark="Your animal matching game is a WPF app" data-type="sect2"><div class="sect2" id="your_animal_matching_game_is_a_wpf_app">
<h2>Your animal matching game is a WPF app</h2>
<p>Console apps are great if you just need to input and output text. If you want a visual app that’s displayed in a window, you’ll need to use a different technology. That’s why your animal matching game will be a <strong>WPF app</strong>. WPF—or Windows Presentation Foundation—lets you create desktop applications that can run on any version of Windows. Most of the chapters in this book will feature one WPF app. The goal of this project is to introduce you to WPF and give you tools to build visually stunning desktop applications as well as console apps.</p>
<blockquote>
<p><strong>By the time you’re done with this project, you’ll be a lot more familiar with the tools that you’ll rely on throughout this book to learn and explore C#.</strong></p>
</blockquote>
</div></section>
</div></section>
<section data-pdf-bookmark="Here’s how you’ll build your game" data-type="sect1"><div class="sect1" id="hereapostrophes_how_youapostrophell_buil">
<h1>Here’s how you’ll build your game</h1>
<p><a data-primary="emoji" data-type="indexterm" id="idm46402349674664"/><a data-primary="Game design... and beyond elements" data-secondary="What Is a Game?" data-type="indexterm" id="idm46402349673928"/><a data-primary="What Is a Game? game design... and beyond element" data-type="indexterm" id="idm46402349672952"/>The rest of this chapter will walk you through building your animal matching game, and you’ll be doing it in a series of separate parts:</p>
<ol>
<li><p>First you’ll create a new desktop application project in Visual Studio.</p></li>
<li><p>Then you’ll use XAML to build the window.</p></li>
<li><p>You’ll write C# code to add random animal emoji to the window.</p></li>
<li><p>The game needs to let the user click on pairs of emoji to match them.</p></li>
<li><p>Finally, you’ll make the game more exciting by adding a timer.</p></li>
</ol>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">This project can take anywhere from 15 minutes to an hour, depending on how quickly you type. We learn better when we don’t feel rushed, so give yourself plenty of time.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/007fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="what_is_a_gamequestion_mark">
<h5><span class="inlineimage"><img alt="Images" src="assets/game.png"/></span> What is a game?</h5>
<p><strong>Game design... and beyond</strong></p>
<p>It may seem obvious what a game is. But think about it for a minute—it’s not as simple as it seems.</p>
<ul>
<li><p>Do all games have a <strong>winner</strong>? Do they always end? Not necessarily. What about a flight simulator? A game where you design an amusement park? What about a game like The Sims?</p></li>
<li><p>Are games always <strong>fun</strong>? Not for everyone. Some players like a “grind” where they do the same thing over and over again; others find that miserable.</p></li>
<li><p>Is there always <strong>decision making, conflict, or problem solving</strong>? Not in all games. Walking simulators are games where the player just explores an environment, and there are often no puzzles or conflict at all.</p></li>
<li><p>It’s actually pretty hard to pin down exactly what a game is. If you read textbooks on game design, you’ll find all sorts of competing definitions. So for our purposes, let’s define the <strong>meaning of “game”</strong> like this:</p></li>
</ul>
<p><strong>A game is a program that lets you play with it in a way that (hopefully) is at least as entertaining to play as it is to build.</strong></p>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Keep an eye out for these “Game design…and beyond” elements scattered throughout the book. We’ll use game design principles as a way to learn and explore important programming concepts and ideas that apply to any kind of project, not just video games.</span></p>
</div>
</div></section>
<section data-pdf-bookmark="Create a WPF project in Visual Studio" data-type="sect1"><div class="sect1" id="create_a_wpf_project_in_visual_studio">
<h1>Create a WPF project in Visual Studio</h1>
<p><a data-primary="Visual Studio" data-secondary="creating new WPF project" data-type="indexterm" id="idm46402349648504"/>Go ahead and <strong>start up a new instance of Visual Studio 2019</strong> and create a new project:</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">We’re done with the Console App project you created in the first part of this chapter, so feel free to close that instance of Visual Studio.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/008fig01.png"/>
<h6/>
</div></figure>
<p>We’re going to build our game as a desktop app using WPF, so <strong>select WPF App (.NET Core)</strong> and click Next:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/008fig02.png"/>
<h6/>
</div></figure>
<p>Visual Studio will ask you to configure your project. <strong>Enter MatchGame as the project name</strong> (and you can also change the location to create the project if you’d like):</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/008fig03.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/008fig03a.png"/>
<h6/>
</div></figure>
<p>Click the Create button. Visual Studio will create a new project called MatchGame.</p>
<section data-pdf-bookmark="Visual Studio created a project folder full of files for you" data-type="sect2"><div class="sect2" id="visual_studio_created_a_project_folder_f">
<h2>Visual Studio created a project folder <u>full</u> of files for you</h2>
<p>As soon as you created the new project, Visual Studio added a new folder called MatchGame and filled it with all of the files and folders that your project needs. You’ll be making changes to two of these files, <em>MainWindow.xaml</em> and <em>MainWindow.xaml.cs</em>.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/008fig04.png"/>
<h6/>
</div></figure>
<p><strong>If you run into any trouble with this project, go to our GitHub page and look for a link to a video walkthrough: <a href="https://github.com/head-first-csharp/fourth-edition">https://github.com/head-first-csharp/fourth-edition</a>.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0001">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><a data-primary="colors, selecting color scheme in Visual Studio" data-type="indexterm" id="idm46402349627064"/><a data-primary="Error List window" data-type="indexterm" id="idm46402349626328"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="Visual Studio IDE" data-type="indexterm" id="idm46402349625592"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="Visual Studio IDE" data-type="indexterm" id="idm46402349624376"/><a data-primary="Toolbox window" data-type="indexterm" id="idm46402349623400"/><a data-primary="Visual Designer" data-type="indexterm" id="idm46402349622664"/><a data-primary="Visual Studio" data-secondary="Sharpen your pencil exercise" data-type="indexterm" id="idm46402349621928"/><span style="color:#9D9EA0;">The pencil-and-paper exercises throughout the book aren’t optional. They’re an important part of learning, practicing, and leveling up your C# skills.</span></p>
</div></aside>
<p>Adjust your IDE to match the screenshot below. First, <strong>open <em>MainWindow.xaml</em></strong> by double-clicking on it in the Solution Explorer window. Then <u>open the <em>Toolbox</em> and <em>Error List</em> windows</u> by <strong>choosing them from the View menu</strong>. You can actually figure out the purpose of many of these windows and files based on their names and common sense! Take a minute and <strong>fill in each of the blanks</strong>—try to fill in a note about what each part of the Visual Studio IDE does. We’ve done one to get you started. See if you can take an educated guess at the others.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/009fig01.png"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> <strong>Sharpen your pencil Solution</strong></p>
<p><a data-primary="Visual Designer" data-type="indexterm" id="idm46402349612792"/>We’ve filled in the annotations about the different sections of the Visual Studio C# IDE. You may have some different things written down, but hopefully you were able to figure out the basics of what each window and section of the IDE is used for. Don’t worry if you came up with a slightly different answer from us! You’ll get LOTS of practice using the IDE.</p>
<p><em>And just a quick reminder: we’ll use the terms “Visual Studio” and “the IDE”</em> <strong><em>interchangeably</em></strong> <em>throughout this book—including on this page.</em></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/010fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions">
<h5>there are no Dumb Questions</h5>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="C#" data-secondary="combining with XAML" data-type="indexterm" id="idm46402349607288"/><a data-primary="code" data-secondary="automatically generated by IDE" data-type="indexterm" id="idm46402349604792"/><a data-primary="container tags" data-type="indexterm" id="idm46402349603816"/><a data-primary="end tags" data-type="indexterm" id="idm46402349603080"/><a data-primary="tags (XAML)" data-type="indexterm" id="idm46402349602344"/><a data-primary="Visual Studio" data-secondary="editions and versions of" data-type="indexterm" id="idm46402349601608"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402349600632"/><a data-primary="XAML" data-secondary="defined" data-type="indexterm" id="idm46402349599896"/><span style="color:#9D9EA0;">Keep an eye out for these Q&amp;A sections. They often answer your most pressing questions, and point out questions other readers are thinking of. In fact, a lot of them are real questions from readers of previous editions of this book!</span></p>
</div>
<p><strong>Q: So if Visual Studio writes all this code for me, is learning C# just a matter of learning how to use it?</strong></p>
<p><strong>A:</strong> No. The IDE is great at automatically generating some code for you, but it can only do so much. There are some things it’s really good at, like setting up good starting points for you, and automatically changing properties of controls in your UI. The most important part of programming—figuring out what your program needs to do and making it do it—is something that no IDE can do for you. Even though the Visual Studio IDE is one of the most advanced development environments out there, it can only go so far. It’s <strong><em>you</em></strong>—not the IDE—who writes the code that actually does the work.</p>
<p><strong>Q: What if the IDE creates code I don’t want in my project?</strong></p>
<p><strong>A:</strong> You can change or delete it. The IDE is set up to create code based on the way the element you dragged or added is most commonly used, but sometimes that’s not exactly what you wanted. Everything the IDE does for you—every line of code it creates, every file it adds—can be changed, either manually by editing the files directly or through an easy-to-use interface in the IDE.</p>
<p><strong>Q: Why did you ask me to install Visual Studio Community edition? Are you sure that I don’t need to use one of the versions of Visual Studio that isn’t free in order to do everything in this book?</strong></p>
<p><strong>A:</strong> There’s nothing in this book that you can’t do with the free version of Visual Studio (which you can download from Microsoft’s website). The main differences between Community and the other editions aren’t going to stop you from writing C# and creating fully functional, complete applications.</p>
<p><strong>Q: You said something about combining C# and XAML. What is XAML, and how does it combine with C#?</strong></p>
<p><strong>A:</strong> XAML (the X is pronounced like Z, and it rhymes with “camel” ) is a <strong>markup language</strong> that you’ll use to build your user interfaces for your WPF apps. XAML is based on XML (so if you’ve ever worked with HTML you have a head start). Here’s an example of a XAML <strong>tag</strong> to draw a gray ellipse:</p>
<pre data-type="programlisting">&lt;Ellipse Fill="Gray"
 Height="100" Width="75"/&gt;</pre>
<p>If you go back to your project and type in that tag right after <code>&lt;Grid&gt;</code> in your XAML code, a gray ellipse will appear in the middle of your window. You can tell that that’s a tag because it starts with a <code>&lt;</code> followed by a word (<code>Ellipse</code>), which makes it a <strong>start tag</strong>. This particular <code>Ellipse</code> tag has three <strong>properties</strong>: one to set its fill color to gray, and two to set its height and width. This tag ends with <code>/&gt;</code>, but some XAML tags can contain other tags. We can turn this tag into a <strong>container tag</strong> by replacing <code>/&gt;</code> with a <code>&gt;</code>, adding other tags (which can also contain additional tags), and closing it with an <strong>end tag</strong> that looks like this: <code>&lt;/Ellipse&gt;</code>.</p>
<p>You’ll learn a lot more about how XAML works and many different XAML tags throughout the book.</p>
<p><strong>Q: My screen doesn’t look like yours! It’s missing some of the windows, and others are in the wrong place. Did I do something wrong? How can I reset it?</strong></p>
<p><strong>A:</strong> If you click on the <strong>Reset Window Layout</strong> command under the Window menu, the IDE will restore the default window layout for you. Then use the <strong>View&gt;&gt;Other Windows</strong> menu to <u>open the Toolbox and Error List windows</u>. That will make your screen look like the ones in this chapter.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The Toolbox collapses by default. Use the <u>pushpin button</u> in the upper-right corner of the Toolbox window to make it stay open.</span></p>
</div>
<blockquote>
<p><strong>Visual Studio will generate code you can use as a starting point for your applications.</strong></p>
<p><strong>Making sure the app does what it’s supposed to do is entirely up to <u>you</u>.</strong></p>
</blockquote>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/012fig01.png"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-pdf-bookmark="Use XAML to design your window" data-type="sect1"><div class="sect1" id="use_xaml_to_design_your_window">
<h1>Use XAML to design your window</h1>
<p><a data-primary="C#" data-secondary="application code" data-type="indexterm" id="idm46402349571832"/><a data-primary="Extensible Application Markup Language" data-see="XAML" data-type="indexterm" id="idm46402349570584"/><a data-primary="XAML" data-type="indexterm" id="idm46402349569528"/><a data-primary="XAML" data-secondary="application code" data-type="indexterm" id="idm46402349568632"/><a data-primary="XAML" data-secondary="designing window using" data-type="indexterm" id="idm46402349567656"/>Now that Visual Studio has created a WPF project for you, it’s time to start working with <strong>XAML</strong>.</p>
<p>XAML, which stands for <strong>E<u>x</u>tensible <u>A</u>pplication <u>M</u>arkup <u>L</u>anguage</strong>, is a really flexible markup language that C# developers use to design user interfaces. You’ll be building an app with <u>two</u> different kinds of code. First you’ll design the user interface (or UI) with XAML. Then you’ll add C# code to make the game run.</p>
<p>If you’ve ever used HTML to design a web page, then you’ll see a lot of similarities with XAML. Here’s a really quick example of a small window layout in XAML:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/012fig02.png"/>
<h6/>
</div></figure>
<p>Here’s what that window looks like when WPF <strong>renders</strong> it (or draws it on the screen). It draws a window with two visible <strong>controls</strong>, a TextBlock control that displays text and a Button control that the user can click on. They’re laid out using an invisible StackPanel control, which causes them to be rendered one on top of the other. Look at the controls in the screenshot of the window, then go back to the XAML and find the <code>TextBlock</code> and <code>Button</code> tags.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/012fig03.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Design the window for your game" data-type="sect1"><div class="sect1" id="design_the_window_for_your_game">
<h1>Design the window for your game</h1>
<p><a data-primary="XAML" data-secondary="importance of learning" data-type="indexterm" id="idm46402349555800"/>You’re going to need an application with a graphical user interface, objects to make the game work, and an executable to run. It sounds like a lot of work, but you’ll build all of this over the rest of the chapter, and by the end, you’ll have a pretty good handle on how to use Visual Studio to design a great-looking WPF app.</p>
<p>Here’s the layout of the window for the app we’re going to create:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/013fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="xaml_is_an_important_skill_for_chash_dev">
<h5><span class="inlineimage"><img alt="Images" src="assets/relax.png"/></span> <strong>XAML is an important skill for C# developers.</strong></h5>
<p>You might be thinking, “Wait a minute! This is <em>Head First <u>C#</u></em>. Why am I spending so much time on XAML? Shouldn’t we be concentrating on C#?”</p>
<p>WPF applications use XAML for user interface design—and so do other kinds of C# projects. Not only can you use it for desktop apps, you can also use the same skills to build C# Android and iOS mobile apps with Xamarin Forms, which uses a variant of XAML (with a <em>slightly</em> different set of controls). That’s why building user interfaces in XAML is an important skill for any C# developer, and why you’ll learn a lot more about XAML throughout the book. We’ll walk you through building the XAML <strong><em>step by step</em></strong>—you can use the drag-and-drop tools in the Visual Studio 2019 XAML designer to create your user interface without a lot of typing. <em><strong>So just to be clear:</strong></em></p>
<p><strong>XAML is code that defines the user interface. C# is code that defines the behavior.</strong></p>
</div></aside>
</div></section>
<section data-pdf-bookmark="Set the window size and title with XAML properties" data-type="sect1"><div class="sect1" id="set_the_window_size_and_title_with_xaml">
<h1>Set the window size and title with XAML properties</h1>
<p><a data-primary="files" data-secondary="opening in Solution Explorer" data-type="indexterm" id="idm46402349541816"/><a data-primary="Solution Explorer, opening files in" data-type="indexterm" id="idm46402349539944"/><a data-primary="XAML" data-secondary="setting window size and title" data-type="indexterm" id="idm46402349539176"/>Let’s start building the UI for your animal matching game. The first thing you’ll do is make the window narrower and change its title. You’ll also get familiar with Visual Studio’s XAML designer, a powerful tool for designing great-looking user interfaces for your apps.</p>
<ol>
<li><p><strong>Select the main window.</strong></p>
<p>Double-click on <em>MainWindow.xaml</em> in the Solution Explorer.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/014fig01.png"/>
<h6/>
</div></figure>
<p>As soon as you do, Visual Studio will open it up in the XAML designer.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/014fig02.png"/>
<h6/>
</div></figure>
</li>
<li><p><a data-primary="Properties window" data-secondary="showing changes in" data-type="indexterm" id="idm46402349530968"/><a data-primary="tags (XAML)" data-type="indexterm" id="idm46402349529208"/><strong>Change the size of the window.</strong></p>
<p>Move your mouse to the XAML editor and click anywhere in the first eight lines of the XAML code. As soon as you do, you should see the window’s properties displayed in the Properties window.</p>
<p>Expand the Layout section and <strong>change the width to 400</strong>. The window in the Design pane will immediately get narrower. Look closely at the XAML code­—the Width property is now 400.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/015fig01.png"/>
<h6/>
</div></figure>
</li>
<li><p><strong>Change the window title.</strong></p>
<p>Find this line in the XAML code at the very end of the <code>Window</code> tag:</p>
<pre data-type="programlisting"><strong>Title="MainWindow" Height="450" Width="400"&gt;</strong></pre>
<p>and change the title to <strong>Find all of the matching animals</strong> so it looks like this:</p>
<pre data-type="programlisting">Title="<strong>Find all of the matching animals</strong><code>" Height="450" Width="400"&gt;</code></pre>
<p>You’ll see the change appear in the Common section in the Properties window—and, more importantly, the title bar of the window now shows the new text.</p></li>
</ol>
<blockquote>
<p><strong>When you modify properties in your XAML tags, the changes immediately show up in the Properties window. When you use the Properties window to modify your UI, the IDE updates the XAML.</strong></p>
</blockquote>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/015fig02.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Add rows and columns to the XAML grid" data-type="sect1"><div class="sect1" id="add_rows_and_columns_to_the_xaml_grid">
<h1>Add rows and columns to the XAML grid</h1>
<p><a data-primary="columns (XAML grid)" data-type="indexterm" id="idm46402349513800"/><a data-primary="grid (XAML)" data-secondary="adding rows and columns to" data-type="indexterm" id="idm46402349513064"/><a data-primary="rows" data-secondary="adding to XAML grid" data-type="indexterm" id="idm46402349512088"/><a data-primary="Visual Studio" data-secondary="2019 Community Edition for Windows" data-type="indexterm" id="idm46402349510936"/>It might look like your main window is empty, but have a closer look at the bottom of the XAML. Notice how there’s a line with <code>&lt;</code><strong>Grid</strong><code>&gt;</code> followed by one with <code>&lt;/</code><strong>Grid</strong><code>&gt;</code>? Your window actually has a <strong>grid</strong>—you just don’t see anything because it doesn’t have any rows or columns. Let’s go ahead and add a row.</p>
<p>Move your mouse over the left side of the window in the designer. When a plus appears over the cursor, click the mouse to add a row.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Your WPF app’s UI is built with <u>controls</u> like buttons, labels, and checkboxes. A grid is a special kind of control—called a <u>container</u>—that can contain other controls. It uses rows and columns to define a layout.</strong></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/016fig01.png"/>
<h6/>
</div></figure>
<p>You’ll see a number appear followed by an asterisk, and a horizontal line across the window. You just added a row to your grid! Now add the rows and columns:</p>
<ul>
<li><p>Repeat four more times to add a total of five rows.</p></li>
<li><p>Hover over the top of the window and click to add four columns. Your window should look like the screenshot below (but your numbers will be different—that’s OK).</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/016fig03.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="watch_itexclamation_mark">
<h5><span class="inlineimage"><img alt="Images" src="assets/watchit.png"/></span> Watch it!</h5>
<p><strong>Things may look a bit different in your IDE.</strong></p>
<p><em>All of the screenshots in this book were taken with <strong>Visual Studio Community 2019 for Windows</strong>. If you’re using the Professional or Enterprise edition, you might see a few minor differences.</em></p>
<p><em>Don’t worry, everything will still work exactly the same.</em></p>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">These “Watch it!” elements give you a heads-up about important, but often confusing, things that may trip you up or slow you down.</span></p>
</div>
</div></section>
<section data-pdf-bookmark="Make the rows and columns equal size" data-type="sect1"><div class="sect1" id="make_the_rows_and_columns_equal_size">
<h1>Make the rows and columns equal size</h1>
<p><a data-primary="columns (XAML grid)" data-type="indexterm" id="idm46402349490296"/><a data-primary="grid (XAML)" data-secondary="sizing rows and columns" data-type="indexterm" id="idm46402349488824"/><a data-primary="rows" data-secondary="making equal size in XAML grid" data-type="indexterm" id="idm46402349487736"/>When our game displays the animals for the player to match, we want them to be evenly spaced. Each animal will be contained in a cell in the grid, and the grid will automatically adjust to the size of the window, so we need the rows and columns to all be the same size. Luckily, XAML makes it really easy for us to resize the rows and columns. <strong>Click on the first <code>RowDefinition</code> tag <u>in the XAML editor</u></strong> to display its properties in the Properties window:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/017fig01.png"/>
<h6/>
</div></figure>
<p>Go to the Properties window and <strong>click the square</strong> to the right of the Height propert, then <strong>choose Reset from the menu</strong> that pops up. Hey, wait a minute! As soon as you did that, the row disappeared from the designer. Well, actually, it didn’t quite disappear—it just became very narrow. Go ahead and <strong>reset the Height property</strong> for <u>all</u> of the rows. Then <strong>reset the Width property</strong> for <u>all</u> of the columns. Your grid should now have four equally sized columns and five equally sized rows.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/017fig02.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/017fig03.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Add a TextBlock control to your grid" data-type="sect1"><div class="sect1" id="add_a_textblock_control_to_your_grid">
<h1>Add a TextBlock control to your grid</h1>
<p><a data-primary="grid (XAML)" data-secondary="adding TextBlock controls" data-type="indexterm" id="idm46402349474104"/><a data-primary="HorizontalAlignment property" data-type="indexterm" id="idm46402349472440"/><a data-primary="Margin property (XAML)" data-type="indexterm" id="idm46402349471560"/><a data-primary="TextBlocks" data-secondary="adding to XAML grid" data-type="indexterm" id="idm46402349470712"/><a data-primary="Text property" data-type="indexterm" id="idm46402349469560"/><a data-primary="TextWrapping property" data-type="indexterm" id="idm46402349468712"/><a data-primary="VerticalAlignment property (XAML)" data-type="indexterm" id="idm46402349467864"/>WPF apps use <strong>TextBlock controls</strong> to display text, and we’ll use them to display the animals to find and match. Let’s add one to the window.</p>
<p>Expand the Common WPF Controls section in the Toolbox and <strong>drag a TextBlock into the cell in the second column and second row</strong>. The IDE will add a <code>TextBlock</code> tag between the <code>Grid</code> start and end tags:</p>
<pre data-type="programlisting">&lt;<strong>TextBlock</strong> Text="<em>TextBlock</em><strong>"</strong>
   HorizontalAlignment="<em>Left</em><strong>"</strong> VerticalAlignment="<em>Center</em><strong>"</strong>
   Margin="<em>560,0,0,0</em><strong>"</strong> TextWrapping="<em>Wrap</em><strong>"</strong> /&gt;</pre>
<p>The XAML for this TextBlock has five properties:</p>
<ul>
<li><p><code>Text</code> tells the TextBlock what text to display in the window.</p></li>
<li><p><code>HorizontalAlignment</code> justifies the text left, right, or center.</p></li>
<li><p><code>VerticalAlignment</code> aligns it to the top, middle, or bottom of its box.</p></li>
<li><p><code>Margin</code> sets its offset from the top, sides, or bottom of its container.</p></li>
<li><p><code>TextWrapping</code> tells it whether or not to add line breaks to wrap the text.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/018fig01.png"/>
<h6/>
</div></figure>
<p><em><strong>Your properties may be in a different order</strong></em>, and the Margin property will have different numbers because they depend on where in the cell you dragged it. All of these properties can be modified or reset using the IDE’s Properties window.</p>
<p>We want each animal to be centered. <strong>Click on the label</strong> in the designer, then go to the Properties window and click <span class="inlineimage"><img alt="Images" src="assets/018fig03.png"/></span> to expand the <strong>Layout section</strong>. Click <strong>Center</strong> for <u>both</u> the horizontal and vertical alignment properties, and then use the square at the right of the window <strong>to reset the Margin property</strong>.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/018fig04.png"/>
<h6/>
</div></figure>
<p>We also want the animals to be bigger, so <strong>expand the Text section</strong> in the Properties window and <strong>change the font size</strong> to <strong>36 px</strong>. Then go to the Common section and change the Text property to <code>?</code> to make it display a question mark.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/018fig05.png"/>
<h6/>
</div></figure>
<p><strong>Click on the search box</strong> at the top of the Properties window, then type the word <code>wrap</code> to find properties that match. Use the square on the right side of the window to reset the TextWrapping property.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/018fig06.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/019fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0001">
<h5>there are no Dumb Questions</h5>
<p><a data-primary="exercises" data-secondary="TextBlocks" data-type="indexterm" id="idm46402349433784"/><a data-primary="grid (XAML)" data-secondary="troubleshooting" data-type="indexterm" id="idm46402349432632"/><a data-primary="rows" data-secondary="troubleshooting in XAML grid" data-type="indexterm" id="idm46402349431592"/><a data-primary="TextBlocks" data-secondary="exercise on" data-type="indexterm" id="idm46402349430440"/><strong>Q: When I reset the height of the first four rows they disappeared, but then they all came back when I reset the height of the last one. Why did that happen?</strong></p>
<p><strong>A:</strong> The rows looked like they disappeared because by default WPF grids use <strong>proportional sizing</strong> for their rows and columns. If the height of the last row was 74*, then when you changed the first four rows to the default height of 1* that caused the grid to size the rows so that each of the first four rows takes up 1/78th (or 1.3%) of the height of the grid, and the last row takes up 74/78ths (or 94.8%) of the height, which made the first four rows look really tiny. As soon as you reset the last row to its default height of 1*, that caused the grid to resize each row to an even 20% of the height of the grid.</p>
<p><strong>Q: When I set the width of the window to 400, what exactly is that measurement? How wide is 400?</strong></p>
<p><strong>A:</strong> WPF uses <strong>device-independent pixels</strong> that are always 1/96th of an inch. That means 96 pixels will always equal 1 inch on an <em>unscaled</em> display. But if you take out a ruler and measure your window, you might find that it’s not exactly 400 pixels (or about 4.16 inches) wide. That’s because Windows has really useful features that let you change how your screen is scaled, so your apps don’t look teeny-tiny if you’re using a TV across the room as a computer monitor. Device-independent pixels help WPF make your app look good at any scale.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-idd0001">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise</h5>
<p>You have one TextBlock—that’s a great start! But we need 16 TextBlocks to show all of the animals to match. Can you figure out how to add more XAML to add an identical TextBlock to all of the cells in the first four rows of the grid?</p>
<p><strong>Start by looking at the XAML tag that you just created.</strong> It should look like this—the properties may be in a different order, and we added a line break (which you can do too, if you want your XAML to be easier to read):</p>
<pre data-type="programlisting">&lt;<strong>TextBlock</strong> Text="<em>?</em>" Grid.Column="<em>1</em>" Grid.Row="<em>1</em>" FontSize="<em>36</em>"
       HorizontalAlignment="<em>Center</em>" VerticalAlignment="<em>Center</em>"/&gt;</pre>
<p><u>Your job</u> is to <strong>replicate that TextBlock</strong> so each of the top 16 cells in the grid contains an identical one—to complete this exercise, you’ll need to <em>add 15 more TextBlocks to your app</em>. A few of things to keep in mind:</p>
<ul>
<li><p>Rows and columns are numbered starting with 0, which is also the default value. So if you leave out the <code>Grid.Row</code> or <code>Grid.Column</code> property, the TextBlock will appear in the leftmost row or top column.</p></li>
<li><p>You can edit your UI in the designer, or copy and paste the XAML. Try both—see what works for you!</p></li>
</ul>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You’ll see many exercises like this throughout the book. They give you a chance to work on your coding skills. And it’s <u>always OK</u> to peek at the solution!</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-idd0002">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise Solution</h5>
<p>Here’s the XAML for the 16 TextBlocks for the animals that the player matches—they’re all identical except for their Grid.Row and Grid.Column properties, which place one TextBlock in each of the top 16 cells of the 5-row-by-4-column grid. <em>(The <strong>Window</strong> tag stays the same, so we didn’t include it here.)</em></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/020fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/021fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Now you’re ready to start writing code for your game" data-type="sect1"><div class="sect1" id="now_youapostrophere_ready_to_start_writi">
<h1>Now you’re ready to start writing code for your game</h1>
<p><a data-primary="AI-assisted IntelliSense" data-type="indexterm" id="idm46402349400920"/><a data-primary="C#" data-secondary="specificity of" data-type="indexterm" id="idm46402349399592"/><a data-primary="code-behind" data-type="indexterm" id="idm46402349398520"/><a data-primary="MainWindow.xaml" data-type="indexterm" id="idm46402349397752"/>You’ve finished designing the main window—or at least enough of it to get the next part of your game working. Now it’s time to add C# code to make your game work.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/021fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="watch_itexclamation_mark-idd0001">
<h5><span class="inlineimage"><img alt="Images" src="assets/watchit.png"/></span> Watch it!</h5>
<p><strong>When you enter C# code, it has to be <u>exactly</u> right.</strong></p>
<p><em>Some people say that you truly become a developer after the first time you’ve spent hours tracking down a misplaced period. Case matters: <u>S</u><code>etUpGame</code> is different from <u>s</u><code>etUpGame</code>. Extra commas, semicolons, parentheses, etc. can break your code—or, worse, change your code so that it <u>still builds</u> but does something different than what you want it to do. The IDE’s <strong><em>AI-assisted IntelliSense</em></strong> can help you avoid those problems…but it can’t do everything for you.</em></p>
</div></aside>
</div></section>
<section data-pdf-bookmark="Generate a method to set up the game" data-type="sect1"><div class="sect1" id="generate_a_method_to_set_up_the_game">
<h1><u>Generate</u> a method to set up the game</h1>
<p><a data-primary="methods" data-secondary="generating to set up game" data-type="indexterm" id="idm46402349385576"/><a data-primary="Preview changes window" data-type="indexterm" id="idm46402349384456"/><a data-primary="Quick Actions icon" data-type="indexterm" id="idm46402349383608"/><a data-primary="SetupGame method" data-type="indexterm" id="idm46402349382776"/>Now that the user interface is set up, it’s time to start writing code for the game. You’re going to do that by <strong>generating a method</strong> (just like the Main method you saw earlier), and then adding code to it.</p>
<ol>
<li><p><strong>Open MainWindow.xaml.cs in the editor.</strong></p>
<p>Click the triangle <span class="inlineimage"><img alt="Images" src="assets/022fig02.png"/></span> next to <em>MainWindow.xaml</em> in the Solution Explorer and <strong>double-click on <em>MainWindow.xaml.cs</em></strong> to open it in the IDE’s code editor. You’ll notice that there’s already code in that file. Visual Studio will help you add a method to it.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/022fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Generate a <u>method</u> called SetUpGame.</strong></p>
<p>Find this part of the code that you opened:</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">It’s OK if you’re not 100% clear on what a method is yet.</span></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/022fig03.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/023fig01.png"/>
<h6/>
</div></figure>
<p><a data-primary="Start Debugging button" data-type="indexterm" id="idm46402349367352"/><a data-primary="Stop Debugging button" data-type="indexterm" id="idm46402349366120"/>Any time you see the light bulb icon, it’s telling you that you’ve selected code that has a <u>quick action</u> available, which means there’s a task that Visual Studio can automate for you. You can either click the light bulb or press Alt+Enter or Ctrl+. (period) to see the available quick actions.</p>
</div>
</li>
<li><p><strong>Try running your code.</strong></p>
<p>Click the button at the top of the IDE to start your program, just like you did with your console app earlier.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/023fig02.png"/>
<h6/>
</div></figure>
<p>Uh-oh—something went wrong. Instead of showing you a window, it <strong>threw an exception</strong>:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/023fig03.png"/>
<h6/>
</div></figure>
<p>Things may seem like they’re broken, but this is actually exactly what we expected to happen! The IDE paused your program, and highlighted the most recent line of code that ran. Take a closer look at it:</p>
<pre data-type="programlisting">throw new NotImplementedException();</pre>
<p>The method that the IDE generated literally told C# to throw an exception. Take a closer look at the message that came with the exception:</p>
<pre data-type="programlisting"><strong>System.NotImplementedException</strong>: 'The method or operation is not implemented.'</pre>
<p>That actually makes sense, because <strong>it’s up to you to implement the method</strong> that the IDE generated. If you forget to implement it, the exception is a nice reminder that you still have work to do. If you generate a lot of methods, it’s great to have that as a reminder!</p>
<p>Click the square Stop Debugging button <span class="inlineimage"><img alt="Images" src="assets/023fig04.png"/></span> in the toolbar (or choose Stop Debugging (F5) from the Debug menu) to stop your program so you can finish implementing the SetUpGame method.</p></li>
</ol>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">When you’re using the IDE to run your app, the Stop Debugging button immediately quits it.</span></p>
</div>
</div></section>
<section data-pdf-bookmark="Finish your SetUpGame method" data-type="sect1"><div class="sect1" id="finish_your_setupgame_method">
<h1>Finish your SetUpGame method</h1>
<p><a data-primary="characters" data-type="indexterm" id="idm46402349351016"/><a data-primary="constructors" data-secondary="about" data-type="indexterm" id="idm46402349347832"/><a data-primary="emoji" data-type="indexterm" id="idm46402349346680"/>You put your SetUpGame method inside the <code>public MainWindow()</code> method because everything inside that method is called as soon as your app starts.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">This is a special method called a constructor, and you’ll learn more about how it works in <a href="ch05.html#encapsulation_keep_your_privateshellippr">#encapsulation_keep_your_privateshellippr</a>.</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="youapostrophell_learn_a_lot_more_about_m">
<h5><span class="inlineimage"><img alt="Images" src="assets/relax.png"/></span> <strong>You’ll learn a lot more about methods soon.</strong></h5>
<p>You just used the IDE to help you add a method to your app, but it’s OK if you’re still not 100% clear on what a method is. You’ll learn much more about methods and how C# code is structured in the next chapter.</p>
</div></aside>
<ol>
<li><p><strong>Start adding code to your SetUpGame method.</strong></p>
<p>Your SetUpGame method will take eight pairs of animal emoji characters and randomly assign them to the TextBlock controls so the player can match them. So the first thing your method needs is a list of those emoji, and the IDE will help you write code for it. Select the <code>throw</code> statement that the IDE added, and delete it. Then put your cursor where that statement was and type <code>List</code>. The IDE will pop up an <strong>IntelliSense window</strong> with a bunch of keywords that start with “List” :</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/024fig01.png"/>
<h6/>
</div></figure>
<p>Choose <code>List</code> from the IntelliSense pop-up. Then type <code>&lt;str</code>—another IntelliSense window will pop up with matching keywords:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/024fig02.png"/>
<h6/>
</div></figure>
<p>Choose <code>string</code>. Finish typing this line of code, but <strong>don’t hit Enter yet</strong>:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/024fig03.png"/>
<h6/>
</div></figure>
</li>
<li><p><a data-primary="tags (XAML)" data-type="indexterm" id="idm46402349327096"/><a data-primary="Windows" data-secondary="emoji panel" data-type="indexterm" id="idm46402349325688"/><strong>Add values to your List.</strong></p>
<p>Your C# statement isn’t done yet. Make sure your cursor is placed just after the <code>)</code> at the end of the line, then type an opening curly bracket <code>{</code>—the IDE will add the closing one for you, and your cursor will be positioned between the two brackets. <strong>Press Enter</strong>—the IDE will add line breaks for you automatically:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/025fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Finish your method.</strong></p>
<p>Now <strong>add the rest of the code</strong> for the method—be <em>careful</em> with the periods, parentheses, and brackets:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/025fig02.png"/>
<h6/>
</div></figure>
<p>The red squiggly line under <code>mainGrid</code> is the IDE telling you there’s an error: your program won’t build because there’s nothing with that name anywhere in the code. <strong>Go back to the XAML editor</strong> and click on the <code>&lt;Grid&gt;</code> tag, then go to the Properties window and enter <code>mainGrid</code> in the Name box.</p>
<p>Check the XAML—you’ll see <code>&lt;Grid x:Name="mainGrid"&gt;</code> at the top of the grid. Now there shouldn’t be any errors in your code. If there are, <em><strong>carefully check every line</strong></em>—it’s easy to miss something.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">If you get an exception when you run your game, make sure you have exactly 8 pairs of emoji in your animalEmoji list and 16 &lt;TextBlock ... /&gt; tags in your XAML.</span></p>
</div></li>
</ol>
</div></section>
<section data-pdf-bookmark="Run your program" data-type="sect1"><div class="sect1" id="run_your_program">
<h1>Run your program</h1>
<p><a data-primary="debugging mode" data-type="indexterm" id="idm46402349309528"/>Click the <span class="inlineimage"><img alt="Images" src="assets/026fig01.png"/></span> button in the IDE’s toolbar to start your program running. A window will pop up with your eight pairs of animals in random positions:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/026fig02.png"/>
<h6/>
</div></figure>
<p>The IDE goes into <u>debugging mode</u> while your program is running: the Start button is replaced by a grayed-out Continue, and <strong>debug controls</strong> <span class="inlineimage"><img alt="Images" src="assets/026fig04.png"/></span> appear in the toolbar with buttons to pause, stop, and restart your program.</p>
<p>Stop your program by clicking <code>X</code> in the upper-right corner of the window or the square Stop button in the debug controls. Run it a few times—the animals will get shuffled each time.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/026fig03.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/026fig05.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>You’ve set the stage for the next part that you’ll add.</strong></p>
<p>When you build a new game, you’re not just writing code. You’re also running a project. A really effective way to run a project is to build it in small increments, taking stock along the way to make sure things are going in a good direction. That way you have plenty of opportunities to change course.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="exercises" data-secondary="Who Does What?" data-type="indexterm" id="idm46402349295672"/><a data-primary="Who Does What? exercise" data-type="indexterm" id="idm46402349294040"/><span style="color:#9D9EA0;">Here’s another pencil-and-paper exercise. It’s absolutely worth your time to do all of them because they’ll help get important C# concepts into your brain faster.</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="Who_does_whatquestion_mark">
<h5>Who does what?</h5>
<p><strong>Congratulations—you’ve created a working program!</strong> Obviously, programming is more than just copying code out of a book. But even if you’ve never written code before, you may surprise yourself with just how much of it you already understand. Draw a line connecting each of the C# statements on the left to the description of what the statement does on the right. We’ll start you out with the first one.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/027fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="Who_does_whatquestion_marka">
<h5>Who does what? Solution</h5>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/028fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0002">
<h5><span class="inlineimage"><img alt="Images" src="assets/Common.png"/></span> Mini Sharpen your pencil</h5>
<p>Here’s a pencil-and-paper exercise that will help you really understand your <code>C# code.</code></p>
<ol>
<li><p>Take a piece of paper and turn it on its side so it’s in landscape orientation, and draw a vertical line down the middle.</p></li>
<li><p>Write out the entire SetUpGame method by hand on the left side of the paper, leaving space between each statement. (You don’t need to be accurate with the emoji.)</p></li>
<li><p>On the right side of the paper, write each of the “what it does” answers above next to the statement that it’s connected to. Read down both sides—it should all start to make sense.</p></li>
</ol>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/029fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="C#" data-secondary="exercise on" data-type="indexterm" id="idm46402349277976"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="C# code" data-type="indexterm" id="idm46402349273384"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="C# code" data-type="indexterm" id="idm46402349272104"/><a data-primary="tags (XAML)" data-type="indexterm" id="idm46402349271016"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402349270152"/><strong>Working on your code comprehension skills will make you a better developer.</strong></p>
<p>The pencil-and-paper exercises are <strong>not optional</strong>. They give your brain a different way to absorb the information. But they do something even more important: they give you opportunities to <em><strong>make mistakes</strong></em>. Making mistakes is a part of learning, and we’ve all made plenty of mistkaes (you may even find one or two typos in this book!). Nobody writes perfect code the first time—really good programmers always assume that the code that they write today will probably need to change tomorrow. In fact, later in the book you’ll learn about <em>refactoring</em>, or programming techniques that are all about improving your code after you’ve written it.</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-idd0001">
<h5>Bullet Points</h5>
<ul>
<li><p>Visual Studio is <strong>Microsoft’s IDE</strong>—or <strong>integrated development environment</strong>—that simplifies and assists in editing and managing your C# code files.</p></li>
<li><p><strong>.NET Core console apps</strong> are cross-platform apps that use text for input and output.</p></li>
<li><p>The IDE’s <strong>AI-assisted IntelliSense</strong> helps you enter code more quickly.</p></li>
<li><p><strong>WPF</strong> (or Windows Presentation Foundation) is a technology that you can use to build visual apps in C#.</p></li>
<li><p>WPF user interfaces are designed in <strong>XAML</strong> (eXtensible Application Markup Language), an XML-based markup language that uses tags and properties to define controls in a user interface.</p></li>
<li><p>The <strong>Grid XAML control</strong> provides a grid layout that holds other controls.</p></li>
<li><p>The <code><strong>TextBlock XAML tag</strong></code> adds a control for holding text.</p></li>
<li><p>The IDE’s <strong>Properties window</strong> makes it easy to edit the properties of your controls—like changing their layout, text, or what row or column of the grid they’re in.</p></li>
</ul>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">We’ll add bullet points like this to give a quick summary of many of the ideas and tools that you’ve seen so far.</span></p>
</div>
</div></section>
<section data-pdf-bookmark="Add your new project to source control" data-type="sect1"><div class="sect1" id="add_your_new_project_to_source_control">
<h1>Add your new project to source control</h1>
<p><a data-primary="commit, Git" data-type="indexterm" id="idm46402349251400"/><a data-primary="Git" data-type="indexterm" id="idm46402349250776"/><a data-primary="GitHub" data-type="indexterm" id="idm46402349250040"/><a data-primary="source control" data-type="indexterm" id="idm46402349249304"/><a data-primary="status bar" data-type="indexterm" id="idm46402349248424"/><a data-primary="Team Explorer window" data-type="indexterm" id="idm46402349247624"/>You’re going to be building a lot of different projects in this book. Wouldn’t it be great if there was an easy way to back them up and access them from anywhere? What if you make a mistake—wouldn’t it be super convenient if you could roll back to a previous version of your code? Well, you’re in luck! That’s exactly what <strong>source control</strong> does: it gives you an easy way to back up all of your code, and keeps track of every change that you make. Visual Studio makes it easy for you to add your projects to source control.</p>
<p><strong>Git</strong> is a popular version control system, and Visual Studio will publish your source to any Git <strong>repository</strong> (or <strong>repo</strong>). We think <strong>GitHub</strong> is one of the easiest Git providers to use. You’ll need a GitHub account to push code to it, so if you don’t already have one, go to <a href="https://github.com">https://github.com</a> and create it now.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="adding_your_project_to_source_control_is">
<h5><span class="inlineimage"><img alt="Images" src="assets/relax.png"/></span> <strong>Adding your project to source control is optional.</strong></h5>
<p>Maybe you’re working on a computer on an office network that doesn’t allow access to GitHub, the Git provider we’re recommending. Maybe you just don’t feel like doing it. Whatever the reason, you can skip this step—or, alternatively, you can publish it to a private repository if you want to keep a backup but don’t want other people to find it.</p>
</div></aside>
<p>Find <strong>Add to Source Control</strong> in the status bar at the bottom of the IDE:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/030fig01a.png"/>
<h6/>
</div></figure>
<p>Click on it—Visual Studio will prompt you to add your code to Git:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/030fig01.png"/>
<h6/>
</div></figure>
<p><strong>Click Git.</strong> Visual Studio may prompt you for your name and email address. Then it should show you this in the status bar:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/030fig02.png"/>
<h6/>
</div></figure>
<p>Your code is now under source control. Now hover your mouse over <span class="inlineimage"><img alt="Images" src="assets/030fig03.png"/></span>:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/030fig04.png"/>
<h6/>
</div></figure>
<p>The IDE is telling you that you have two <strong>commits</strong>—or saved versions of your code—that haven’t been <em><strong>pushed</strong></em> to a location that’s outside of your computer.</p>
<p>When you added your project to source control, the IDE opened the <strong>Team Explorer window</strong> in the same panel as the Solution Explorer. (If you don’t see it, select it from the View menu.) The Team Explorer helps you manage your source control. You’ll use it to publish your project to a <strong>remote repo</strong>.</p>
<p>When you have local changes you’ll use the Team Explorer to push them to the remote repo. To do this, <strong>click the Publish to GitHub</strong> button in the Team Explorer window.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/030fig05.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="publishing to GitHub" data-type="indexterm" id="idm46402349220488"/><strong>Git is an open source version control system. There are multiple third-party services like GitHub that provide Git services (like storage space for your code and web access to your repositories). You can go to <a href="https://git-scm.com">https://git-scm.com</a> to learn more about Git.</strong></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/031fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Go to</strong> <a href="https://github.com/head-first-csharp/fourth-edition">https://github.com/head-first-csharp/fourth-edition</a> <strong>to view and download the complete code for this project and all of the other projects in this book.</strong></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0002">
<h5>there are no Dumb Questions</h5>
<p><a data-primary="binary (executable)" data-type="indexterm" id="idm46402349211816"/><a data-primary="Error List window" data-type="indexterm" id="idm46402349210648"/><a data-primary="executable binaries" data-see="binary (executable)" data-type="indexterm" id="idm46402349209768"/><a data-primary="HTML, compared with XAML" data-type="indexterm" id="idm46402349208792"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402349207992"/><a data-primary="XAML" data-secondary="compared with HTML" data-type="indexterm" id="idm46402349207080"/><strong>Q: Is XAML really code?</strong></p>
<p><strong>A:</strong> .Yes, absolutely. Remember how the red squiggly lines appeared underneath <code>mainGrid</code> in your C# code, and only disappeared when you added the name to the <strong>Grid</strong> tag in the XAML? That’s because you were actually modifying the code—once you added the name in the XAML, your C# code was able to use it.</p>
<p><strong>Q: I assumed XAML was like HTML, which is interpreted by a browser. XAML isn’t like that?</strong></p>
<p><strong>A:</strong> No, XAML is code that’s built alongside your C# code. In the next chapter you’ll learn about how you can use the partial keyword to split up a class into multiple files. That’s exactly how XAML and C# are joined up: the XAML defines a user interface, the C# defines the behavior, and they’re joined up using partial classes.</p>
<p>That’s why it’s important to think of your XAML as code, and why learning XAML is an important skill for any C# developer.</p>
<p><strong>Q: I noticed a LOT of <strong>using</strong> lines at the top of my C# file. Why so many?</strong></p>
<p><strong>A:</strong> <code>WPF apps</code> tend to <code>use code</code> from a lot of different <em>namespaces</em> (we’ll get into exactly what a namespace is in the next chapter). When Visual Studio creates a WPF project for you, it automatically adds <code><strong>using directives</strong></code> for the most common ones at the top of the <em>MainWindow.xaml.cs</em> file. In fact, you’re using some of them already: the IDE uses a lighter text color to show you namespaces that aren’t in use in the code.</p>
<p><strong>Q: Desktop apps seem a lot more complicated than console apps. Do they really work the same way?</strong></p>
<p><strong>A:</strong> Yes. When you get down to it, all C# code works the same way: one statement executes, then the next one, and then the next one. The reason desktop apps seem more complex is because some methods are only called when certain things happen, like when the window is displayed or the user clicks on a button. Once a method gets called, it works exactly like in a console app.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="ide_tip_the_error_list">
<h5><strong>IDE Tip: The Error List</strong></h5>
<p>Look at the bottom of the code editor—notice how it says <span class="inlineimage"><img alt="Images" src="assets/032fig01.png"/></span>. That means your code <strong>builds,</strong> which is what the IDE does to turn your code into a <strong>binary</strong> that the operating system can run. Let’s break your code.</p>
<p>Go to the first line of code in your new SetUpGame method. Press Enter twice, then add this on its own line: <code>Xyz</code></p>
<p>Check the bottom of the code editor again—now it says <span class="inlineimage"><img alt="Images" src="assets/032fig02.png"/></span>. If you don’t have the Error List window open, choose Error List from the View menu to open it. You’ll see three errors in the Error List:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/032fig03.png"/>
<h6/>
</div></figure>
<p>The IDE displayed these errors because <code>Xyz</code> is not valid C# code, and these prevent the IDE from building your code. As long as there are errors in your code it won’t run, so go ahead and delete the <code>Xyz</code> line that you added.</p>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/033fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="The next step to build the game is handling mouse clicks" data-type="sect1"><div class="sect1" id="the_next_step_to_build_the_game_is_handl">
<h1>The next step to build the game is handling mouse clicks</h1>
<p><a data-primary="comments" data-type="indexterm" id="idm46402349182504"/><a data-primary="event handlers" data-secondary="adding" data-type="indexterm" id="idm46402349181208"/><a data-primary="mouse clicks" data-type="indexterm" id="idm46402349180056"/>Now that the game is displaying the animals for the player to click on, we need to add code that makes the gameplay work. The player will click on animals in pairs. The first animal the player clicks on disappears. If the second animal the player clicks on matches the first, that one disappears too. If it doesn’t, the first animal reappears. We’ll make all of this work by adding an <strong>event handler</strong>, which is just a name for a method that gets called when certain actions (like mouse clicks, double-clicks, windows getting resized, etc.) happen in the app.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/033fig02.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Make your TextBlocks respond to mouse clicks" data-type="sect1"><div class="sect1" id="make_your_textblocks_respond_to_mouse_cl">
<h1>Make your TextBlocks respond to mouse clicks</h1>
<p><a data-primary="event handlers" data-secondary="defined" data-type="indexterm" id="idm46402349176232"/><a data-primary="mouse clicks" data-type="indexterm" id="idm46402349174552"/><a data-primary="Properties window" data-secondary="toggling" data-type="indexterm" id="idm46402349173816"/><a data-primary="TextBlocks" data-secondary="responding to mouse clicks" data-type="indexterm" id="idm46402349171144"/>Your SetUpGame method changes the TextBlocks to show animal emoji, so you’ve seen how your code can modify controls in your application. Now you need to write code that goes in the other direction—your controls need to call your code, and the IDE can help.</p>
<p>Go back to the XAML editor window and <strong>click the first</strong> <code><strong>TextBlock</strong></code> <strong>tag</strong>—this will cause the IDE to select it in the designer so you can edit its properties. Then go to the Properties window and click the Event Handlers button (<span class="inlineimage"><img alt="Images" src="assets/034fig01.png"/></span>). An <strong>event handler</strong> is a method that your application calls when a specific event happens. These events include keypresses, drag and drop, window resizing, and of course, mouse movement and clicks. Scroll down the Properties window and look through the names of the different events your TextBlock can add event handlers for. <strong>Double-click inside the box to the right of the event called MouseDown.</strong></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/034fig02.png"/>
<h6/>
</div></figure>
<p>The IDE filled in the MouseDown box with a method name, TextBlock_MouseDown, and the XAML for the TextBlock now has a MouseDown property:</p>
<pre data-type="programlisting">&lt;TextBlock Text="?" FontSize="36" HorizontalAlignment="Center" 
      VerticalAlignment="Center" <strong>MouseDown="TextBlock_MouseDown"</strong>/&gt;</pre>
<p>You might not have noticed that, because the IDE also <strong>added a new method</strong> to the code-behind—the code that’s joined with the XAML—and immediately switched to the C# editor to display it. You can always jump right back to it from the XAML editor by right-clicking on TextBlock_MouseDown in the XAML editor and choosing View Code. Here’s the method it added:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/034fig04.png"/>
<h6/>
</div></figure>
<p>Whenever the player clicks on the TextBlock, the app will automatically call the TextBlock_MouseDown method. So now we just need to add code to it. Then we’ll need to hook up all of the other TextBlocks so they call it, too.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>An <u>event handler</u> is a method that your app calls in response to an event like a mouse click, keypress, or window resize.</strong></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0003">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p>Here’s the code for the TextBlock_MouseDown method. Before you add this code to your program, read through it and try to figure out what it does. It’s OK if you’re not 100% right! The goal is to start training your brain to recognize C# as something you can read and make sense of.</p>
<pre data-type="programlisting">TextBlock lastTextBlockClicked;
bool findingMatch = false;
private void TextBlock_MouseDown(object sender, MouseButtonEventArgs e)
{
    TextBlock textBlock = sender as TextBlock;
    if (findingMatch == false)
    {
       textBlock.Visibility = Visibility.Hidden;
       lastTextBlockClicked = textBlock;
       findingMatch = true;
    }
    else if (textBlock.Text == lastTextBlockClicked.Text)
    {
       textBlock.Visibility = Visibility.Hidden;
       findingMatch = false;
    }
    else
    {
       lastTextBlockClicked.Visibility = Visibility.Visible;
       findingMatch = false;
    }
}</pre>
<ol>
<li><p>What does <em>findingMatch</em> do?</p>
<p>-------------------------------------------------------------------------------------</p>
<p>-------------------------------------------------------------------------------------</p></li>
<li><p>What does the block of code starting with <em>if (findingMatch == false)</em> do?</p>
<p>-------------------------------------------------------------------------------------</p>
<p>-------------------------------------------------------------------------------------</p></li>
<li><p>What does the block of code starting with <em>else if (textBlock.Text == lastTextBlockClicked.Text)</em> do?</p>
<p>-------------------------------------------------------------------------------------</p>
<p>-------------------------------------------------------------------------------------</p></li>
<li><p>What does the block of code starting with <em>else</em> do?</p>
<p>-------------------------------------------------------------------------------------</p>
<p>-------------------------------------------------------------------------------------</p></li>
</ol>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0004">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil solution</h5>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="TextBlock_MouseDown method" data-type="indexterm" id="idm46402349139432"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="TextBlock_MouseDown method" data-type="indexterm" id="idm46402349137880"/><a data-primary="TextBlocks" data-secondary="exercises on" data-type="indexterm" id="idm46402349136760"/>Here’s the code for the TextBlock_MouseDown method. Before you add this code to your program, read through it and try to figure out what it does. It’s OK if you’re not 100% right! The goal is to start training your brain to recognize C# as something you can read and make sense of.</p>
<pre data-type="programlisting">TextBlock lastTextBlockClicked;
bool findingMatch = false;
private void TextBlock_MouseDown(object sender, MouseButtonEventArgs e)
{
    TextBlock textBlock = sender as TextBlock;
    if (findingMatch == false)
    {
        textBlock.Visibility = Visibility.Hidden;
        lastTextBlockClicked = textBlock;
        findingMatch = true;
    }
    else if (textBlock.Text == lastTextBlockClicked.Text)
    {
        textBlock.Visibility = Visibility.Hidden;
        findingMatch = false;
    }
    else
    {
        lastTextBlockClicked.Visibility = Visibility.Visible;
        findingMatch = false;
    }
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Here’s what all of the code in the TextBlock_MouseDown method does. Reading code in a new programming language is a lot like reading sheet music—it’s a skill that takes practice, and the more you do it the better you get at it.</strong></p>
</div>
<ol>
<li><p>What does <em><code>findingMatch</code></em> do?</p>
<p><u>It keeps track of whether or not the player just clicked on the first animal in a pair and is now trying to find its match.</u></p></li>
<li><p>What does the block of code starting with <em><code>if (findingMatch == false)</code></em> do?</p>
<p><u>The player just clicked the first animal in a pair, so it makes that animal invisible and keeps track of its TextBlock in case it needs to make it visible again.</u></p></li>
<li><p>What does the block of code starting with else <em><code>if (textBlock.Text == lastTextBlockClicked.Text)</code></em> do?</p>
<p><u>The player found a match! So it makes the second animal in the pair invisible (and unclickable) too, and resets findingMatch so the next animal clicked on is the first one in a pair again.</u></p></li>
<li><p>What the does block of code starting with <em><code>else</code></em> do?</p>
<p><u>The player clicked on an animal that doesn’t match, so it makes the first animal that was clicked visible again and resets findingMatch</u></p></li>
</ol>
</div></aside>
</div></section>
<section data-pdf-bookmark="Add the TextBlock_MouseDown code" data-type="sect1"><div class="sect1" id="add_the_textblock_mousedown_code">
<h1>Add the TextBlock_MouseDown code</h1>
<p><a data-primary="fields" data-secondary="defined" data-type="indexterm" id="idm46402349122888"/><a data-primary="TextBlock_MouseDown" data-type="indexterm" id="idm46402349121560"/>Now that you’ve read through the code for TextBlock_MouseDown, it’s time to add it to your program. Here’s what you’ll do next:</p>
<ol>
<li><p>Add the first two lines with <code>lastTextBlockClicked</code> and <code>findingMatch</code> <strong>above the first line</strong> of the TextBlock_MouseDown method that the IDE added for you. Make sure you put them between the closing curly bracket at the end of SetUpGame and the new code the IDE just added.</p></li>
<li><p><strong>Fill in the code</strong> for TextBlock_MouseDown. Be really careful about equals signs—there’s a big difference between = and == (which you’ll learn about in the next chapter).</p></li>
</ol>
<p>Here’s what it looks like in the IDE:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/037fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Make the rest of the TextBlocks call the same MouseDown event handler" data-type="sect1"><div class="sect1" id="make_the_rest_of_the_textblocks_call_the">
<h1>Make the rest of the TextBlocks call the same MouseDown event handler</h1>
<p><a data-primary="event handlers" data-secondary="calling" data-type="indexterm" id="idm46402349113080"/><a data-primary="TextBlocks" data-secondary="calling event handlers" data-type="indexterm" id="idm46402349111656"/>Right now only the first TextBlock has an event handler hooked up to its MouseDown event. Let’s hook up the other 15 TextBlocks to it, too. You <em>could</em> do it by selecting each one in the designer and entering TextBlock_MouseDown into the box next to MouseDown. We already know that just adds a property to the XAML code, so let’s take a shortcut.</p>
<ol>
<li><p> <strong>Select the last 15 TextBlocks in the XAML editor.</strong></p>
<p>Go to the XAML editor, click to the left of the <u>second</u> <code>TextBlock</code> tag, and drag down to the end of the TextBlocks, just above the closing <code>&lt;/</code><code><strong>Grid</strong></code><code>&gt;</code> tag. You should now have the last 15 TextBlocks selected (but not the first one).</p></li>
<li><p> <strong>Use Quick Replace to add MouseDown event handlers.</strong></p>
<p>Choose <strong>Find and Replace &gt;&gt; Quick Replace</strong> from the Edit menu. Search for <code>/&gt;</code> and replace it with <code>MouseDown="</code><code><em>TextBlock_MouseDown</em></code><code>"/&gt;</code>—make sure that there’s a space before <code>MouseDown</code> and that the search range is <em>Selection</em> so it only adds the property to the selected TextBlocks.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/038fig01.png"/>
<h6/>
</div></figure>
</li>
<li><p> <strong>Run the replace over all 15 selected TextBlocks.</strong></p>
<p>Click the Replace All button (<span class="inlineimage"><img alt="Images" src="assets/038fig02.png"/></span>) to add the MouseDown property to the TextBlocks—it should tell you that 15 occurrences were replaced. Carefully examine the XAML code to make sure they each have a MouseDown property that exactly matches the one in the first TextBlock.</p>
<p>Make sure that the method now shows <strong>16 references</strong> in the C# editor (choose Build Solution from the Build menu to update it). If you see 17 references, you accidentally attached the event handler to the Grid. You definitely <u>don’t</u> want that—if you do, you’ll get an exception when you click an animal.</p></li>
</ol>
<p>Run your program. Now you can click on pairs of animals to make them disappear. The first animal you click will disappear. If you click on its match, that one disappears, too. If you click on an animal that doesn’t match, the first one will appear again. When all the animals are gone, restart or close the program.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0001">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p><strong>You’ve reached a checkpoint in your project!</strong> Your game might not be finished yet, but it works and it’s playable, so this is a great time to step back and think about how you could make it better. What could you change to make it more interesting?</p>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">When you see a Brain Power element, take a minute and really think about the question that it’s asking.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/039fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Finish the game by adding a timer" data-type="sect1"><div class="sect1" id="finish_the_game_by_adding_a_timer">
<h1>Finish the game by adding a timer</h1>
<p><a data-primary="timers, adding" data-type="indexterm" id="idm46402349085016"/>Our animal match game will be more exciting if players can try to beat their best time. We’ll add a <strong>timer</strong> that “ticks” after a fixed interval by repeatedly calling a method.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/039fig02.png"/>
<h6/>
</div></figure>
<blockquote>
<p><span class="inlineimage"><img alt="Images" src="assets/039fig03.png"/></span></p>
<p><strong>Timers “tick” every time interval by calling methods over and over again. You’ll use a timer that starts when the player starts the game and ends when the last animal is matched.</strong></p>
</blockquote>
</div></section>
<section data-pdf-bookmark="Add a timer to your game’s code" data-type="sect1"><div class="sect1" id="add_a_timer_to_your_gameapostrophes_code">
<h1>Add a timer to your game’s code</h1>
<ol>
<li><p>Start by finding the <code>namespace</code> keyword near the top of <em>MainWindow.xaml.cs</em> and add the line <code>using System.Windows.Threading;</code> directly underneath it:</p>
<pre data-type="programlisting"> <span style="color:#9D9EA0;">namespace MatchGame</span>
 <span style="color:#9D9EA0;">{</span>
    using System.Windows.Threading;</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Add this!</strong></p>
</div></li>
<li><p>Find <code><em>public partial class MainWindow</em></code> and <strong>add this code</strong> just after the opening curly bracket <code><strong>{</strong></code>:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">public partial class MainWindow : Window</span>
{
    DispatcherTimer timer = new DispatcherTimer();
    int tenthsOfSecondsElapsed;
    int matchesFound;</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You’ll add these three lines of code to create a new timer and add two fields to keep track of the time elapsed and number of matches the player has found.</span></p>
</div></li>
<li><p>We need to tell our timer how frequently to “tick” and what method to call. Click at the beginning of the line where you call the SetUpGame method to move the editor’s cursor there. Press Enter, then type the two lines of code in the screenshot below that start with <code><strong>timer.</strong></code>—as soon as you type <code>+=</code> the IDE will display a message:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/040fig03.png"/>
<h6/>
</div></figure></li>
<li><p>Press the Tab key. The IDE will finish the line of code and add a Timer_Tick method:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/040fig04.png"/>
<h6/>
</div></figure></li>
<li><p>The Timer_Tick method will update a TextBlock that spans the entire bottom row of the grid. Here’s how to set it up:</p>
<ul>
<li><p>Drag a <strong>TextBlock</strong> into the lower-left square.</p></li>
<li><p>Use the <strong>Name box</strong> at the top of the Properties window to give it the name <code><strong>timeTextBlock.</strong></code></p></li>
<li><p>Reset its <strong>margins</strong>, <strong>center</strong> it in the cell, and set the <strong>FontSize</strong> property to 36px and <strong>Text</strong> property to “Elapsed time” (just like you did with other controls).</p></li>
<li><p>Find the <strong>ColumnSpan</strong> property and set it to 4.</p></li>
<li><p>Add a <strong>MouseDown event handler</strong> called TimeTextBlock_MouseDown.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/041fig01.png"/>
<h6/>
</div></figure>
<p>Here’s what the XAML will look like—carefully compare it with your code in the IDE:</p>
<pre data-type="programlisting"><strong>&lt;TextBlock</strong> x:Name="<em>timeTextBlock</em> <strong>"</strong>Text="<em>Elapsed time</em><strong>"</strong> FontSize="<em>36</em><strong>"</strong>
    HorizontalAlignment="<em>Center</em><strong>"</strong> VerticalAlignment="<em>Center</em><strong>"</strong>
    Grid.Row="<em>4</em><strong>"</strong> Grid.ColumnSpan="<em>4</em><strong>"</strong> MouseDown="<em>TimeTextBlock_MouseDown</em><strong>"/&gt;</strong></pre></li>
<li><p>When you added the MouseDown event handler, Visual Studio created a method in the code-behind called TimeTextBlock_MouseDown, just like with the other TextBlocks. Add this code to it:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">private void TimeTextBlock_MouseDown(object sender, MouseButtonEventArgs e)</span>
<span style="color:#9D9EA0;">{</span>
    if (matchesFound == 8)
    {
        SetUpGame();
    }
<span style="color:#9D9EA0;">}</span></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">This resets the game if all 8 matched pairs have been found (otherwise it does nothing because the game is still running).</span></p>
</div>
</li>
<li><p>Now you have everything you need to finish the Timer_Tick method, which updates the new TextBlock with the elapsed time and stops the timer once the player has found all of the matches:</p>
<pre data-type="programlisting">private void Timer_Tick(object sender, EventArgs e)
{
    tenthsOfSecondsElapsed++;
    timeTextBlock.Text = (tenthsOfSecondsElapsed / 10F).ToString("0.0s");
    if (matchesFound == 8)
    {
        timer.Stop();
        timeTextBlock.Text = timeTextBlock.Text + " - Play again?";
    }
}</pre>
<p><strong><em>But something’s not quite right here.</em></strong> Run your code... oops! You get an <strong>exception</strong>.</p>
<p>We’re about to fix this problem, but first look closely at the error message and highlighted line in the IDE.</p>
<p><strong><em>Can you guess what caused the error?</em></strong></p>
</li>
</ol>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/041fig04.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="Use the debugger to troubleshoot the exception" data-type="sect1"><div class="sect1" id="use_the_debugger_to_troubleshoot_the_exc">
<h1>Use the <u>debugger</u> to troubleshoot the exception</h1>
<p><a data-primary="debugger" data-secondary="troubleshooting exceptions with" data-type="indexterm" id="idm46402349025768"/><a data-primary="exception handling" data-type="indexterm" id="idm46402349024456"/><a data-primary="try/catch/finally sequence for error handling" data-see="exception handling" data-type="indexterm" id="idm46402349023720"/>You might have heard the word “bug” before. You might have even said something like this to your friends at some point in the past: “That game is really buggy, it has so many glitches.” Every bug has an explanation—everything in your program happens for a reason—but not every bug is easy to track down.</p>
<p><strong><em>Understanding a bug is the first step in fixing it.</em></strong> Luckily, the Visual Studio debugger is a great tool for that. (That’s why it’s called a debugger: it’s a tool that helps you get rid of bugs!)</p>
<ol>
<li><p> <strong>Restart your game a few times.</strong></p>
<p>The first thing to notice is that your program always throws the same type of exception with the same message:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/042fig01.png"/>
<h6/>
</div></figure>
<p>If you move the exception window out of the way, you’ll see that it always stops on the same line:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/042fig02.png"/>
<h6/>
</div></figure>
<p>This exception is <strong>reproducible</strong>: you can reliably get your program to throw the exact same exception, and you have a really good idea of where the problem is.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="anatomy_of_the_debugger">
<h5><span class="inlineimage"><img alt="Images" src="assets/icon4.png"/></span> <strong>Anatomy of the debugger</strong></h5>
<p><a data-primary="Break All button" data-type="indexterm" id="idm46402349011384"/><a data-primary="breakpoints" data-type="indexterm" id="idm46402349010648"/><a data-primary="debugger" data-secondary="anatomy of" data-type="indexterm" id="idm46402349009912"/><a data-primary="debugger" data-secondary="exercises for" data-type="indexterm" id="idm46402349008872"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="debugging" data-type="indexterm" id="idm46402349007720"/><a data-primary="Restart button" data-type="indexterm" id="idm46402349006328"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="debugging" data-type="indexterm" id="idm46402349005528"/><a data-primary="Show Next Statement button" data-type="indexterm" id="idm46402349004376"/><a data-primary="Step Into button" data-type="indexterm" id="idm46402349003576"/><a data-primary="Step Out button" data-type="indexterm" id="idm46402349002664"/><a data-primary="Step Over button" data-type="indexterm" id="idm46402349001896"/><a data-primary="Stop Debugging button" data-type="indexterm" id="idm46402349000984"/><strong>When your app is paused in the debugger—that’s called “breaking” the app—the Debug controls show up in the toolbar. You’ll get plenty of practice using them throughout the book, so you don’t need to memorize what they do. For now, just read the descriptions we’ve written, and hover your mouse over them so you can see their names and shortcut keys.</strong></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/043fig01.png"/>
<h6/>
</div></figure>
</div></aside>
</li>
<li><p><strong>Add a breakpoint to the line that’s throwing the exception.</strong></p>
<p>Run your program again so it halts on the exception. Before you stop it, choose <strong>Toggle Breakpoint (F9)</strong> from the Debug menu. As soon as you do, the line will be highlighted in red, and a red dot will appear in the left margin next to the line. Now <strong>stop your app again</strong>—the highlight and dot will still be there:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/043fig02.png"/>
<h6/>
</div></figure>
<p><strong><em>You’ve just placed a breakpoint on the line.</em></strong> Your program will now break every time it executes that line of code. Try that out now. Run your app again. The program will halt on that line, but this time <em>it won’t throw the exception</em>. Press Continue. It halts on the line again. Press Continue again. It halts again. Keep going until you see the exception. Now stop your app.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0005">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p>Run your app again, but this time pay close attention and answer these questions.</p>
<ol>
<li><p>How many times does your app halt on the breakpoint before the exception? ___________________</p></li>
<li><p>A Locals window appears when you’re debugging your app. What do you think it does? (If you don’t see the Locals window, choose <strong><em>Debug &gt;&gt; Windows &gt;&gt; Locals (Ctrl D, L)</em></strong> from the menu.)</p>
<p>____________________________________________________________</p>
<p>____________________________________________________________</p></li>
</ol>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd001">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p><a data-primary="foreach loops" data-secondary="about" data-type="indexterm" id="idm46402348983656"/><a data-primary="loops" data-secondary="foreach" data-see="foreach loops" data-type="indexterm" id="idm46402348982344"/><span style="color:#9D9EA0;">Your app halted 17 times. After the 17th time it threw the exception.</span></p>
<p><span style="color:#9D9EA0;">The Locals window shows you the current values of the variables and fields. You can use it to watch them change as your program runs.</span></p>
</div></aside></li>
<li><p><strong>Gather evidence so you can figure out what’s causing the problem.</strong></p>
<p>Did you notice anything interesting in the Locals window when you ran your app? Restart it and keep a really close eye on the <code>animalEmoji</code> variable. The first time your app breaks, you should see this in the Locals window:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/044fig02.png"/>
<h6/>
</div></figure>
<p>Press Continue. It looks like the Count went down by 1, from 16 to 15:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/044fig03.png"/>
<h6/>
</div></figure>
<p>The app is adding random emoji from the <code>animalEmoji</code> list to the TextBlocks and then removing them from the list, so its count should go down by 1 each time. Things go just fine until the <code>animalEmoji</code> list is empty (so Count is 0), then you get the exception. So that’s one piece of evidence! Another piece of evidence is that this is happening in a <code><strong>foreach  loop</strong></code>. And the last piece of evidence is that <strong><em>this all started after we added a new TextBlock to the window</em></strong>.</p>
<p><strong>Time to put on your Sherlock Holmes cap. Can you sleuth out what’s causing the exception?</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="behind_the_scenes-idd0001">
<h5><span class="inlineimage"><img alt="Images" src="assets/icon5.png"/></span> Behind the Scenes</h5>
<p><strong>foreach is a kind of <u>loop</u> that runs on every element in a collection.</strong></p>
<p>A loop is a way to run a block of code over and over again. Your code uses a <code><strong>foreach loop</strong></code>, or a special kind of loop that runs the same code for each element in a collection (like your <code>animalEmoji</code> list) Here’s an example of a <code>foreach</code> loop that uses a List of numbers:</p>
<pre data-type="programlisting">List&lt;int&gt; numbers = new List&lt;int&gt;() { 2, 5, 9, 11 };
foreach (int aNumber in numbers)
{
    Console.WriteLine("The number is " + aNumber);
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">This foreach loop runs a Console.WriteLine statement for every number in a list. ints</span></p>
</div>
<p>The above <code>foreach</code> loop creates a new variable called <code>aNumber</code>. Then it goes through the <code>numbers</code> List in order and executes the <code>Console.WriteLine</code> for each of them, setting <code>aNumber</code> to each value in the List in order:</p>
<pre data-type="programlisting">The number is 2
The number is 5
The number is 9
The number is 11</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The foreach loop runs the same code over and over again for each element in the collection, setting the variable to the next element each time. So in this case, it sets oneNumber to the next number in the List and uses it to print a line of text.</span></p>
</div>
<p>We’re introducing a new concept here—but just briefly, so there’s no mystery about how your code works. We’ll talk a lot more about loops in <a href="ch02.html#dive_into_chash_statementscomma_classesc">#dive_into_chash_statementscomma_classesc</a>. Then in <a href="ch03.html#objectshellipget_orientedexclamation_mar">#objectshellipget_orientedexclamation_mar</a> we’ll come back to <code>foreach</code> loops, and you’ll write one that looks a lot like the loop above. So even if this seems a little fast right now, when you come back to this example when you’re working on <a href="ch03.html#objectshellipget_orientedexclamation_mar">#objectshellipget_orientedexclamation_mar</a>, see if it makes more sense than when you first saw it. We find rereading code once you have more context really helps get it into your brain…so don’t worry if the concepts still seem a little nebulous now.</p>
</div></aside></li>
<li><p><strong>Figure out what’s actually causing the bug.</strong></p>
<p>The reason your program is crashing is because it’s trying to get the next emoji from the <code>animalEmoji</code> list but the list is empty, and that causes it to throw an ArgumentOutOfRange exception. What caused it to run out of emoji to add?</p>
<p>Your program worked before you made the most recent change. Then you added a TextBlock…and then it stopped working. Right inside of a loop that iterates through all of the TextBlocks. A clue…how very, very interesting.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/045fig01.png"/>
<h6/>
</div></figure>
<p>So when you run your app, <em><strong>it breaks on this line for every TextBlock in the window</strong></em>. So for the first 16 TextBlocks, everything goes fine because there are enough emoji in the collection:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/045fig02.png"/>
<h6/>
</div></figure>
<p>But now that there’s a new TextBlock at the bottom of the window, it breaks a 17th time—and since the <code><strong>animalEmoji</strong></code> collection only had 16 emoji in it, it’s now empty:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/045fig03.png"/>
<h6/>
</div></figure>
<p>So before you made the change, you had 16 TextBlocks and a list of 16 emoji, so there were just enough emoji to add one to each TextBlock. Now you have 17 TextBlocks but still only 16 emoji, so your program runs out of emoji to add…and then it throws the exception.</p></li>
<li><p><strong>Fix the bug.</strong></p>
<p>Since the exception is being thrown because we’re running out of emoji in the loop that iterates through the TextBlocks, we can fix it by skipping the TextBlock we just added. We can do that by checking the TextBlock’s name and skipping the one that we added to show the time. Remove the breakpoint by toggling it again or choosing <strong>Delete All Breakpoints (Ctrl+Shift+F9)</strong> from the Debug menu.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/045fig04.png"/>
<h6/>
</div></figure></li>
</ol>
</div></section>
<section data-pdf-bookmark="Add the rest of the code and finish the game" data-type="sect1"><div class="sect1" id="add_the_rest_of_the_code_and_finish_the">
<h1>Add the rest of the code and <u>finish the game</u></h1>
<p>There’s one more thing you need to do. Your TimeTextBlock_MouseDown method checks the matchesFound field, but that field is never set anywhere. So add these three lines to the SetUpGame method immediately after the closing bracket of the foreach loop:</p>
<pre data-type="programlisting">            <span style="color:#9D9EA0;"> animalEmoji.RemoveAt(index);</span>
         <span style="color:#9D9EA0;"> }</span>
      <span style="color:#9D9EA0;"> }</span>
       timer.Start();
       tenthsOfSecondsElapsed = 0;
       matchesFound = 0;
   <span style="color:#9D9EA0;">}</span></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Add these three lines of code to the very end of the SetUpGame method to start the timer and reset the fields.</span></p>
</div>
<p>Then add this statement to the <u>middle</u> block of the <code>if/else</code> in TextBlock_MouseDown:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">else if (textBlock.Text == lastTextBlockClicked.Text)</span>
<span style="color:#9D9EA0;">{</span>
    matchesFound++;
    <span style="color:#9D9EA0;">textBlock.Visibility = Visibility.Hidden;</span>
    <span style="color:#9D9EA0;">findingMatch = false;</span>
<span style="color:#9D9EA0;">}</span></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Add this line of code to increase matchesFound by one every time the player successfully finds a match.</span></p>
</div>
<p>Now your game has a timer that stops when the player finishes matching animals, and when the game is over you can click it to play again. <strong><em>You’ve built your first game in C#. Congratulations!</em></strong></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/046fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Go to</strong>  <a href="https://github.com/head-first-csharp/fourth-edition">https://github.com/head-first-csharp/fourth-edition</a>  <strong>to view and download the complete code for this project and all of the other projects in this book.</strong></p>
</div>
</div></section>
<section data-pdf-bookmark="Update your code in source control" data-type="sect1"><div class="sect1" id="update_your_code_in_source_control">
<h1>Update your code in source control</h1>
<p><a data-primary="commit, Git" data-type="indexterm" id="idm46402348915848"/><a data-primary="Git" data-type="indexterm" id="idm46402348914744"/><a data-primary="publishing to GitHub" data-type="indexterm" id="idm46402348913832"/><a data-primary="source control" data-type="indexterm" id="idm46402348913000"/>Now that your game is up and running, it’s a great time to <strong>push your changes to Git</strong>, and Visual Studio makes it easy to do that. All you need to do is <em>stage</em> your commits, enter a commit message, and then sync to the remote repo.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/047fig01.png"/>
<h6/>
</div></figure>
<ol start="3">
<li><p>Choose <strong>Commit Staged and Sync</strong> from the commit dropdown (it’s right under the commit message box). It may take a few seconds to sync, and then you’ll see a success message in the Team Explorer window.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/047fig02.png"/>
<h6/>
</div></figure></li>
</ol>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/047fig03.png"/>
<h6/>
</div></figure>
<p><strong>Whenever you have a large project, it’s always a good idea to break it into smaller pieces.</strong></p>
<p>One of the most useful programming skills that you can develop is the ability to look at a large and difficult problem and break it down into smaller, easier problems.</p>
<p>It’s really easy to be overwhelmed at the beginning of a big project and think, “Wow, that’s just so…big!” But if you can find a small piece that you can work on, then you can get started. Once you finish that piece, you can move on to another small piece, and then another, and then another. As you build each piece, you learn more and more about your big project along the way.</p>
</div></section>
<section data-pdf-bookmark="Even better ifs…" data-type="sect1"><div class="sect1" id="even_better_ifshellip">
<h1>Even better ifs…</h1>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="determining game improvements" data-type="indexterm" id="idm46402348902808"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="determining game improvements" data-type="indexterm" id="idm46402348901224"/>Your game is pretty good! But every game—in fact, pretty much every program—can be improved. Here are a few things that we thought of that could make the game better:</p>
<ul>
<li><p>Add different kinds of animals so the same ones don’t show up each time.</p></li>
<li><p>Keep track of the player’s best time so they can try to beat it.</p></li>
<li><p>Make the timer count down instead of counting up so the player has a limited amount of time.</p></li>
</ul>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0006">
<h5><span class="inlineimage"><img alt="Images" src="assets/Common.png"/></span> Mini Sharpen your pencil</h5>
<p>Can you think of your own “even better if” improvements for the game? This is a great exercise—take a few minutes and write down at least three improvements to the animal matching game.</p>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">We’re serious—take a few minutes and do this. Stepping back and thinking about the project you just finished is a great way to seal the lessons you learned into your brain.</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-idd0002">
<h5>Bullet Points</h5>
<ul>
<li><p>Visual Studio tracks the number of times a method is <strong>referenced</strong> elsewhere in the C# or XAML code.</p></li>
<li><p>An <strong>event handler</strong> is a method that your application calls when a specific event like a mouse click, keypress, or window resize happens.</p></li>
<li><p>The IDE makes it easy to <strong>add and manage</strong> your event handler methods.</p></li>
<li><p>The IDE’s <strong>Error List window</strong> shows any errors that prevent your code from building.</p></li>
<li><p><strong>Timers</strong> execute Tick event handler methods over and over again on a specified interval.</p></li>
<li><p><strong>foreach</strong> is a kind of loop that iterates through a collection of items.</p></li>
<li><p>When your program throws an <strong>exception</strong>, gather evidence and try to figure out what’s causing it.</p></li>
<li><p>Exceptions are easier to fix when they’re <strong>reproducible</strong>.</p></li>
<li><p>Visual Studio makes it really easy to use <strong>source control</strong> to back up your code and keep track of all changes that you’ve made.</p></li>
<li><p>You can commit your code to a <strong>remote Git repository</strong>. We use GitHub for the repository with the source code for all of the projects in this book.</p></li>
</ul>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Just a quick reminder: we’ll refer to Visual Studio as “the IDE” a lot in this book.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/048fig02.png"/>
<h6/>
</div></figure>
</div></section>
</div></section></body></html>