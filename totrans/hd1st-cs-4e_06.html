<html><head></head><body><section data-pdf-bookmark="Chapter 4. Types and References: Getting the Reference" data-type="chapter" epub:type="chapter"><div class="chapter" id="types_and_references_getting_the_referen">
<h1><span class="label">Chapter 4. </span>Types and References: <em>Getting the Reference</em></h1>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/155fig01.png"/>
<h6/>
</div></figure>
<p><a data-primary="types" data-secondary="about" data-type="indexterm" id="idm46402346736424"/><strong>What would your apps be without data?</strong> Think about it for a minute. Without data, your programs are…well, it’s actually hard to imagine writing code without data. You need <strong>information</strong> from your users, and you use that to look up or produce new information to give back to them. In fact, almost everything you do in programming involves <strong>working with data</strong> in one way or another. In this chapter, you’ll learn the ins and outs of C#’s <strong>data types</strong> and <strong>references</strong>, see how to work with data in your program, and even learn a few more things about <strong>objects</strong> (<em>guess what…objects are data, too!</em>)</p>
<section data-pdf-bookmark="Owen could use our help!" data-type="sect1"><div class="sect1" id="owen_could_use_our_helpexclamation_mark">
<h1>Owen could use our help!</h1>
<p><a data-primary="ability score, in role-playing games" data-type="indexterm" id="idm46402346730632"/>Owen is a game master—a really good one. He hosts a group that meets at his place every week to play different role-playing games (or RPGs), and like any good game master, he really works hard to keep things interesting for the players.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/156fig01.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/156fig02.png"/>
<h6/>
</div></figure>
<section data-pdf-bookmark="Storytelling, fantasy, and mechanics" data-type="sect2"><div class="sect2" id="storytellingcomma_fantasycomma_and_mecha">
<h2>Storytelling, fantasy, and mechanics</h2>
<p>Owen is a particularly good storyteller. Over the last few months he’s created an intricate fantasy world for his party, but he’s not so happy with the mechanics of the game that they’ve been playing.</p>
<p><strong><em>Can we find a way to <u>help Owen improve his RPG?</u></em></strong></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/156fig03.png"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-pdf-bookmark="Character sheets store different types of data on paper" data-type="sect1"><div class="sect1" id="character_sheets_store_different_types_o">
<h1>Character sheets store different types of data on paper</h1>
<p><a data-primary="character sheets, in role-playing games" data-type="indexterm" id="idm46402346719080"/>If you’ve ever played an RPG, you’ve seen character sheets: a page with details, statistics, background information, and any other notes you might see about a character. If you wanted to make a class to hold a character sheet, what types would you use for the fields?</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/157fig01.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/157fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0006">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p>Look at the fields in the CharacterSheet class diagram. What type would you use for each field?</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="A variable’s type determines what kind of data it can store" data-type="sect1"><div class="sect1" id="a_variableapostrophes_type_determines_wh">
<h1>A variable’s <u>type</u> determines what kind of data it can store</h1>
<p><a data-primary="bool type" data-type="indexterm" id="idm46402346708360"/><a data-primary="double type" data-type="indexterm" id="idm46402346707112"/><a data-primary="float type" data-type="indexterm" id="idm46402346706264"/><a data-primary="int type" data-secondary="about" data-type="indexterm" id="idm46402346705528"/><a data-primary="string type" data-type="indexterm" id="idm46402346704488"/>There are many <strong>types</strong> built into C#, and you’ll use them to store many different kinds of data. You’ve already seen some of the most common ones, like int, string, bool, and float. There are a few others that you haven’t seen, and they can really come in handy, too.</p>
<p>Here are some types you’ll use a lot.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/158fig01.png"/>
<h6/>
</div></figure>
<ul>
<li><p><strong>int</strong> can store any <strong>integer</strong> from –2,147,483,648 to 2,147,483,647. Integers don’t have decimal points.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/158fig02.png"/>
<h6/>
</div></figure>
<ul>
<li><p><strong>float</strong> can store <strong>real</strong> numbers from ±1.5 × 10<sup>–45</sup> to ±3.4 × 10<sup>38</sup> with up to 8 significant digits.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/158fig03.png"/>
<h6/>
</div></figure>
<ul>
<li><p><strong>string</strong> can hold text of any length (including the empty string <code>""</code>).</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/158fig05.png"/>
<h6/>
</div></figure>
<ul>
<li><p><strong>double</strong> can store <strong>real</strong> numbers from ±5.0 × 10<sup>–324</sup> to ±1.7 × 10<sup>308</sup> with up to 16 significant digits. It’s a really common type when you’re working with XAML properties.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/158fig04.png"/>
<h6/>
</div></figure>
<ul>
<li><p><strong>bool</strong> is a Boolean value—it’s either true or false. You’ll use it to represent anything that <u>only has two options</u>: it can either be one thing or another, but nothing else.</p></li>
</ul>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0007">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p>Why do you think C# has more than one type for storing numbers that have a decimal point?</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="C# has several types for storing integers" data-type="sect1"><div class="sect1" id="chash_has_several_types_for_storing_inte">
<h1>C# has several types for storing integers</h1>
<p><a data-primary="byte type" data-type="indexterm" id="idm46402346676728"/><a data-primary="long type" data-type="indexterm" id="idm46402346675592"/><a data-primary="sbyte type" data-type="indexterm" id="idm46402346674776"/><a data-primary="short type" data-type="indexterm" id="idm46402346674040"/><a data-primary="signed types" data-type="indexterm" id="idm46402346673272"/><a data-primary="uint type" data-type="indexterm" id="idm46402346672360"/><a data-primary="ulong type" data-type="indexterm" id="idm46402346671560"/><a data-primary="unsigned types" data-type="indexterm" id="idm46402346670712"/><a data-primary="ushort type" data-type="indexterm" id="idm46402346669976"/><a data-primary="value types" data-secondary="sbyte" data-type="indexterm" id="idm46402346669160"/><a data-primary="value types" data-secondary="signed types" data-type="indexterm" id="idm46402346668152"/><a data-primary="value types" data-secondary="uint" data-type="indexterm" id="idm46402346667144"/><a data-primary="value types" data-secondary="ulong" data-type="indexterm" id="idm46402346665960"/><a data-primary="value types" data-secondary="unsigned types" data-type="indexterm" id="idm46402346664840"/><a data-primary="value types" data-secondary="ushort" data-type="indexterm" id="idm46402346663688"/>C# has several different types for integers, as well as int. This may seem a little odd (pun intended). Why have so many types for numbers without decimals? For most of the programs in this book, it won’t matter if you use an int or a long. If you’re writing a program that has to keep track of millions and millions of integer values, then choosing a smaller integer type like byte instead of a bigger type like long can save you a lot of memory.</p>
<ul>
<li><p><strong><em>byte</em></strong> can store any <strong>integer</strong> between 0 and 255.</p></li>
<li><p><strong><em>sbyte</em></strong> can store any <strong>integer</strong> from –128 to 127.</p></li>
<li><p><strong><em>short</em></strong> can store any <strong>integer</strong> from –32,768 to 32,767.</p></li>
<li><p><strong><em>long</em></strong> can store any <strong>integer</strong> from –9,223,372,036,854,775,808 to 9,223,372,036,854,775,807.</p></li>
</ul>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Notice how we’re saying “integer” and not “whole number” ? We’re trying to be really careful—our high school math teachers always told us that integers are any numbers that can be written without a fraction, while whole numbers are integers starting at 0, and do not include negative numbers.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/159fig02.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/159fig03.png"/>
<h6/>
</div></figure>
<p>Did you notice that byte only stores positive numbers, while sbyte stores negative numbers? They both have 256 possible values. The difference is that, like short and long, sbyte can have a negative sign—which is why those are called <strong>signed</strong> types, (the “s” in sbyte stands for signed). Just like byte is the <strong>unsigned</strong> version of sbyte, there are unsigned versions of short, int, and long that start with “u” :</p>
<ul>
<li><p><strong><em>ushort</em></strong> can store any <strong>whole number</strong> from 0 to 65,535.</p></li>
<li><p><strong><em>uint</em></strong> can store any <strong>whole number</strong> from 0 to 4,294,967,295.</p></li>
<li><p><strong><em>ulong</em></strong> can store any <strong>whole number</strong> from 0 to 18,446,744,073,709,551,615.</p></li>
</ul>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/159fig04.png"/>
<h6/>
</div></figure>
<section data-pdf-bookmark="Types for storing really HUGE and really tiny numbers" data-type="sect2"><div class="sect2" id="types_for_storing_really_huge_and_really">
<h2>Types for storing really HUGE and really tiny numbers</h2>
<p><a data-primary="decimal type" data-secondary="about" data-type="indexterm" id="idm46402346639768"/><a data-primary="double type" data-type="indexterm" id="idm46402346638536"/><a data-primary="floating-point types" data-type="indexterm" id="idm46402346637736"/><a data-primary="float type" data-type="indexterm" id="idm46402346636936"/><a data-primary="significant digits" data-type="indexterm" id="idm46402346636136"/><a data-primary="value types" data-secondary="floating-point types" data-type="indexterm" id="idm46402346635320"/>Sometimes float just isn’t precise enough. Believe it or not, sometimes 10<sup>38</sup> isn’t big enough and 10<sup>–45</sup> isn’t small enough. A lot of programs written for finance or scientific research run into these problems all the time, so C# gives us different <strong>floating-point types</strong> to handle huge and tiny values:</p>
<ul>
<li><p><strong><em>float</em></strong> can store any number from ±1.5 × 10<sup>–45</sup> to ±3.4 × 10<sup>38</sup> with 6–9 significant digits.</p></li>
<li><p><strong><em>double</em></strong> can store any number from ±5.0 × 10<sup>–324</sup> to ±1.7 × 10<sup>308</sup> with 15–17 significant digits.</p></li>
<li><p><strong><em>decimal</em></strong> can store any number from ±1.0 × 10<sup>–28</sup> to ±7.9 × 10<sup>28</sup> with 28–29 significant digits. When your program <strong>needs to deal with money or currency</strong>, you <u>always</u> want to use a decimal to store the number.</p></li>
</ul>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The decimal type has a lot more precision (way more significant digits) which is why it’s appropriate for financial calculations.</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="floating_point_numbers_up_clos">
<h5><span class="inlineimage"><img alt="Images" src="assets/zoom.png"/></span> <strong>Floating-Point Numbers Up Clos</strong></h5>
<p>The float and double types are called “floating-point” because the decimal point can move (as opposed to a “fixed-point” number, which always has the same number of decimal places). That—and, in fact, a lot stuff that has to do with floating-point numbers, especially precision—may seem a little <strong><em>weird</em></strong>, so let’s dig into the explanation.</p>
<p>“Significant digits” represents the <u>precision</u> of the number: 1,048,415, 104.8415, and .0000001048415 all have 7 significant digits. So when we say a float can store real numbers as big as 3.4 × 10<sup>38</sup> or as small as –1.5 × 10<sup>-45</sup>, that means it can store numbers as big as 8 digits followed by 30 zeros, or as small as 37 zeros followed by 8 digits.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">If it’s been a while since you’ve used exponents, 3.4x10<sup>38</sup> means 34 followed by 37 zeros, and -1.5x10<sup>-45</sup> is -.00...(40 more zeros)...0015.</span></p>
</div>
<p>The float and double types can also have special values, including both positive and negative zero, positive and negative infinity, and a special value called <strong>NaN (not-a-number)</strong> that represents, well, a value that isn’t a number at all. They also have static methods that let you test for those special values. Try running this loop:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">for (float f = 10; float.IsFinite(f); f *= f)</span>
<span style="color:#9D9EA0;">{</span>
    <span style="color:#9D9EA0;">Console.WriteLine(f);</span>
<span style="color:#9D9EA0;">}</span></pre>
<p>Now try that same loop with double:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">for (double d = 10; double.IsFinite(d); d *= d)</span>
<span style="color:#9D9EA0;">{</span>
    <span style="color:#9D9EA0;">Console.WriteLine(d);</span>
<span style="color:#9D9EA0;">}</span></pre>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="Let’s talk about strings" data-type="sect1"><div class="sect1" id="letapostrophes_talk_about_strings">
<h1>Let’s talk about strings</h1>
<p><a data-primary="alias" data-type="indexterm" id="idm46402346603976"/><a data-primary="characters" data-type="indexterm" id="idm46402346603096"/><a data-primary="characters" data-secondary="Unicode" data-type="indexterm" id="idm46402346602248"/><a data-primary="char type" data-type="indexterm" id="idm46402346601240"/><a data-primary="escape sequences" data-type="indexterm" id="idm46402346600440"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="values" data-type="indexterm" id="idm46402346599528"/><a data-primary="\n (line feed character)" data-type="indexterm" id="idm46402346598280"/><a data-primary="null" data-type="indexterm" id="idm46402346597480"/><a data-primary="objects" data-secondary="object type" data-type="indexterm" id="idm46402346596568"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="values" data-type="indexterm" id="idm46402346595496"/><a data-primary="strings" data-secondary="about" data-type="indexterm" id="idm46402346594376"/><a data-primary="\t (tab character)" data-type="indexterm" id="idm46402346593224"/><a data-primary="types" data-secondary="char" data-type="indexterm" id="idm46402346592392"/><a data-primary="types" data-secondary="object" data-type="indexterm" id="idm46402346591272"/><a data-primary="Unicode" data-type="indexterm" id="idm46402346590120"/><a data-primary="values" data-type="indexterm" id="idm46402346589288"/>You’ve written code that works with <strong>strings</strong>. So what, exactly, is a string?</p>
<p>In any .NET app, a string is an object. Its full class name is System.String—in other words, the class name is String and it’s in the System namespace (just like the Random class you used earlier). When you use the C# <code><strong>string</strong></code> keyword, you’re working with System.String objects. In fact, you can replace <code><strong>string</strong></code> with <code><strong>System.String</strong></code> in any of the code you’ve written so far and it will still work! (The <code><strong>string</strong></code> keyword is called an <em>alias</em>—as far as your C# code is concerned, <code><strong>string</strong></code> and <code><strong>System.String</strong></code> mean the same thing.)</p>
<p>There are also two special values for strings: an empty string, “” (or a string with no characters), and a null string, or a string that isn’t set to anything at all. We’ll talk more about null later in the chapter.</p>
<p>Strings are made up of characters—specifically, Unicode characters (which you’ll learn a lot more about later in the book). Sometimes you need to store a single character like <code><strong>Q</strong></code> or <code><strong>j</strong></code> or <code><strong>$</strong></code>, and when you do you’ll use the <strong>char</strong> type. Literal values for char are always inside single quotes ('<code><strong>x</strong></code><code>'</code>, <code>'</code><code><strong>3</strong></code><code>'</code>). You can include <strong>escape sequences</strong> in the quotes, too (<code>'</code><code><strong>\n</strong></code><code>'</code> is a line break, <code>'</code><code><strong>\t</strong></code><code>'</code> is a tab). You can write an escape sequence in your C# code using two characters, but your program stores each escape sequence as a single character in memory.</p>
<p>And finally, there’s one more important type: <strong>object</strong>. If a variable has object as its type, <strong><em>you can assign any value to it</em></strong>. The <code><strong>object</strong></code> keyword is also an alias—it’s the same as <code><strong>System.Object</strong></code>.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0018">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p>Sometimes you declare a variable and set its value in a single statement like this: <code>int i = 37;</code>—but you already know that you don’t have to set a value. So what happens if you use the variable without assigning it a value? Let’s find out! Use the <strong>C# Interactive window</strong> (or the .NET console if you’re using a Mac) to declare a variable and check its value.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/161fig01.png"/>
<h6/>
</div></figure>
<p>Start the C# Interactive window (from the View &gt;&gt; Other Windows menu) or run <code><strong>csi</strong></code> from the Mac Terminal. Declare each variable, then enter the variable name to see its default value. Write the default value for each type in the space provided.</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="A literal is a value written directly into your code" data-type="sect1"><div class="sect1" id="a_literal_is_a_value_written_directly_in">
<h1>A literal is a value written directly into your code</h1>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="values" data-type="indexterm" id="idm46402346561368"/><a data-primary="literals" data-type="indexterm" id="idm46402346559944"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="values" data-type="indexterm" id="idm46402346559032"/><a data-primary="types" data-secondary="of literals" data-type="indexterm" id="idm46402346558056"/><a data-primary="values" data-type="indexterm" id="idm46402346556872"/>A <strong>literal</strong> is a number, string, or other fixed value that you include in your code. You’ve already used plenty of literals—here are some examples of numbers, strings, and other literals that you’ve used:</p>
<pre data-type="programlisting">    int number = 15;
    string result = "the answer";
    public bool GameOver = false;
    Console.Write("Enter the number of cards to pick: ");
    if (value == 1) return "Ace";</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Can you spot all of the literals in these statements from code you’ve written in previous chapters? The last statement has <u>two</u> literals.</span></p>
</div>
<p>So when you type <code><strong>int i = 5;</strong></code>, the <code><strong>5</strong></code> is a literal.</p>
<section data-pdf-bookmark="Use suffixes to give your literals types" data-type="sect2"><div class="sect2" id="use_suffixes_to_give_your_literals_types">
<h2>Use suffixes to give your literals types</h2>
<p>When you added statements like this in Unity, you may have wondered about the <strong>F</strong>:</p>
<pre data-type="programlisting">    InvokeRepeating("AddABall", 1.5<u>F</u>, 1);</pre>
<p>Did you notice that your <u>program won’t build</u> if you leave off the F in the literals 1.5F and 0.75F? That’s because <strong>literals have types</strong>. Every literal is automatically assigned a type, and C# has rules about how you can combine different types. You can see for yourself how that works. Add this line to any C# program:</p>
<pre data-type="programlisting">    int wholeNumber = 14.7;</pre>
<p>When you try to build your program, the IDE will show you this error in the Error List:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/162fig02.png"/>
<h6/>
</div></figure>
<p>The IDE is telling you is that the literal 14.7 has a type—it’s a double. You can use a suffix to change its type—try changing it to a float by sticking an F on the end (14.7F) or a decimal by adding M (14.7M—the M actually stands for “money” ). The error message now says it can’t convert float or decimal. Add a D (or leave off the suffix entirely) and the error goes away.</p>
<blockquote>
<p><strong>C# assumes that an integer literal without a suffix (like 371) is an int, and one with a decimal point (like 27.4) is a double.</strong></p>
</blockquote>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd003">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/162fig03.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0019">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="keywords" data-type="indexterm" id="idm46402346534312"/><a data-primary="keywords" data-type="indexterm" id="idm46402346533096"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="keywords" data-type="indexterm" id="idm46402346532360"/>C# has dozens of <strong>reserved words called keywords</strong>. They’re words reserved by the C# compiler that you can’t use for variable names. You’ve already learned many of them—here’s a little review to help seal them into your brain. Write down what you think each of these keywords does in C#.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/163fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>If you really want to use a reserved keyword as a variable name, put @ in front of it, but that’s as close as the compiler will let you get to the reserved word. You can also do that with nonreserved names, if you want to.</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd004">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p><a data-primary=".NET Framework" data-secondary="namespaces" data-type="indexterm" id="idm46402346527688"/>C# has dozens of <strong>reserved words called <em>keywords</em></strong>. They’re words reserved by the C# compiler that you can’t use for variable names. You’ve already learned many of them—here’s a little review to help seal them into your brain. Write down what you think each of these keywords does in C#.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/164fig01.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="A variable is like a data to-go cup" data-type="sect1"><div class="sect1" id="a_variable_is_like_a_data_to_go_cup">
<h1>A variable is like a data to-go cup</h1>
<p><a data-primary="binary numbers" data-type="indexterm" id="idm46402346518984"/><a data-primary="byte type" data-type="indexterm" id="idm46402346517704"/><a data-primary="Convert class" data-type="indexterm" id="idm46402346516968"/><a data-primary="int type" data-secondary="about" data-type="indexterm" id="idm46402346516232"/><a data-primary="long type" data-type="indexterm" id="idm46402346515192"/><a data-primary="short type" data-type="indexterm" id="idm46402346514344"/><a data-primary="static Convert class" data-type="indexterm" id="idm46402346513464"/><a data-primary="types" data-secondary="variable" data-type="indexterm" id="idm46402346512664"/><a data-primary="variables" data-secondary="about" data-type="indexterm" id="idm46402346511512"/>All of your data takes up space in memory. (Remember the <u>heap</u> from the last chapter?) So part of your job is to think about how <em>much</em> space you’re going to need whenever you use a string or a number in your program. That’s one of the reasons you use variables. They let you set aside enough space in memory to store your data.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Not all data ends up on the heap. Value types usually keep their data in another part of memory called the stack. You’ll learn all about that later in the book.</span></p>
</div>
<p>Think of a variable like a cup that you keep your data in. C# uses a bunch of different kinds of cups to hold different kinds of data. Just like the different sizes of cups at a coffee shop, there are different sizes of variables, too.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/165fig01.png"/>
<h6/>
</div></figure>
<section data-pdf-bookmark="Use the Convert class to explore bits and bytes" data-type="sect2"><div class="sect2" id="use_the_convert_class_to_explore_bits_an">
<h2>Use the Convert class to explore bits and bytes</h2>
<p><strong><em>Convert this!</em></strong></p>
<p>You’ve always heard that programming is about 1s and 0s. .NET has a <strong>static Convert class</strong> that converts between different numeric data types. Let’s use it to see an example of how bits and bytes work.</p>
<p>A bit is a single 1 or 0. A byte is 8 bits, so a byte variable holds an 8-bit number, which means it’s a number that can be represented with up to 8 bits. What does that look like? Let’s use the Convert class to convert some binary numbers to bytes:</p>
<pre data-type="programlisting"> Convert.ToByte("10111", 2) <span style="color:#9D9EA0;">// returns 23</span>
 Convert.ToByte("11111111", 2); <span style="color:#9D9EA0;">// returns 255</span></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The first argument to Convert.ToByte is the number to convert, and the second is its base. Binary numbers are base 2.</span></p>
</div>
<p>Bytes can hold numbers between 0 and 255 because they use 8 bits of memory—an 8-bit number is a binary number between 0 and 11111111 binary (or 0 and 255 decimal).</p>
<p>A short is a 16-bit value. Let’s use Convert.ToInt16 to convert the binary value 111111111111111 (15 1s) to a short. An int is a 32-bit value, so we’ll use Convert.ToInt32 to convert the 31 1s to an int:</p>
<pre data-type="programlisting"> Convert.ToInt16("111111111111111", 2); <span style="color:#9D9EA0;">// returns 32767</span>
 Convert.ToInt32("1111111111111111111111111111111", 2); <span style="color:#9D9EA0;">// returns 2147483647</span></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="Other types come in different sizes, too" data-type="sect1"><div class="sect1" id="other_types_come_in_different_sizescomma">
<h1>Other types come in different sizes, too</h1>
<p><a data-primary="bool type" data-type="indexterm" id="idm46402346492232"/><a data-primary="characters" data-type="indexterm" id="idm46402346490952"/><a data-primary="char type" data-type="indexterm" id="idm46402346490120"/><a data-primary="decimal type" data-secondary="about" data-type="indexterm" id="idm46402346489288"/><a data-primary="double type" data-type="indexterm" id="idm46402346488216"/><a data-primary="floating-point types" data-type="indexterm" id="idm46402346487384"/><a data-primary="float type" data-type="indexterm" id="idm46402346486552"/><a data-primary="memory" data-secondary="types and" data-type="indexterm" id="idm46402346485720"/><a data-primary="non-numeric types" data-type="indexterm" id="idm46402346484584"/><a data-primary="string type" data-type="indexterm" id="idm46402346483784"/><a data-primary="types" data-secondary="memory and" data-type="indexterm" id="idm46402346482920"/>Numbers that have decimal places are stored differently than integers, and the different floating-point types take up different amounts of memory. You can handle most of your numbers that have decimal places using <strong>float</strong>, the smallest data type that stores decimals. If you need to be more precise, use a <strong>double</strong>. If you’re writing a financial application where you’ll be storing currency values, you’ll always want to use the <strong>decimal</strong> type.</p>
<p>Oh, and one more thing: <strong><em>don’t use double for money or currency, <u>only use decimal</u></em></strong>.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/166fig01.png"/>
<h6/>
</div></figure>
<p>We’ve talked about strings, so you know that the C# compiler also can handle <strong>characters and non-numeric types</strong>. The char type holds one character, and string is used for lots of characters “strung” together. There’s no set size for a string object—it expands to hold as much data as you need to store in it. The bool data type is used to store true or false values, like the ones you’ve used for your <code><strong>if</strong></code> statements.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/166fig02.png"/>
<h6/>
</div></figure>
<blockquote>
<p>The different floating-point types take up different amounts of memory: float is smallest, and decimal is largest.</p>
</blockquote>
</div></section>
<section data-pdf-bookmark="10 pounds of data in a 5-pound bag" data-type="sect1"><div class="sect1" id="ten_pounds_of_data_in_a_five_pound_bag">
<h1>10 pounds of data in a 5-pound bag</h1>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/167fig01.png"/>
<h6/>
</div></figure>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="types" data-type="indexterm" id="idm46402346468808"/><a data-primary="int type" data-secondary="about" data-type="indexterm" id="idm46402346467128"/><a data-primary="memory" data-secondary="allocating" data-type="indexterm" id="idm46402346465976"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="types" data-type="indexterm" id="idm46402346464856"/><a data-primary="short type" data-type="indexterm" id="idm46402346463704"/><a data-primary="types" data-secondary="exercises on" data-type="indexterm" id="idm46402346462904"/>When you declare your variable as one type, the C# compiler <strong>allocates</strong> (or reserves) all of the memory it would need to store the maximum value of that type. Even if the value is nowhere near the upper boundary of the type you’ve declared, the compiler will see the cup it’s in, not the number inside. So this <u>won’t work</u>:</p>
<pre data-type="programlisting"> int leaguesUnderTheSea = 20000;
 short smallerLeagues = leaguesUnderTheSea;</pre>
<p>20,000 would fit into a <code>short</code>, no problem. But because <code><strong>leaguesUnderTheSea</strong></code> is declared as an int, C# sees it as int-sized and considers it too big to put in a short container. The compiler won’t make those translations for you on the fly. You need to make sure that you’re using the right type for the data you’re working with.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/167fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0020">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p>Three of these statements won’t build, either because they’re trying to cram too much data into a small variable or because they’re putting the wrong type of data in. Circle them and write a brief explanation of what’s wrong.</p>
<pre data-type="programlisting">int hours = 24;

short y = 78000;

bool isDone = yes;

short RPM = 33;

int balance = 345667 - 567;

string taunt = "your mother";

byte days = 365;

long radius = 3;

char initial = 'S';

string months = "12";</pre>
</div></aside>
</div></section>
<section data-pdf-bookmark="Casting lets you copy values that C# can’t automatically convert to another type" data-type="sect1"><div class="sect1" id="casting_lets_you_copy_values_that_chash">
<h1>Casting lets you copy values that C# can’t automatically convert to another type</h1>
<p><a data-primary="casting" data-secondary="about" data-type="indexterm" id="idm46402346449400"/><a data-primary="casting" data-secondary="decimal value to int type" data-type="indexterm" id="idm46402346450104"/><a data-primary="decimal type" data-secondary="attempting to assign decimal value to int variable" data-type="indexterm" id="idm46402346448056"/><a data-primary="int type" data-secondary="attempting to assign decimal value to int variable" data-type="indexterm" id="idm46402346446920"/><a data-primary="value types" data-secondary="casting" data-type="indexterm" id="idm46402346445784"/><a data-primary="variables" data-secondary="assigning values to data type and" data-type="indexterm" id="idm46402346444632"/>Let’s see what happens when you try to assign a decimal value to an int variable.</p>
<p><strong><em>Do this!</em></strong></p>
<ol>
<li><p>Create a new Console App project and add this code to the Main method:</p>
<pre data-type="programlisting">      float myFloatValue = 10;
      int myIntValue = myFloatValue;
      Console.WriteLine("myIntValue is " + myIntValue);</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong><u><span style="color:#9D9EA0;">Implicit conversion</span></u> means C# has a way to automatically convert a value to another type without losing information.</strong></p>
</div></li>
<li><p>Try building your program. You should get the same CS0266 error you saw earlier:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/168fig02.png"/>
<h6/>
</div></figure>
<p>Look closely at the last few words of the error message: “are you missing a cast?” That’s the C# compiler giving you a really useful hint about how to fix the problem.</p></li>
<li><p>Make the error go away by <strong>casting</strong> the decimal to an int. You do this by adding the type that you want to convert to in parentheses: <code><strong>(int)</strong></code>. Once you change the second line so it looks like this, your program will compile and run:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/168fig03.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>When you cast a floating-point value to an int, it <span style="color:#9D9EA0;"><u>rounds the value down</u></span> to the nearest integer.</strong></p>
</div></li>
</ol>
<section data-pdf-bookmark="So what happened?" data-type="sect2"><div class="sect2" id="so_what_happenedquestion_mark">
<h2>So what happened?</h2>
<p>The C# compiler won’t let you assign a value to a variable if it’s the wrong type—even if that variable can hold the value just fine! It turns out that a LOT of bugs are caused by type problems, and <strong>the compiler is helping</strong> by nudging you in the right direction. When you use casting, you’re essentially saying to the compiler that you know the types are different, and promising that in this particular instance it’s OK for C# to cram the data into the new variable.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd005">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p>Three of these statements won’t build, either because they’re trying to cram too much data into a small variable or because they’re putting the wrong type of data in. Circle them and write a brief explanation of what’s wrong</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/168fig04.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-pdf-bookmark="When you cast a value that’s too big,C# adjusts it to fit its new container" data-type="sect2"><div class="sect2" id="when_you_cast_a_value_thatapostrophes_to">
<h2>When you cast a value that’s too big,C# adjusts it to fit its new container</h2>
<p><a data-primary="+ (plus) addition operator" data-type="indexterm" id="idm46402346419784"/><a data-primary="* (asterisk) operator" data-type="indexterm" id="idm46402346418168"/><a data-primary="/ (slash) division operator" data-type="indexterm" id="idm46402346417400"/><a data-primary="arithmetic operators" data-secondary="defined" data-type="indexterm" id="idm46402346416600"/><a data-primary="casting" data-secondary="exercises on" data-type="indexterm" id="idm46402346415560"/><a data-primary="casting" data-secondary="too-large value, automatic adjustment in C#" data-type="indexterm" id="idm46402346414472"/><a data-primary="casting" data-secondary="wrapping numbers" data-type="indexterm" id="idm46402346413368"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="casting" data-type="indexterm" id="idm46402346412152"/><a data-primary="float type" data-type="indexterm" id="idm46402346410792"/><a data-primary="int type" data-secondary="adding to float type, conversion with + operatotr" data-type="indexterm" id="idm46402346409800"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="casting" data-type="indexterm" id="idm46402346408792"/><a data-primary="subtraction operator" data-type="indexterm" id="idm46402346407672"/><a data-primary="types" data-secondary="value types" data-type="indexterm" id="idm46402346406792"/><a data-primary="value types" data-secondary="more information on" data-type="indexterm" id="idm46402346405640"/>You’ve already seen that a decimal can be cast to an int. It turns out that <em>any</em> number can be cast to <em>any other</em> number. That doesn’t mean the <strong><em>value</em></strong> stays intact through the casting, though. Say you have an int variable set to 365. If you cast it to a byte variable (max value 255), instead of giving you an error, the value will just <strong>wrap around</strong>. 256 cast to a byte will have a value of 0, 25 will be converted to 1, 258 to 2, etc., up to 365, which will end up being <strong>109</strong>. Once you get back to 255 again, the conversion value “wraps” back to zero.</p>
<p>If you use + (or <code><strong>*</strong></code>, <code><strong>/</strong></code>, or <code><strong>-</strong></code>) with two different numeric types, the operator <strong>automatically converts</strong> the smaller type to the bigger one. Here’s an example:</p>
<pre data-type="programlisting"> int myInt = 36;
 float myFloat = 16.4F;
 myFloat = myInt + myFloat;</pre>
<p>Since an int can fit into a float but a float can’t fit into an int, the + operator converts <code><strong>myInt</strong></code> to a float before adding it to <code><strong>myFloat</strong></code>.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0021">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><strong>You can’t always cast any type to any other type.</strong></p>
<p>Create a new Console App project and type these statements into its Main method. Then build your program—it will give lots of errors. Cross out the ones that give errors. That’ll help you figure out which types can be cast, and which can’t!</p>
<pre data-type="programlisting">int myInt = 10;

byte myByte = (byte)myInt;

double myDouble = (double)myByte;

bool myBool = (bool)myDouble;

string myString = "false";

myBool = (bool)myString;

myString = (string)myInt;

myString = myInt.ToString();

myBool = (bool)myByte;

myByte = (byte)myBool;

short myShort = (short)myInt;

char myChar = 'x';

myString = (string)myChar;

long myLong = (long)myInt;

decimal myDecimal = (decimal)myLong;
myString = myString + myInt + myByte + myDouble + myChar;</pre>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>You can read a lot more about the different C# value types here—it’s worth taking a look:</strong> <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types</a>.</p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/170fig01.png"/>
<h6/>
</div></figure>
<p><a data-primary="concatenating strings" data-type="indexterm" id="idm46402346387448"/><a data-primary="strings" data-secondary="concatenating" data-type="indexterm" id="idm46402346386488"/><strong>Yes! When you concatenate strings, C# converts values.</strong></p>
<p>When you use the + operator to combine a string with another value, it’s called <strong>concatenation</strong>. When you concatenate a string with an int, bool, float, or another value type, it automatically converts the value. This kind of conversion is different from casting, because under the hood it’s really calling the ToString method for the value…and one thing that .NET guarantees is that <strong>every object has a ToString method</strong> that converts it to a string (but it’s up to the individual class to determine if that string makes sense).</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Wrap it yourself!</p>
<p>There’s no mystery to how casting “wraps” the numbers—you can do it yourself. Just open up any calculator app that has a Mod button (which does a modulus calculation—sometimes in a Scientific mode), and calculate 365 Mod 256.</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd006">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p><strong>You can’t always cast any type to any other type.</strong> Create a new Console App project and type these statements into its Main method. Then build your program—it will give lots of errors. Cross out the ones that give errors. That’ll help you figure out which types can be cast , and which can’t!</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/170fig02.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="C# does some conversions automatically" data-type="sect1"><div class="sect1" id="chash_does_some_conversions_automaticall">
<h1>C# does some conversions <u>automatically</u></h1>
<p><a data-primary="arithmetic operators" data-secondary="automatic casting with" data-type="indexterm" id="idm46402346374456"/><a data-primary="binary numbers" data-type="indexterm" id="idm46402346372600"/><a data-primary="casting" data-secondary="automatic" data-type="indexterm" id="idm46402346371832"/><a data-primary="concatenation operator (+)" data-type="indexterm" id="idm46402346370648"/><a data-primary="strings" data-secondary="concatenating, automatic type conversions with + operator" data-type="indexterm" id="idm46402346369880"/><a data-primary="string type" data-type="indexterm" id="idm46402346368728"/><a data-primary="types" data-secondary="automatic casting in C#" data-type="indexterm" id="idm46402346367896"/>There are two important conversions that don’t require you to do casting. The first is the automatic conversion that happens any time you use arithmetic operators, like in this example:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/171fig01.png"/>
<h6/>
</div></figure>
<p>The other way C# converts types for you automatically is when you use the + operator to <strong>concatenate</strong> strings (which just means sticking one string on the end of another, like you’ve been doing with message boxes). When you use + to concatenate a string with something that’s another type, it automatically converts the numbers to strings for you. Here’s an example—try adding these lines to any C# program. The first two lines are fine, but the third one won’t compile:</p>
<pre data-type="programlisting">   long number = 139401930;
   string text = "Player score: " + number;
   text = number;</pre>
<p>The C# compiler gives you this error on the third line:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/171fig03.png"/>
<h6/>
</div></figure>
<p>ScoreText.text is a string field, so when you used the + operator to concatenate a string it assigned the value just fine. But when you try to assign <code><strong>x</strong></code> to it directly, it doesn’t have a way to automatically convert the long value to a string. You can convert it to a string by calling its ToString method.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0007">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: You used the Convert.ToByte, Convert.ToInt32, and Convert.ToInt64 methods to convert strings with binary numbers into integer values. Can you convert integer values back to binary?</strong></p>
<p><strong>A:</strong> Yes. The Convert class has a <strong>Convert.ToString method</strong> that converts many different types of values to strings. The IntelliSense pop-up shows you how it works:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/171fig04.png"/>
<h6/>
</div></figure>
<p>So <code><strong>Convert.ToString(255, 2)</strong></code> returns the string “11111111”, and <code><strong>Convert.ToString(8675309, 2)</strong></code> returns the string “100001000101111111101101”—try experimenting with it to get a feel for how binary numbers work.</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="When you call a method, the arguments need to be compatible with the types of the parameters" data-type="sect1"><div class="sect1" id="when_you_call_a_methodcomma_the_argument">
<h1>When you call a method, the arguments need to be compatible with the types of the parameters</h1>
<p><a data-primary="arguments" data-secondary="compatibility with parameter types" data-type="indexterm" id="idm46402346348984"/><a data-primary="arguments" data-secondary="defined" data-type="indexterm" id="idm46402346349736"/><a data-primary="errors" data-secondary="invalid arguments" data-type="indexterm" id="idm46402346347544"/><a data-primary="floating-point types" data-type="indexterm" id="idm46402346346392"/><a data-primary="int type" data-secondary="no automatic conversion to string" data-type="indexterm" id="idm46402346345656"/><a data-primary="invalid arguments error" data-type="indexterm" id="idm46402346344504"/><a data-primary="parameters" data-secondary="defined" data-type="indexterm" id="idm46402346343704"/>In the last chapter, you used the Random class to choose a random number from 1 up to (but not including) 5, which you used to pick a suit for a playing card:</p>
<pre data-type="programlisting"> int value = random.Next(1, 5);</pre>
<p>Try changing the first argument from <code><strong>1</strong></code> to <code><strong>1.0</strong></code>:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/172fig01a.png"/>
<h6/>
</div></figure>
<p>You’re passing a double literal to a method that’s expecting an int value. So it shouldn’t surprise you that the compiler won’t build your program—instead, it shows an error:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/172fig01.png"/>
<h6/>
</div></figure>
<p>Sometimes C# can do the conversion automatically. It doesn’t know how to convert a double to an int (like converting 1.0 to 1), but it does know how to convert an int to a double (like converting 1 to 1.0). More specifically:</p>
<ul>
<li><p>The C# compiler knows how convert an integer to a floating-point type.</p></li>
<li><p>And it knows how to convert an integer type to another integer type, or a floating-point type to another floating-point type.</p></li>
<li><p>But it can <u>only</u> do those conversions if the type it’s converting from is the same size as or smaller than the type it’s converting to. So, it can convert an int to a long or a float to a double, but it can’t convert a long to an int or a double to a float.</p></li>
</ul>
<p>But Random.Next isn’t the only method that will give you compiler errors if you try to pass it a variable whose type doesn’t match the parameter. <em>All</em> methods will do that, <strong><em>even the ones you write yourself</em></strong>. Add this method to a console app:</p>
<pre data-type="programlisting">public int MyMethod(bool add3) {
   int value = 12;

   if (add3) 
      value += 3;
   else 
      value -= 2;

   return value;

}</pre>
<blockquote>
<p><strong>When the compiler gives you an “invalid argument” error, it means that you tried to call a method with variables whose types didn’t match the method’s parameters.</strong></p>
</blockquote>
<p>Try passing it a string or long—you’ll get one of those CS1503 errors telling you it can’t convert the argument to a bool. Some folks have trouble remembering <strong>the difference between parameter and an argument</strong>. So just to be clear:</p>
<p><strong>A <u>parameter</u> is what you define in your method. An <u>argument</u> is what you pass to it. You can pass a byte argument to a method with an int parameter.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0008">
<h5>there are no Dumb Questions</h5>
<p><a data-primary="{ } (curly brackets)" data-type="indexterm" id="idm46402346323480"/><a data-primary="floating-point types" data-type="indexterm" id="idm46402346322648"/><strong>Q: That last <code><strong>if</strong></code> statement only said <code><strong>if (add3)</strong></code>. Is that the same thing as <code><strong>if (add3 == true)</strong></code>?</strong></p>
<p><strong>A:</strong> Yes. Let’s take another look at that <code><strong>if/else</strong></code> statement:</p>
<pre data-type="programlisting"> if (add3)
    value += 3;
 else
    value -= 2;</pre>
<p>An <code><strong>if</strong></code> statement always checks if something’s true. So because the type of the <code><strong>add3</strong></code> variable is bool, it evaluates to either true or false, which means we didn’t have to explicitly include <code><strong>== true</strong></code>.</p>
<p>You can also check if something’s false using ! (an exclamation point, or the NOT operator). Writing <code><strong>if (!add3)</strong></code> is the same thing as writing <code><strong>if (add3 == false)</strong></code>.</p>
<p>In our code examples from now on, if we’re using the conditional test to check a Boolean variable, you’ll usually just see us write <code><strong>if (add3)</strong></code> or <code><strong>if (!add3)</strong></code>, and not use == to explicitly check to see if the Boolean is true or false.</p>
<p><strong>Q: You didn’t include curly braces in the <code><strong>if</strong></code> or <code><strong>else</strong></code> blocks, either. Does that mean they’re optional?</strong></p>
<p><strong>A:</strong> Yes—but only if there’s a single statement in the <code><strong>if</strong></code> or <code><strong>else</strong></code> block. We could leave out the <code><strong>{</strong></code> curly braces <code><strong>}</strong></code> because there was just one statement in the <code><strong>if</strong></code> block (<code><strong>return 45;</strong></code>) and one statement in the <code><strong>else</strong></code> block (<code><strong>return 61;</strong></code>). If we wanted to add another statement to one of those blocks, we’d have to use curly braces for it:</p>
<pre data-type="programlisting"> if (add3)
    value += 3;
 else {
    Console.WriteLine("Subtracting 2");
    value -= 2;
 }</pre>
<p><em><code>Be</code> <u>careful</u> <code>when you leave out curly braces</code></em> because it’s easy to accidentally write code that doesn’t do what you want it to do. It never hurts to add curly braces, but it’s also good to get used to seeing <code><strong>if</strong></code> statements both with and without them.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-idd0007">
<h5>Bullet Points</h5>
<ul>
<li><p>There are <strong>value types</strong> for variables that hold different sizes of numbers. The biggest numbers should be of type long and the smallest ones (up to 255) can be declared as bytes.</p></li>
<li><p>Every value type has a <strong>size</strong>, and you can’t put a value of a bigger type into a smaller variable, no matter what the actual size of the data is.</p></li>
<li><p>When you’re using <strong>literal</strong> values, use the F suffix to indicate a float (15.6F) and M for a decimal (36.12M).</p></li>
<li><p>Use the <strong>decimal type for money and currency</strong>. Floating-point precision is…well, it’s a little weird.</p></li>
<li><p>There are a few types that C# knows how to <strong>convert</strong> automatically (an implicit conversion), like short to int, int to double, or float to double.</p></li>
<li><p>When the compiler won’t let you set a variable equal to a value of a different type, that’s when you need to cast it. To <strong>cast</strong> a value (an explicit conversion) to another type, put the target type in parentheses in front of the value.</p></li>
<li><p>There are some keywords that are <strong>reserved</strong> by the language and you can’t name your variables with them. They’re words (like <code><strong>for</strong></code>, <code><strong>while</strong></code>, <code><strong>using</strong></code>, <code><strong>new</strong></code>, and others) that do specific things in the language.</p></li>
<li><p>A <strong>parameter</strong> is what you define in your method. An <strong>argument</strong> is what you pass to it.</p></li>
<li><p>When you build your code in the IDE, it uses the <strong>C# compiler</strong> to turn it into an executable program.</p></li>
<li><p>You can use methods on the static <strong>Convert class</strong> to convert values between different types.</p></li>
</ul>
</div></aside>
<section data-pdf-bookmark="Owen is constantly improving his game…" data-type="sect2"><div class="sect2" id="owen_is_constantly_improving_his_gamehel">
<h2>Owen is constantly improving his game…</h2>
<p><a data-primary="ability score, in role-playing games" data-type="indexterm" id="idm46402346281592"/>Good game masters are dedicated to creating the best experience they can for their players. Owen’s players are about to embark on a new campaign with a brand-new set of characters, and he thinks a few tweaks to the formula that they use for their ability scores could make things more interesting.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/174fig01.png"/>
<h6/>
</div></figure>
</div></section>
<section data-pdf-bookmark="…but the trial and error can be time-consuming" data-type="sect2"><div class="sect2" id="hellipbut_the_trial_and_error_can_be_tim">
<h2>…but the trial and error can be time-consuming</h2>
<p>Owen’s been experimenting with ways to tweak the ability score calculation. He’s pretty sure that he has the formula mostly right—but he’d really like to tweak the numbers.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/175fig01.png"/>
<h6/>
</div></figure>
<p>Owen likes the overall formula: 4d6 roll, divide, subtract, round down, use a minimum value…but he’s not sure that the actual numbers are right.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/175fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0008">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p>What can we do to help Owen find the best combination of values for an updated ability score formula?</p>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="Let’s help Owen experiment with ability scores" data-type="sect1"><div class="sect1" id="letapostrophes_help_owen_experiment_with">
<h1>Let’s help Owen experiment with ability scores</h1>
<p><a data-primary="ability score, in role-playing games" data-type="indexterm" id="idm46402346267544"/>In this next project, you’ll build a .NET Core console app that Owen can use to test his ability score formula with different values to see how they affect the resulting score. The formula has <strong>four inputs</strong>: the <em>starting 4d6 roll</em>, the <em>divide by</em> value that the roll result is divided by, the <em>add amount</em> value to add to the result of that division, and the <em>minimum</em> to use if the result is too small.</p>
<p>Owen will enter each of the four inputs into the app, and it will calculate the ability score using those inputs. He’ll probably want to test a bunch of different values, so we’ll make the app easier by to use by asking for new values over and over again until he quits the app, keeping track of the values he used in each iteration and using those previous inputs as <strong>default values</strong> for the next iteration.</p>
<p>This is what it looks like when Owen runs the app:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/176fig01.png"/>
<h6/>
</div></figure>
<p><strong>This project is a little larger than the previous console apps that you’ve built, so we’ll tackle it in a few steps. First you’ll <span style="color:#9D9EA0;">Sharpen your pencil</span> to understand the code to calculate the ability score, then you’ll do an <span style="color:#9D9EA0;">Exercise</span> to write the rest of the code for the app, and finally you’ll <span style="color:#9D9EA0;">Sleuth out</span> a bug in the code. <em>Let’s get started!</em></strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0022">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="ability score" data-type="indexterm" id="idm46402346254936"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="ability scores" data-type="indexterm" id="idm46402346253720"/>We’ve built a class to help Owen calculate ability scores. To use it, you set its Starting4D6Roll, DivideBy, AddAmount, and Minimum fields—or just leave the values set in their declarations—and call its CalculateAbilityScore method. Unfortunately, <strong>there’s one line of code that has problems</strong>. Circle the line of code with problems and write down what’s wrong with it.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">See if you can spot the problem without typing the class into your IDE. Can you find the broken line that will cause a compiler error?</span></p>
</div>
<pre data-type="programlisting">class AbilityScoreCalculator
{
    public int RollResult = 14;
    public double DivideBy = 1.75;
    public int AddAmount = 2;
    public int Minimum = 3;
    public int Score;

    public void CalculateAbilityScore()
    {
        <span style="color:#9D9EA0;">// Divide the roll result by the DivideBy field</span>
        double divided = RollResult / DivideBy;

        <span style="color:#9D9EA0;">// Add AddAmount to the result of that division</span>
        int added = AddAmount += divided;

        <span style="color:#9D9EA0;">// If the result is too small, use Minimum</span>
        if (added &lt; Minimum)
        {
            Score = Minimum;
        } else
        {
            Score = added;
        }
    }
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>These fields are initialized with the values from the ability score formula. The app will use them to present default values to the user.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Here’s a hint! Compare the comments in the code to the ability score formula on the page from Owen’s game master notebook. What part of the formula is missing from the comments?</p>
</div>
<p>After you <strong>circle the line of code that has problems</strong>, write down the problems that you found with it.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/177fig01.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-pdf-bookmark="Use the C# compiler to find the problematic line of code" data-type="sect1"><div class="sect1" id="use_the_chash_compiler_to_find_the_probl">
<h1>Use the C# compiler to find the problematic line of code</h1>
<p><a data-primary="compiler" data-type="indexterm" id="idm46402346239960"/>Create a new .NET Core Console App project called AbilityScoreTester. Then <strong>add the AbilityScoreCalculator class</strong> with the code from the “Sharpen your pencil” exercise. If you entered the code correctly, you should see a C# compiler error:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/178fig01.png"/>
<h6/>
</div></figure>
<p>Any time the C# compiler gives you an error, read it carefully. It usually has a hint that can help you track down the problem. In this case, it’s telling us exactly what went wrong: it can’t convert a double to an int without a cast. The <code><strong>divided</strong></code> variable is declared as a double, but C# won’t allow you to add it to an int field like AddAmount because it doesn’t know how to convert it.</p>
<p>When the C# compiler asks “are you missing a cast?” it’s giving you a huge hint that you need to explicitly cast the double variable <code><strong>divided</strong></code> before you can add it to the int field AddAmount.</p>
<section data-pdf-bookmark="Add a cast to get the AbilityScoreCalculator class to compile..." data-type="sect2"><div class="sect2" id="add_a_cast_to_get_the_abilityscorecalcul">
<h2>Add a cast to get the AbilityScoreCalculator class to compile...</h2>
<p>Now that you know what the problem is, you can <strong>add a cast</strong> to fix the problematic line of code in AbilityScoreCalculator. Here’s the line that generated the “Cannot implicitly convert type” error:</p>
<pre data-type="programlisting">   int added = AddAmount += divided;</pre>
<p>It caused that error because <code><strong>AddAmount += divided</strong></code> <strong><em>returns a double value</em></strong>, which can’t be assigned to the int variable <code><strong>added</strong></code>.</p>
<p>You can fix it by <strong>casting</strong> <code><strong>divided</strong></code> <strong>to an int</strong>, so adding it to AddAmount returns another int. Modify that line of code to change <code><strong>divided</strong></code> to <code><strong>(int)</strong></code><code><strong>divided</strong></code>:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/178fig02.png"/>
<h6/>
</div></figure>
<p>Adding that cast also addresses the missing part of Owen’s ability score formula:</p>
<p><em><span style="color:#9D9EA0;">* ROUND DOWN TO THE NEAREST WHOLE NUMBER</span></em></p>
<p>When you cast a double to an int C# rounds it down—so for example <code><strong>(int)19.7431D</strong></code> gives us <code><strong>19</strong></code>. By adding that cast, you’re adding the step from the ability score formula that was missing from the class.</p>
</div></section>
<section data-pdf-bookmark="…but there’s still a bug!" data-type="sect2"><div class="sect2" id="hellipbut_thereapostrophes_still_a_bugex">
<h2>…but there’s still a bug!</h2>
<p>We’re not quite done yet! You fixed the compiler error, so now the project builds. But even though the C# compiler will accept it, <strong><em>there’s still a problem</em></strong>. Can you <u>spot the bug</u> in that line of code?</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Looks like we can’t fill in the “Sharpen your pencil” answer just yet!</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-idd0013">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise</h5>
<p><a data-primary="exercises" data-secondary="ability score" data-type="indexterm" id="idm46402346212232"/>Finish building the console app that uses the AbilityScoreCalculator class. In this exercise, we’ll give you the Main method for the console app. Your job is to write code for two methods: a method called ReadInt that reads user input and converts it to an int using int.TryParse, and a method called ReadDouble that does exactly the same thing except it parses doubles instead of int values.</p>
<ol>
<li><p>Add the following Main method. Almost everything was used in previous projects. There’s only one new thing—it calls the Console.ReadKey method:</p>
<pre data-type="programlisting">      char keyChar = Console.ReadKey(true).KeyChar;</pre>
<p>Console.ReadKey reads a single key from the console. When you pass the argument <code><strong>true</strong></code> it intercepts the input so that it doesn’t get printed to the console. Adding <code><strong>.KeyChar</strong></code> causes it to return the key pressed as a <strong>char</strong>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>You’ll use a single instance of AbilityScoreCalculator, using the user input to update its fields so it remembers the default values for the next iteration of the</strong> <strong><code>while</code></strong> loop.</p>
</div>
<p>Here’s the full Main method—add it to your program:</p>
<pre data-type="programlisting">static void Main(string[] args)
{
   AbilityScoreCalculator calculator = new AbilityScoreCalculator();
   while (true)
   {
       calculator.RollResult = ReadInt(calculator.RollResult, "Starting 4d6 roll");
       calculator.DivideBy = ReadDouble(calculator.DivideBy, "Divide by");
       calculator.AddAmount = ReadInt(calculator.AddAmount, "Add amount");
       calculator.Minimum = ReadInt(calculator.Minimum, "Minimum");
       calculator.CalculateAbilityScore();
       Console.WriteLine("Calculated ability score: " + calculator.Score);
       Console.WriteLine("Press Q to quit, any other key to continue");
       char keyChar = Console.ReadKey(true).KeyChar;
       if ((keyChar == 'Q') || (keyChar == 'q')) return;
   }
}</pre>
</li>
<li><p>Add a method called ReadInt. It takes two parameters: a prompt to display to the user, and a default value. It writes the prompt to the console, followed by the default value in square brackets. Then it reads a line from the console and attempts to parse it. If the value can be parsed, it uses that value; otherwise, it uses the default value.</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">/// &lt;summary&gt;</span>
<span style="color:#9D9EA0;">/// Writes a prompt and reads an int value from the console.</span>
<span style="color:#9D9EA0;">/// &lt;/summary&gt;</span>
<span style="color:#9D9EA0;">/// &lt;param name="lastUsedValue"&gt;The default value.&lt;/param&gt;</span>
<span style="color:#9D9EA0;">/// &lt;param name="prompt"&gt;Prompt to print to the console.&lt;/param&gt;</span>
<span style="color:#9D9EA0;">/// &lt;returns&gt;The int value read, or the default value if unable to parse&lt;/returns&gt;</span>
static int ReadInt(int lastUsedValue, string prompt)
{
   <span style="color:#9D9EA0;"> // Write the prompt followed by [default value]:</span>
   <span style="color:#9D9EA0;"> // Read the line from the input and use int.TryParse to attempt to parse it</span>
   <span style="color:#9D9EA0;"> // If it can be parsed, write " using value" + value to the console</span>
   <span style="color:#9D9EA0;"> // Otherwise write " using default value" + lastUsedValue to the console</span>
}</pre>
<p>Add a ReadDouble method that’s exactly like ReadInt, except that <strong>it uses double.TryParse</strong> instead of int.TryParse. The double.TryParse method works exactly like int.TryParse, except its <code><strong>out</strong></code> variable needs to be a double, not an int.</p></li>
</ol>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise_solution-idd0002">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise Solution</h5>
<p>Here are the ReadInt and ReadDouble methods that display a prompt that includes the default value, read a line from the console, try to convert it to an int or a double, and either use the converted value or the default value, writing a message to the console with the value returned.</p>
<pre data-type="programlisting">static int ReadInt(int lastUsedValue, string prompt)
{
    Console.Write(prompt + " [" + lastUsedValue + "]: ");
    string line = Console.ReadLine();
    if (int.TryParse(line, out int value))
    {
        Console.WriteLine(" using value " + value);
        return value;
    } else
    {
        Console.WriteLine(" using default value " + lastUsedValue);
        return lastUsedValue;
    }
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Really take some time to understand how each iteration of the <code>while</code> loop in the Main method uses <span style="color:#9D9EA0;"><u>fields to save the values</u></span> that the user entered, then uses them for the default values in the next iteration.</strong></p>
</div>
<pre data-type="programlisting">static double ReadDouble(double lastUsedValue, string prompt)
{
    Console.Write(prompt + " [" + lastUsedValue + "]: ");
    string line = Console.ReadLine();
    if (double.TryParse(line, out double value))
    {
        Console.WriteLine(" using value " + value);
        return value;
    }
    else
    {
        Console.WriteLine(" using default value " + lastUsedValue);
        return lastUsedValue;
    }
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Here’s the call to double.TryParse, which works exactly like the int version except that you need to use double as the output variable type.</p>
</div>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/180fig02.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/181fig01.png"/>
<h6/>
</div></figure>
<p><strong>You’re right, Owen. There’s a bug in the code.</strong></p>
<p>Owen wants to try out different values to use in his ability score formula, so we used a loop to make the app ask for those values over and over again.</p>
<p>To make it easier for Owen to just change one value at a time, we included a feature in the app that remembers the last values he entered and presents them as default options. We implemented that feature by keeping an instance of the AbilityScoreCalculator class in memory, and updating its fields in each iteration of the <code><strong>while</strong></code> loop.</p>
<p>But something’s gone wrong with the app. It remembers most of the values just fine, but it remembers the wrong number for the “add amount” default value. In the first iteration Owen entered 5, but it gave him 10 as a default option. Then he entered 7, but it gave a default of 12. What’s going on?</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0009">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p>What steps can you take to track down the bug in the ability score calculator app?</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sleuth_it_out-idd00001">
<h5><span class="inlineimage"><img alt="Images" src="assets/cap.png"/></span> Sleuth it out</h5>
<p><a data-primary="debugging mode" data-type="indexterm" id="idm46402346168312"/>When you’re debugging code, you’re acting like a <strong>code detective</strong>. Something is causing the bug, so your job is to identify suspects and retrace their steps. Let’s do an investigation and see if we can apprehend the culprit, Sherlock Holmes style.</p>
<p>The problem seems to be isolated to the “add amount” value, so let’s start by looking for any line of code that touches the AddAmount field. Here’s a line in the Main method that uses the AddAmount field—put a breakpoint on it:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/182fig01.png"/>
<h6/>
</div></figure>
<p>And here’s another one in the AbilityScoreCalculator.CalculateAbilityScore method—breakpoint that suspect, too:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/182fig02.png"/>
<h6/>
</div></figure>
<p>Now run your program. When your Main method breaks, <strong>select <u>calculator.AddAmount</u> and add a watch</strong> (if you just right-click on AddAmount and choose “Add Watch” from the menu, it will only add a watch for AddAmount and not calculator.AddAmount). Does anything look weird there? We’re not seeing anything unusual. It seems to read the value and update it just fine. OK, that’s probably not the issue—you can disable or remove that breakpoint.</p>
<p>Continue running your program. When the breakpoint in AbilityScoreCalculator.CalculateAbilityScore is hit, <strong>add a watch for AddAmount</strong>. According to Owen’s formula, this line of code is supposed to add AddAmount to the result of dividing the roll result. Now <strong>step over</strong> the statement and...</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/182fig03.png"/>
<h6/>
</div></figure>
<p><strong><em>Wait, what?! AddAmount changed. But…but that’s not supposed to happen—it’s impossible! Right?</em></strong> As Sherlock Holmes said, “When you have eliminated the impossible, whatever remains, however improbable, must be the truth.”</p>
<p>It looks like we’ve sleuthed out the source of the problem. That statement is supposed to cast <code><strong>divided</strong></code> to an int to round it down to an integer, then add it to AddAmount and store the result in <code><strong>added</strong></code>. It also has an unexpected side effect: it’s updating AddAmount with the sum because <strong>the statement uses the += operator</strong>, which returns the sum but assigns the sum to AddAmount.</p>
</div></aside>
</div></section>
<section data-pdf-bookmark="And now we can finally fix Owen’s bug" data-type="sect2"><div class="sect2" id="and_now_we_can_finally_fix_owenapostroph">
<h2>And now we can finally fix Owen’s bug</h2>
<p>Now that you know what’s happening, you can <strong>fix the bug</strong>—and it turns out to be a pretty small change. You just need to <u>change the statement to use + instead of +=</u>:</p>
<pre data-type="programlisting">int added = AddAmount <u>+</u> (int)divided;</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Change the += to a + to keep this line of code from updating the “added” variable and fix the bug. Like Sherlock would say, “It’s elementary.”</span></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="binary operators" data-type="indexterm" id="idm46402346146696"/><a data-primary="compound assignment operators" data-type="indexterm" id="idm46402346145592"/><span style="color:#9D9EA0;">Now that we’ve found the problem, we can finally give the “Sharpen your pencil” solution.</span></p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd007">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p>We’ve built a class to help Owen calculate ability scores. To use it, you set its Starting4D6Roll, DivideBy, SubtractBy, and Minimum fields—or just leave the values set in their declarations—and call its CalculateAbilityScore method. Unfortunately, <strong>there’s one line of code that has problems</strong>. Circle the line of code with problems and write down what’s wrong with it.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/183fig01.png"/>
<h6/>
</div></figure>
<p>After you <strong>circle the line of code that has problems</strong>, write down the problems that you found with it.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/183fig01a.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0009">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: I’m still not clear on the difference between the + operator and the += operator. How do they work, and why would I use one and not the other?</strong></p>
<p><strong>A:</strong> There are several operators that you can combine with an equals sign. They include += for adding, -= for subtracting, /= for dividing, *= for multiplying, and %= for remainder. Operators like + that combine two values are called <strong>binary operators</strong>. Some people find this name a little confusing, but “binary” refers to the fact that the operator combines two values—“binary” means “involving two things” —<u>not</u> that it somehow operates only on binary numbers.</p>
<p>With binary operators, you can do something called <strong>compound assignment</strong>, which means instead of this:</p>
<pre data-type="programlisting">a = a + c;</pre>
<p>you can do this:</p>
<pre data-type="programlisting">a += c;</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The += operator tells C# to add a + c and then store the result in a.</span></p>
</div>
<p>and it means the same thing. The compound assignment <code><strong>x op= y</strong></code> is equivalent to <code><strong>x = x op y</strong></code> (that’s the technical way of explaining it). They do exactly the same thing.</p>
<p><strong>Operators like += or *= that combine a binary operator with an equals sign are called <span style="color:#9D9EA0;"><u>compound assignment operators</u></span>.</strong></p>
<p><strong>Q: But then how did the added variable get updated?</strong></p>
<p><strong>A:</strong> What caused confusion in the score calculator is that the <strong>assignment operator = also returns a value</strong>. You can do this:</p>
<pre data-type="programlisting">int q = (a = b + c)</pre>
<p>which will calculate <code><strong>a = b + c</strong></code> as usual. The = operator <strong><em>returns</em></strong> a value, so <strong>it will update q with the result</strong> as well. So:</p>
<pre data-type="programlisting">int added = AddAmount += divided;</pre>
<p>is just like doing this:</p>
<pre data-type="programlisting">int added = (AddAmount = AddAmount + divided);</pre>
<p>which causes <code><strong>AddAmount</strong></code> to be increased by <code><strong>divided</strong></code>, but stores that result in <code><strong>added</strong></code> as well.</p>
<p><strong>Q: Wait, what? The equals operator returns a value?</strong></p>
<p><strong>A:</strong> Yes, = returns the value being set. So in this code:</p>
<pre data-type="programlisting">int first;
int second = (first = 4);</pre>
<p>both <code><strong>first</strong></code> and <code><strong>second</strong></code> will end up equal to 4. Open up a console app and use the debugger to test this. It really works!</p>
</div></aside>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/184fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="binary data" data-type="indexterm" id="idm46402346107896"/><a data-primary="clowns" data-secondary="Fingers the clown" data-type="indexterm" id="idm46402346107000"/><a data-primary="decimal type" data-secondary="precision of" data-type="indexterm" id="idm46402346105848"/><a data-primary="floating-point types" data-type="indexterm" id="idm46402346104696"/>Try this!</p>
</div>
<p>Try adding this <code><strong>if/else</strong></code> statement to a console app:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/184fig02.png"/>
<h6/>
</div></figure>
<p>Next, <strong>change the float literals to doubles</strong> (remember, literals like 0.1 <u>default to double</u>):</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/184fig03.png"/>
<h6/>
</div></figure>
<p>That’s really strange. The warning moved to the first line of the <code><strong>if</strong></code> statement. Try running the program. Hold on, that can’t be right! It printed <code><strong>They aren't equal</strong></code> to the console. How is 0.1 + 0.2 not equal to 0.3?</p>
<p>Now do one more thing. Change 0.3 to 0.30000000000000004 (with 15 zeros between the 3 and 4). Now it prints <code><strong>They’re equal</strong></code> again. So apparently 0.1D plus 0.2D equals 0.30000000000000004D.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Wait, what?!</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/184fig04.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Exactly. Decimal has a lot more precision than double or float, so it avoids the 0.30000000000000004 problem.</strong></p>
<p>Some floating-point types—not just in C#, but in <u>most</u> programming languages!—can give you <strong><em>rare</em></strong> weird errors. This is so strange! How can 0.1 + 0.2 be 0.30000000000000004?</p>
<p>It turns out that there are some numbers that just can’t be exactly represented as a double—it has to do with how they’re stored as binary data (0s and 1s in memory). For example, .1D is not <em>exactly</em> .1. Try multiplying <code><strong>.1D * .1D</strong></code>—you get 0.010000000000000002, not 0.01. But <code><strong>.1M * .1M</strong></code> gives you the right answer. That’s why floats and doubles are really useful for a lot of things (like positioning a GameObject in Unity). If you need more rigid precision—like for a financial app that deals with money—decimal is the way to go.</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0010">
<h5>there are no Dumb Questions</h5>
<p><a data-primary="casting" data-secondary="versus conversion" data-type="indexterm" id="idm46402346083928"/><a data-primary="conversion, compared with casting" data-type="indexterm" id="idm46402346082744"/><a data-primary="mod function" data-type="indexterm" id="idm46402346081864"/><a data-primary="remainders" data-type="indexterm" id="idm46402346080760"/><strong>Q: I’m still not clear on the difference between conversion and casting. Can you explain it a little more clearly?</strong></p>
<p><strong>A:</strong> Conversion is a general, all-purpose term for converting data from one type to another. Casting is a much more specific operation, with explicit rules about which types can be cast to other types, and what to do when the data for the value from one doesn’t quite match the type it’s being cast to. You just saw an example of one of those rules—when a floating-point number is cast to an int, it’s rounded down by dropping any decimal value. You saw another rule earlier about wrapping for integer types, where a number that’s too big to fit into the type it’s being cast to is wrapped using the remainder operator.</p>
<p><strong>Q: Hold on a minute. Earlier you had me “wrap” numbers myself using the mod function on my calculator app. Now you’re talking about remainders. What’s the difference?</strong></p>
<p><strong>A:</strong> Mod and remainder are very similar operations. For positive numbers they’re exactly the same: A % B is the remainder when you divide B into A, so: 5 % 2 is the remainder of 5 ÷ 2, or 1. (If you’re trying to remember how long division works, that just means that 5 ÷ 2 is equal to 2 × 2 + 1, so the rounded quotient is 2 and the remainder is 1.) But when you start dealing with negative numbers, there’s a difference between mod (or modulus) and remainder. You can see for yourself: your calculator will tell you that –397 mod 17 = 11, but if you use the C# remainder operator you’ll get –397 % 17 = –6.</p>
<p><strong>Q: Owen’s formula had me dividing two values and then rounding the result down to the nearest integer. How does that fit in with casting?</strong></p>
<p><strong>A:</strong> Let’s say you have some floating-point values:</p>
<pre data-type="programlisting">float f1 = 185.26F;
double d2 = .0000316D;
decimal m3 = 37.26M;</pre>
<p>and you want to cast them to int values so you can assign them to int variables <code><strong>i1</strong></code>, <code><strong>i2</strong></code>, and <code><strong>i3</strong></code>. We know that those int variables can only hold integers, so your program needs to do <em><code>something</code></em> to the decimal part of the number.</p>
<p>So C# has a consistent rule: it drops the decimal and rounds down: <code><strong>f1</strong></code> becomes 185, <code><strong>d2</strong></code> becomes 0, and <code><strong>m3</strong></code> becomes 37. But don’t take our word for it—write your own C# code that casts those three floating-point values to int to see what happens.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">There’s a whole web page dedicated to the 0.30000000000000004 problem! Check out <u>https://0.30000000000000004.com</u> to see examples in a lot of different languages.</span></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The 0.1D + 0.2D != 0.3D example is an <span style="color:#9D9EA0;"><u>edge case</u></span>, or a problem or situation that only happens under certain rare conditions, usually when a parameter is at one of its extremes (like a very big or very small number). If you want to learn more about it, there’s a great article by Jon Skeet about how floating-point numbers are stored in memory in .NET. You can read it here: <a href="https://csharpindepth.com/Articles/FloatingPoint">https://csharpindepth.com/Articles/FloatingPoint</a>.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Jon gave us some amazing technical review feedback for the 1st edition of this book that made a huge difference for us. Thanks so much, Jon!</span></p>
</div>
</div></aside>
</div></section>
</div></section>
<section data-pdf-bookmark="Use reference variables to access your objects" data-type="sect1"><div class="sect1" id="use_reference_variables_to_access_your_o">
<h1>Use reference variables to access your objects</h1>
<p><a data-primary="reference variables" data-secondary="about" data-type="indexterm" id="idm46402346057800"/><a data-primary="types" data-secondary="referring to objects with reference variables" data-type="indexterm" id="idm46402346061080"/>When you create a new object, you use a <code><strong>new</strong></code> statement to instantiate it, like <code><strong>new Guy()</strong></code> in your program at the end of the last chapter—the <code><strong>new</strong></code> statement created a new Guy object on the heap. You still needed a way to <em>access</em> that object, and that’s where a variable like <code><strong>joe</strong></code> came in: <code><strong>Guy joe = new Guy()</strong></code>. Let’s dig a little deeper into exactly what’s going on there.</p>
<p>The <code><strong>new</strong></code> statement creates the instance, but just creating that instance isn’t enough. <strong><em>You need a reference to the object</em></strong>. So you created a <strong>reference variable</strong>: a variable of type Guy with a name, like <code><strong>joe</strong></code>. So <code><strong>joe</strong></code> is a reference to the new Guy object you created. Any time you want to use that particular Guy, you can reference it with the reference variable called <code><strong>joe</strong></code>.</p>
<p>When you have a variable that’s an object type, it’s a reference variable: a reference to a particular object. Let’s just make sure we get the terminology right since we’ll be using it a lot. We’ll use the first two lines of the “Joe and Bob” program from the last chapter:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/186fig01.png"/>
<h6/>
</div></figure>
<section data-pdf-bookmark="References are like sticky notes for your objects" data-type="sect2"><div class="sect2" id="references_are_like_sticky_notes_for_you">
<h2>References are like sticky notes for your objects</h2>
<p>In your kitchen, you probably have containers of salt and sugar. If you switched their labels, it would make for a pretty disgusting meal—even though you changed the labels, the contents of the containers stayed the same. <strong><em>References are like labels.</em></strong> You can move labels around and point them at different things, but it’s the <strong>object</strong> that dictates what methods and data are available, not the reference itself—and you can <strong>copy references</strong> just like you copy values.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/187fig01.png"/>
<h6/>
</div></figure>
<blockquote>
<p><strong>A <span style="color:#9D9EA0;">reference</span> is like a <span style="color:#9D9EA0;">label</span> that your code uses to talk about a specific object. You use it to access fields and call methods on an object that it <span style="color:#9D9EA0;">points</span> to.</strong></p>
</blockquote>
<p>We stuck a lot of sticky notes on that object! In this particular case, there are a lot of different references to this same Guy object—because a lot of different methods use it for different things. Each reference has a different name that makes sense in its context.</p>
<p>That’s why it can be really useful to have <strong><em>multiple references pointing to the same instance</em></strong>. So you could say <code><strong>Guy dad = joe</strong></code>, and then call <code><strong>dad.GiveCash()</strong></code> (that’s what Joe’s kid does every day). If you want to write code that works with an object, you need a reference to that object. If you don’t have that reference, you have no way to access the object.</p>
</div></section>
<section data-pdf-bookmark="If there aren’t any more references,your object gets garbage-collected" data-type="sect2"><div class="sect2" id="if_there_arenapostrophet_any_more_refere">
<h2>If there aren’t any more references,your object gets garbage-collected</h2>
<p><a data-primary="garbage collection" data-type="indexterm" id="idm46402346032392"/><a data-primary="objects" data-secondary="garbage collection" data-type="indexterm" id="idm46402346034536"/><a data-primary="reference variables" data-secondary="garbage collection" data-type="indexterm" id="idm46402346033464"/>If all of the labels come off of an object, programs can no longer access that object. That means C# can mark the object for <strong>garbage collection</strong>. That’s when C# gets rid of any unreferenced objects and reclaims the memory those objects took up for your program’s use.</p>
<ol>
<li><p><strong>Here’s some code that creates an object.</strong></p>
<p>Just to recap what we’ve been talking about: when you use the <code><strong>new</strong></code> statement, you’re telling C# to create an object. When you take a reference variable like <code><strong>joe</strong></code> and assign it to that object, it’s like you’re slapping a new sticky note on it.</p>
<pre data-type="programlisting">   Guy joe = new Guy() { Cash = 50, Name = "Joe" };</pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/188fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Now let’s create our second object.</strong></p>
<p>Once we do this we’ll have two Guy object instances and two reference variables: one variable (<code><strong>joe</strong></code>) for the first Guy object, and another variable (<code><strong>bob</strong></code>) for the second.</p>
<pre data-type="programlisting">   Guy bob = new Guy() { Cash = 100, Name = "Bob" };</pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/188fig02.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Let’s take the reference to the <u>first</u> Guy object and change it to point to the <u>second</u> Guy object.</strong></p>
<p><a data-primary="CLR (Common Language Runtime)" data-type="indexterm" id="idm46402346016744"/>Take a really close look at what you’re doing when you create a new Guy object. You’re taking a variable and using the = assignment operator to set it—in this case, to a reference that’s returned by the <code><strong>new</strong></code> statement. That assignment works because <strong>you can copy a reference just like you copy a value</strong>.</p>
<p>So let’s go ahead and copy that value:</p>
<pre data-type="programlisting"> joe = bob;</pre>
<p>That tells C# to take make <code><strong>joe</strong></code> point to the same object that <code><strong>bob</strong></code> does. Now the <code><strong>joe</strong></code> and <code><strong>bob</strong></code> variables <strong>both point to the same object</strong>.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/189fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>There’s no longer a reference to the first Guy object…so it gets <u>garbage-collected</u>.</strong></p>
<p>Now that joe is pointing to the same object as bob, there’s no longer a reference to the Guy object it used to point to. So what happens? C# marks the object for garbage collection, and <strong><em>eventually</em></strong> trashes it. Poof—it’s gone!</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The CLR keeps track of all of the references to each object, and when the last reference disappears it marks it for removal. But it might have other things to do right now, so the object could stick around for a few milliseconds—or even longer!</p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/189fig02.png"/>
<h6/>
</div></figure></li>
</ol>
<blockquote>
<p><strong>For an object to stay in the heap, it has to be referenced. Some time after the last reference to the object disappears, so does the object.</strong></p>
</blockquote>

<figure class="informal"><div class="figure">
<img alt="Images" src="assets/190fig01z.png"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-pdf-bookmark="Multiple references and their side effects" data-type="sect1"><div class="sect1" id="multiple_references_and_their_side_effec">
<h1>Multiple references and their side effects</h1>
<p><a data-primary="reference variables" data-secondary="multiple references to single object" data-tertiary="side effects of" data-type="indexterm" id="idm46402345997720"/><a data-primary="types" data-secondary="multiple references and their side effects" data-type="indexterm" id="idm46402345996232"/>You’ve got to be careful when you start moving reference variables around. Lots of times, it might seem like you’re simply pointing a variable to a different object. You could end up removing all references to another object in the process. That’s not a bad thing, but it may not be what you intended. Take a look:</p>
<ol>
<li><pre data-type="programlisting"><strong>Dog rover = new Dog();</strong>
<strong>rover.Breed = "Greyhound";</strong></pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/190fig01.png"/>
<h6/>
</div></figure></li>
<li><pre data-type="programlisting"><strong>Dog fido = new Dog();</strong>
<strong>fido.Breed = "Beagle";</strong>
<strong>Dog spot = rover;</strong></pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/190fig02.png"/>
<h6/>
</div></figure></li>
<li><pre data-type="programlisting"><strong>Dog lucky = new Dog();</strong>
<strong>lucky.Breed = "Dachshund";</strong>
<strong>fido = rover;</strong></pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/190fig03.png"/>
<h6/>
</div></figure></li>
</ol>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0023">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="object references" data-type="indexterm" id="idm46402345979128"/><a data-primary="objects" data-secondary="exercises on" data-type="indexterm" id="idm46402345977608"/><a data-primary="references" data-secondary="exercises on" data-type="indexterm" id="idm46402345976456"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="object references" data-type="indexterm" id="idm46402345975304"/>Now it’s your turn. Here’s one long block of code. Figure out how many objects and references there are at each stage. On the right-hand side, draw a picture of the objects and sticky notes in the heap.</p>
<ol>
<li><pre data-type="programlisting">Dog rover = new Dog();
rover.Breed = "Greyhound";
Dog rinTinTin = new Dog();
Dog fido = new Dog();
Dog greta = fido;</pre>
<p>Objects:______</p>
<p>References:_____</p></li>
<li><pre data-type="programlisting">Dog spot = new Dog();
spot.Breed = "Dachshund";
spot = rover;</pre>
<p>Objects:______</p>
<p>References:_____</p></li>
<li><pre data-type="programlisting">Dog lucky = new Dog();
lucky.Breed = "Beagle";
Dog charlie = fido;
fido = rover;</pre>
<p>Objects:______</p>
<p>References:_____</p></li>
<li><pre data-type="programlisting">rinTinTin = lucky;
Dog laverne = new Dog();
laverne.Breed = "pug";</pre>
<p>Objects:______</p>
<p>References:_____</p></li>
<li><pre data-type="programlisting">charlie = laverne;
lucky = rinTinTin;</pre>
<p>Objects:______</p>
<p>References:_____</p></li>
</ol>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd008">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/192fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="garbage_collection_exposed">
<h5><span class="inlineimage"><img alt="Images" src="assets/193fig01.png"/></span>  Garbage Collection Exposed</h5>
<p>This week’s interview:</p>
<p><strong>The .NET Common Language Runtime</strong></p>
<p><a data-primary="API (application programming interface)" data-type="indexterm" id="idm46402345957016"/><a data-primary="binary (executable)" data-type="indexterm" id="idm46402345956328"/><a data-primary="CIL (Common Intermediate Language)" data-type="indexterm" id="idm46402345955512"/><a data-primary="CLR (Common Language Runtime)" data-type="indexterm" id="idm46402345954632"/><a data-primary="compiler" data-type="indexterm" id="idm46402345953752"/><a data-primary="garbage collection" data-type="indexterm" id="idm46402345952872"/><strong>Head First:</strong> So, we understand that you do a pretty important job for us. Can you tell us a little more about what you do?</p>
<p><strong>Common Language Runtime (CLR</strong>): In a lot of ways, it’s pretty simple. I run your code. Any time you’re using a .NET app, I’m making it work.</p>
<p><strong>Head First:</strong> What do you mean by making it work?</p>
<p><strong>CLR:</strong> I take care of the low-level “stuff” for you by doing a sort of “translation” between your program and the computer running it. When you talk about instantiating objects or doing garbage collection, I’m the one that’s managing all of those things.</p>
<p><strong>Head First:</strong> So how does that work, exactly?</p>
<p><strong>CLR:</strong> Well, when you run a program on Windows, Linux, macOS, or most other operating systems, the OS loads machine language from a binary.</p>
<p><strong>Head First:</strong> I’m going to stop you right there. Can you back up and tell us what machine language is?</p>
<p><strong>CLR:</strong> Sure. A program written in machine language is made up of code that’s executed directly by the CPU—and it’s a whole lot less readable than C#.</p>
<p><strong>Head First:</strong> If the CPU is executing the actual machine code, what does the OS do?</p>
<p><strong>CLR:</strong> The OS makes sure each program gets its own process, respects the system’s security rules, and provides APIs.</p>
<p><strong>Head First:</strong> And for our readers who don’t know what an API is?</p>
<p><strong>CLR:</strong> An API—or application programming interface—is a set of methods provided by an OS, library, or program. OS APIs help you do things like work with the filesystem and interact with hardware. But they’re often pretty difficult to use—especially for memory management—and they vary from OS to OS.</p>
<p><strong>Head First:</strong> So back to your job. You mentioned a binary. What exactly is that?</p>
<p><strong>CLR:</strong> A binary is a file that’s (usually) created by a <strong>compiler</strong>, a program whose job it is to convert high-level language into low-level code like machine code. Windows binaries usually end with <em>.exe</em> or <em>.dll</em>.</p>
<p><strong>Head First:</strong> But I’m guessing that there’s a twist here. You said “low-level code like machine code” —does that mean there are other kinds of low-level code?</p>
<p><strong>CLR:</strong> Exactly. I don’t run the same machine language as the CPU. When you build your C# code, Visual Studio asks the C# compiler to create <strong>Common Intermediate Language (CIL)</strong>. That’s what I run. C# code is turned into CIL, which I read and execute.</p>
<p><strong>Head First:</strong> You mentioned managing memory. Is that where garbage collection fits into all of this?</p>
<p><strong>CLR:</strong> Yes! One really, really useful thing that I do for you is that I tightly manage your computer’s memory by figuring out when your program’s finished with certain objects. When it is, I get rid of them for you to free up that memory. That’s something programmers used to have to do themselves—but thanks to me, it’s something that you don’t have to be bothered with. You might not have known it at the time, but I’ve been making your job of learning C# a whole lot easier.</p>
<p><strong>Head First:</strong> You mentioned Windows binaries. What if I’m running .NET programs on Mac or Linux? Are you doing the same thing for those OSs?</p>
<p><strong>CLR:</strong> If you’re using a macOS or Linux—or running Mono on Windows— then you’re technically not using me. You’re using my cousin, the Mono Runtime, which implements the same <em>ECMA Common Language Infrastructure (CLI)</em> that I do. So when it comes to all the stuff I’ve talked about so far, we both do exactly the same thing.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-idd0014">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise</h5>
<p><a data-primary="exercises" data-secondary="garbage-collection" data-type="indexterm" id="idm46402345931240"/>Create a program with an Elephant class. Instantiate two Elephant instances and then swap the reference values that point to them, <strong><em>without</em></strong> getting any Elephant instances garbage-collected. Here’s what it will look like when your program runs.</p>
<p><strong>You’re going to build a new console app that has a class called Elephant.</strong></p>
<p>Here’s an example of the output of the program:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/194fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>The CLR garbage-collects any object with no references to it. So here’s a hint for this exercise: if you want to pour a cup of coffee into another cup that’s currently full of tea, you’ll need a third glass to pour the tea into…</strong></p>
</div>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-idd0015">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise</h5>
<p>Your job is to create a .NET Core console app with an Elephant class that matches the class diagram and uses its fields and methods to generate output that matches the example output.</p>
<ol>
<li><p><strong>Create a new .NET Core console app and add the Elephant class.</strong></p>
<p>Add an Elephant class to the project. Have a look at the Elephant class diagram–you’ll need an int field called EarSize and a string field called Name. Add them, and make sure both are public. Then add a method called WhoAmI that writes two lines to the console to tell you the name and ear size of the elephant. Look at the example output to see exactly what it’s supposed to print.</p></li>
<li><p><strong>Create two Elephant instances and a reference.</strong></p>
<p>Use object initializers to instantiate two Elephant objects:</p>
<pre data-type="programlisting">Elephant lucinda = new Elephant() { Name = "Lucinda", EarSize = 33 };
Elephant lloyd = new Elephant() { Name = "Lloyd", EarSize = 40 };</pre></li>
<li><p><strong>Call their WhoAmI methods.</strong></p>
<p>When the user presses 1, call lloyd.WhoAmI. When the user presses 2, call lucinda.WhoAmI. Make sure that the output matches the example.</p></li>
<li><p><strong>Now for the fun part: <u>swap</u> the references.</strong></p>
<p>Here’s the interesting part of this exercise. When the user presses 3, make the app call a method that <strong><em>exchanges the two references</em></strong>. You’ll need to write that method. After you swap references, pressing 1 should write Lucinda’s message to the console, and pressing 2 should write Lloyd’s message. If you swap the references again, everything should go back to normal.</p></li>
</ol>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/195fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise_solution-idd0003">
<h5><span class="inlineimage"><img alt="Images" src="assets/exercise.png"/></span> Exercise Solution</h5>
<p>Create a program with an Elephant class. Instantiate two Elephant instances and then swap the reference values that point to them, <strong><em>without</em></strong> getting any Elephant instances garbage-collected.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/196fig01.png"/>
<h6/>
</div></figure>
<p>Here’s the Main method inside the Program class:</p>
<pre data-type="programlisting">static void Main(string[] args)
{
    Elephant lucinda = new Elephant() { Name = "Lucinda", EarSize = 33 };
    Elephant lloyd = new Elephant() { Name = "Lloyd", EarSize = 40 };

    Console.WriteLine("Press 1 for Lloyd, 2 for Lucinda, 3 to swap");
    while (true)
    {
        char input = Console.ReadKey(true).KeyChar;
        Console.WriteLine("You pressed " + input);
        if (input == '1')
        {
            Console.WriteLine("Calling lloyd.WhoAmI()");
            lloyd.WhoAmI();
        } else if (input == '2')
        {
            Console.WriteLine("Calling lucinda.WhoAmI()");
            lucinda.WhoAmI();
        } else if (input == '3')
        {
            Elephant holder;
            holder = lloyd;
            lloyd = lucinda;
            lucinda = holder;
            Console.WriteLine("References have been swapped");
        }
        else return;
        Console.WriteLine();
    }
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">If you just point Lloyd to Lucinda, there won’t be any more references pointing to Lloyd, and his object will be lost. That’s why you need to have an extra variable (we called it “holder”) to keep track of the Lloyd object reference until Lucinda can get there.</span></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">There’s no “new” statement when we declare the “holder” variable because we don’t want to create another instance of Elephant.</span></p>
</div>
</div></aside>
<section data-pdf-bookmark="Two references mean TWO variables that can change the same object’s data" data-type="sect2"><div class="sect2" id="two_references_mean_two_variables_that_c">
<h2>Two references mean <u>TWO</u> variables that can change the same object’s data</h2>
<p><a data-primary="garbage collection" data-type="indexterm" id="idm46402345898600"/><a data-primary="reference variables" data-secondary="multiple references to single object" data-tertiary="unintentional changes" data-type="indexterm" id="idm46402345895992"/>Besides losing all the references to an object, when you have multiple references to an object, you can unintentionally change the object. In other words, one reference to an object may <strong><em>change</em></strong> that object, while another reference to that object has <strong><em>no idea</em></strong> that something has changed. Let’s see how that works.</p>
<p><strong><em>Do this!</em></strong></p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/197fig01.png"/>
<h6/>
</div></figure>
<p>Now go ahead and run your program. Here’s what you’ll see:</p>
<pre data-type="programlisting">You pressed 4
My name is Lucinda
My ears are 4321 inches tall.

You pressed 1
Calling lloyd.WhoAmI()
My name is Lucinda
My ears are 4321 inches tall.

You pressed 2
Calling lucinda.WhoAmI()
My name is Lucinda
My ears are 4321 inches tall.</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The program acts normally... until you press 4. Once you do that, pressing either 1 or 2 prints the same output—and pressing 3 to swap the references doesn’t do anything anymore.</p>
</div>
<p>After you press 4 and run the new code that you added, both the <code><strong>lloyd</strong></code> and lucinda variables <strong>contain the same reference</strong> to the second Elephant object. Pressing 1 to call lloyd.WhoAmI prints exactly the same message as pressing 2 to call <code><strong>lucinda</strong></code>.WhoAmI. Swapping them makes no difference because you’re swapping two identical references.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Objects use references to talk to each other" data-type="sect1"><div class="sect1" id="objects_use_references_to_talk_to_each_o">
<h1>Objects use references to talk to each other</h1>
<p><a data-primary="methods" data-secondary="this keyword with" data-type="indexterm" id="idm46402345883240"/><a data-primary="objects" data-secondary="talking to other objects" data-type="indexterm" id="idm46402345882264"/><a data-primary="reference variables" data-secondary="objects talking to other objects" data-type="indexterm" id="idm46402345881288"/><a data-primary="this keyword" data-type="indexterm" id="idm46402345880312"/>So far, you’ve seen forms talk to objects by using reference variables to call their methods and check their fields. Objects can call one another’s methods using references, too. In fact, there’s nothing that a form can do that your objects can’t do, because <strong>your form is just another object</strong>. When objects talk to each other, one useful keyword that they have is <code><strong>this</strong></code>. Any time an object uses the <code><strong>this</strong></code> keyword, it’s referring to itself—it’s a reference that points to the object that calls it. Let’s see what that looks like by modifying the Elephant class so instances can call each other’s methods.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/198fig02.png"/>
<h6/>
</div></figure>
<ol>
<li><p><strong>Add a method that lets an Elephant hear a message.</strong></p>
<p>Let’s add a method to the Elephant class. Its first parameter is a message from another Elephant object. Its second parameter is the Elephant object that sent the message:</p>
<p><strong><em>Do this!</em></strong></p>
<pre data-type="programlisting"> public void HearMessage(string message, Elephant whoSaidIt) {
      Console.WriteLine(Name + " heard a message");
      Console.WriteLine(whoSaidIt.Name + " said this: " + message);
 }</pre>
<p>Here’s what it looks like when it’s called:</p>
<pre data-type="programlisting"> lloyd.HearMessage("Hi", lucinda);</pre>
<p>We called <code><strong>lloyd’s</strong></code> HearMessage method, and passed it two parameters: the string <code><strong>"Hi"</strong></code> and a reference to Lucinda’s object. The method uses its <code><strong>whoSaidIt</strong></code> parameter to access the Name field of whatever elephant was passed in.</p></li>
<li><p><strong>Add a method that lets an Elephant send a message.</strong></p>
<p>Now let’s add a SpeakTo method to the Elephant class. It uses a special keyword: <code><strong>this</strong></code>. That’s a reference that <strong>lets an object get a reference to itself</strong>.</p>
<pre data-type="programlisting">public void SpeakTo(Elephant whoToTalkTo, string message) {
    whoToTalkTo.HearMessage(message, this);
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">An Elephant’s SpeakTo method uses the “this” keyword to send a reference to itself to another Elephant.</span></p>
</div>
<p>Let’s take a closer look at what’s going on.</p>
<p>When we call the Lucinda object’s SpeakTo method:</p>
<pre data-type="programlisting"> lucinda.SpeakTo(lloyd, "Hi, Lloyd!");</pre>
<p>It calls the Lloyd object’s HearMessage method like this:</p>
<pre data-type="programlisting">whoToTalkTo.HearMessage("Hi, Lloyd!", this);</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Lucinda uses whoToTalkTo (which has a reference to Lloyd) to call HearMessage.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>this is replaced with a reference to Lucinda’s object.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<pre data-type="programlisting"><em>[a reference to Lloyd]</em>.HearMessage("Hi, Lloyd!", [<em>a reference to Lucinda</em>]);</pre>
</div></li>
<li><p><strong>Call the new methods.</strong></p>
<p>Add one more <code><strong>else if</strong></code> block to the Main method to make the Lucinda object send a message to the Lloyd object:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">else if (input == '4')</span>
<span style="color:#9D9EA0;">{</span>
   <span style="color:#9D9EA0;"> lloyd = lucinda;</span>
   <span style="color:#9D9EA0;"> lloyd.EarSize = 4321;</span>
   <span style="color:#9D9EA0;"> lloyd.WhoAmI();</span>
<span style="color:#9D9EA0;">}</span>
<strong>else if (input == '5')</strong>
<strong>{</strong>
    <strong>lucinda.SpeakTo(lloyd, "Hi, Lloyd!");</strong>
<strong>}</strong>
<span style="color:#9D9EA0;">else</span>
<span style="color:#9D9EA0;">{</span>
   <span style="color:#9D9EA0;"> return;</span>
<span style="color:#9D9EA0;">}</span></pre>
<p>Now run your program and press 5. You should see this output:</p>
<pre data-type="programlisting">You pressed 5
Lloyd heard a message
Lucinda said this: Hi, Lloyd!</pre></li>
<li><p><strong>Use the debugger to understand what’s going on.</strong></p>
<p>Place a breakpoint on the statement that you just added to the Main method:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/199fig01.png"/>
<h6/>
</div></figure>
<ol>
<li><p>Run your program and press 5.</p></li>
<li><p>When it hits the breakpoint, use Debug &gt;&gt; Step Into (F11) to step into the SpeakTo method.</p></li>
<li><p>Add a watch for Name to show you which Elephant object you’re inside. You’re currently inside the Lucinda object—which makes sense because the Main method called lucinda.SpeakTo.</p></li>
<li><p>Hover over the <code><strong>this</strong></code> keyword at the end of the line and expand it. It’s a reference to the Lucinda object.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/199fig02.png"/>
<h6/>
</div></figure>
<p>Hover over <code><strong>whoToTalkTo</strong></code> and expand it—it’s a reference to the Lloyd object.</p></li>
<li><p>The SpeakTo method has one statement—it calls whoToTalkTo.HearMessage. Step into it.</p></li>
<li><p>You should now be inside the HearMessage method. Check your watch again—now the value of the Name field is “Lloyd” —the Lucinda object called the Lloyd object’s HearMessage method.</p></li>
<li><p>Hover over <code><strong>whoSaidIt</strong></code> and expand it. It’s a reference to the Lucinda object.</p></li>
</ol></li>
</ol>
<p>Finish stepping through the code. Take a few minutes to really understand what’s going on.</p>
<blockquote>
<p><strong>The “this” keyword lets an object get a reference to itself.</strong></p>
</blockquote>
</div></section>
<section data-pdf-bookmark="Arrays hold multiple values" data-type="sect1"><div class="sect1" id="arrays_hold_multiple_values">
<h1><u>Arra</u>y<u>s</u> hold multiple values</h1>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="arrays" data-secondary="about" data-type="indexterm" id="idm46402345823880"/><a data-primary="arrays" data-secondary="zero-based" data-type="indexterm" id="idm46402345822904"/><a data-primary="index" data-type="indexterm" id="idm46402345821928"/><a data-primary="new statements" data-type="indexterm" id="idm46402345821192"/><a data-primary="types" data-secondary="arrays" data-type="indexterm" id="idm46402345820344"/><a data-primary="zero-based arrays" data-type="indexterm" id="idm46402345819192"/>Strings and arrays are different from the other data types you’ve seen in this chapter because they’re the only ones without a set size (think about that for a bit).</p>
</div>
<p>If you have to keep track of a lot of data of the same type, like a list of prices or a group of dogs, you can do it in an <strong>array</strong>. What makes an array special is that it’s a <strong>group of variables</strong> that’s treated as one object. An array gives you a way of storing and changing more than one piece of data without having to keep track of each variable individually. When you create an array, you declare it just like any other variable, with a name and a type—except <strong>the type is followed by square brackets</strong>:</p>
<pre data-type="programlisting"><strong>bool[] myArray;</strong></pre>
<p>Use the <code><strong>new</strong></code> keyword to create an array. Let’s create an array with 15 bool elements:</p>
<pre data-type="programlisting"><strong>myArray = new bool[15];</strong></pre>
<p>Use square brackets to set one of the values in the array. This statement sets the value of the fifth element of <code><strong>myArray</strong></code> to <code><strong>true</strong></code> by using square brackets and specifying the <strong>index</strong> 4. It’s the fifth one because the first is <code><strong>myArray[0]</strong></code>, the second is <code><strong>myArray[1]</strong></code>, etc.:</p>
<pre data-type="programlisting"><strong>myArray[4] = false;</strong></pre>
<section data-pdf-bookmark="Use each element in an array like it’s a normal variable" data-type="sect2"><div class="sect2" id="use_each_element_in_an_array_like_itapos">
<h2>Use each element in an array like it’s a normal variable</h2>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>You use the <code>new</code> keyword to create an array because it’s an object—so an array variable is a kind of reference variable. In C#, arrays are <span style="color:#9D9EA0;"><u>zero-based</u></span>, which means the first element has index 0.</strong></p>
</div>
<p>When you use an array, first you need to <strong>declare a reference variable</strong> that points to the array. Then you need to <strong>create the array object</strong> using the <code><strong>new</strong></code> statement, specifying how big you want the array to be. Then you can <strong>set the elements</strong> in the array. Here’s an example of code that declares and fills up an array—and what’s happening in the heap when you do it. The first element in the array has an <strong>index</strong> of 0.</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;"><strong>// declare a new 7-element decimal array</strong></span>
<strong>decimal[] prices = new decimal[7];</strong>
<strong>prices[0] = 12.37M;</strong>
<strong>prices[1] = 6_193.70M;</strong>
<span style="color:#9D9EA0;"><strong>// we didn't set the element</strong></span>
<span style="color:#9D9EA0;"><strong>// at index 2, it remains</strong></span>
<span style="color:#9D9EA0;"><strong>// the default value of 0</strong></span>
<strong>prices[3] = 1193.60M;</strong>
<strong>prices[4] = 58_000_000_000M;</strong>
<strong>prices[5] = 72.19M;</strong>
<strong>prices[6] = 74.8M;</strong></pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/200fig01.png"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-pdf-bookmark="Arrays can contain reference variables" data-type="sect1"><div class="sect1" id="arrays_can_contain_reference_variables">
<h1>Arrays can contain reference variables</h1>
<p><a data-primary="arrays" data-secondary="containing reference variables" data-type="indexterm" id="idm46402345790024"/><a data-primary="arrays" data-secondary="finding length" data-type="indexterm" id="idm46402345788824"/><a data-primary="Length property, arrays" data-type="indexterm" id="idm46402345787704"/><a data-primary="reference variables" data-secondary="arrays of" data-type="indexterm" id="idm46402345786744"/>You can create an <strong>array of object references</strong> just like you create an array of numbers or strings. Arrays don’t care what type of variable they store; it’s up to you. So you can have an array of ints, or an array of Duck objects, with no problem.</p>
<p>Here’s code that creates an array of seven Dog variables. The line that initializes the array only creates reference variables. Since there are only two <code><strong>new Dog()</strong></code> lines, only two actual instances of the Dog class are created.</p>
<blockquote>
<p><strong>When you set or retrieve an element from an array, the number inside the brackets is called the <span style="color:#9D9EA0;">index</span>. The first element in the array has an index of 0.</strong></p>
</blockquote>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/201fig01.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>An array’s length</p>
<p>You can find out how many elements are in an array using its Length property. So if you’ve got an array called “prices”, then you can use prices.Length to find out how long it is. If there are seven elements in the array, that’ll give you 7—which means the array elements are numbered 0 to 6.</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-idd0024">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil</h5>
<p><a data-primary="arrays" data-secondary="exercises on" data-type="indexterm" id="idm46402345776920"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="arrays" data-type="indexterm" id="idm46402345775768"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="arrays" data-type="indexterm" id="idm46402345774344"/>Here’s an array of Elephant objects and a loop that will go through it and find the one with the biggest ears. What’s the value of biggestEars.EarSize <strong>after</strong> each iteration of the <code><strong>for</strong></code> loop?</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/202fig01.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-pdf-bookmark="null means a reference points to nothing" data-type="sect1"><div class="sect1" id="null_means_a_reference_points_to_nothing">
<h1><u>null</u> means a reference points to nothing</h1>
<p><a data-primary="garbage collection" data-type="indexterm" id="idm46402345768200"/><a data-primary="null" data-type="indexterm" id="idm46402345767464"/><a data-primary="objects" data-secondary="null keyword" data-type="indexterm" id="idm46402345766728"/>There’s another important keyword that you’ll use with objects. When you create a new reference and don’t set it to anything, it has a value. It starts off set to <span class="code"/><code><strong>null</strong></code>, which means <strong>it’s not pointing to any object at all</strong>. Let’s have a closer look at this:</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/203fig01.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/203fig02.png"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Yes. The null keyword can be very useful.</strong></p>
<p>There are a few ways you see <code><strong>null</strong></code> used in typical programs. The most common way is making sure a reference points to an object:</p>
<pre data-type="programlisting"> <code><strong>if (lloyd == null) {</strong></code></pre>
<p>That test will return <code><strong>true</strong></code> if the <code><strong>lloyd</strong></code> reference is set to <code><strong>null</strong></code>.</p>
<p>Another way you’ll see the <code><strong>null</strong></code> keyword used is when you <strong><em>want</em></strong> your object to get garbage-collected. If you’ve got a reference to an object and you’re finished with the object, setting the reference to <code><strong>null</strong></code> will immediately mark it for collection (unless there’s another reference to it somewhere).</p>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-idd009">
<h5><span class="inlineimage"><img alt="Images" src="assets/pencil.png"/></span> Sharpen your pencil Solution</h5>
<p><a data-primary="arrays" data-secondary="exercises on" data-type="indexterm" id="idm46402345748472"/><a data-primary="exercises" data-secondary="Sharpen your pencil" data-tertiary="arrays" data-type="indexterm" id="idm46402345747080"/><a data-primary="Sharpen Your Pencil exercises" data-secondary="arrays" data-type="indexterm" id="idm46402345745688"/>Here’s an array of Elephant objects and a loop that will go through it and find the one with the biggest ears. What’s the value of biggestEars.EarSize <strong>after</strong> each iteration of the <code><strong>for</strong></code> loop?</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">The for loop starts with the second Elephant and compares it to whatever Elephant biggestEars points to. If its ears are bigger, it points biggestEars at that Elephant instead. Then it moves to the next one, then the next one…by the end of the loop, biggestEars points to the one with the biggest ears.</span></p>
</div>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/204fig01.png"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-idd0011">
<h5>there are no Dumb Questions</h5>
<p><a data-primary="CLR (Common Language Runtime)" data-type="indexterm" id="idm46402345739416"/><a data-primary="garbage collection" data-type="indexterm" id="idm46402345738648"/><a data-primary="objects" data-secondary="talking to other objects" data-type="indexterm" id="idm46402345737912"/><a data-primary="reference variables" data-secondary="how they work" data-type="indexterm" id="idm46402345735720"/><a data-primary="this keyword" data-type="indexterm" id="idm46402345734536"/><a data-primary="types" data-secondary="different types holding different-sized values" data-type="indexterm" id="idm46402345733736"/><a data-primary="value types" data-secondary="changing" data-type="indexterm" id="idm46402345732600"/><strong>Q: I’m still not sure I get how references work.</strong></p>
<p><strong>A:</strong> References are the way you use all of the methods and fields in an object. If you create a reference to a Dog object, you can then use that reference to access any methods you’ve created for the Dog object. If the Dog class has (nonstatic) methods called Bark and Fetch, you can create a reference called <code><strong>spot</strong></code>, and then you can use that to call spot.Bark() or spot.Fetch(). You can also change information in the fields for the object using the reference (so you could change a Breed field using spot.Breed).</p>
<p><strong>Q: Then doesn’t that mean that every time I change a value through a reference I’m changing it for all of the other references to that object, too?</strong></p>
<p><strong>A:</strong> Yes. If the <code><strong>rover</strong></code> variable contains a reference to the same object as <code><strong>spot</strong></code>, changing rover.Breed to “beagle” would make it so that spot.Breed was “beagle” .</p>
<p><strong>Q: Remind me again—what does <code><strong>this</strong></code> do?</strong></p>
<p><strong>A:</strong> <code><strong>this</strong></code> is a special variable that you can only use inside an object. When you’re inside a class, you use <code><strong>this</strong></code> to refer to any field or method of that particular instance. It’s especially useful when you’re working with a class whose methods call other classes. One object can use it to send <strong>a reference to itself</strong> to another object. So if <code><strong>spot</strong></code> calls one of <code><strong>rover</strong></code>’s methods passing <code><strong>this</strong></code> as a parameter, he’s giving <code><strong>rover</strong></code> a reference to the <code><strong>spot</strong></code> object.</p>
<p><strong>Q: You keep talking about garbage-collecting, but what’s actually doing the collecting?</strong></p>
<p><strong>A:</strong> Every .NET app runs inside the <strong>Common Language Runtime</strong> (or the Mono Runtime if you’re running your apps on macOS, Linux, or using Mono on Windows). The CLR does a lot of stuff, but there are two <em><code>really important things</code></em> the CLR does that we’re concerned about right now. First, it <strong>executes your code</strong>—specifically, the output produced by the C# compiler. Second, it manages the memory that your program uses. That means it keeps track of all of your objects, figures out when the last reference to an object disappears, and frees up the memory that it was using. The .NET team at Microsoft and the Mono team at Xamarin (which was a separate company for many years, but is now a part of Microsoft) have done an enormous amount of work making sure that it’s fast and efficient.</p>
<p><strong>Q: I still don’t get that stuff about different types holding different-sized values. Can you go over that one more time?</strong></p>
<p><strong>A:</strong> Sure. The thing about variables is they assign a size to your number no matter how big its value is. So if you name a variable and give it a long type even though the number is really small (like, say, 5), the CLR sets aside enough memory for it to get really big. When you think about it, that’s really useful. After all, they’re called variables because they change all the time.</p>
<p>The CLR assumes you know what you’re doing and you’re not going to give a variable a type bigger than it needs. So even though the number might not be big now, there’s a chance that after some math happens, it’ll change. The CLR gives it enough memory to handle the largest value that type can accommodate.</p>
<blockquote>
<p><strong>Any time you’ve got code in an object that’s going to be instantiated, the instance can use the special <span style="color:#9D9EA0;">this</span> variable that has a reference to itself.</strong></p>
</blockquote>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="tabletop_games">
<h5><span class="inlineimage"><img alt="Images" src="assets/game.png"/></span>  Tabletop Games</h5>
<p><a data-primary="Game design... and beyond elements" data-secondary="Tabletop Games" data-type="indexterm" id="idm46402345711688"/><a data-primary="random number generators" data-type="indexterm" id="idm46402345710680"/><a data-primary="Tabletop Games Game design... and beyond element" data-type="indexterm" id="idm46402345709912"/><strong>Game design... and beyond</strong></p>
<p>There’s a rich history to tabletop games—and, as it turns out, a long history of tabletop games influencing video games, at least as early as the very first commercial role-playing game.</p>
<ul>
<li><p>The first edition of Dungeons and Dragons (D&amp;D) was released in 1974, and that same year games with names like “dungeon” and “dnd” started popping up on university mainframe computers.</p></li>
<li><p>You’ve used the Random class to create numbers. The idea of games based on random numbers has a long history—for example, tabletop games that use dice, cards, spinners, and other sources of randomness.</p></li>
<li><p>We saw in the last chapter how a paper prototype can be a valuable first step in designing a video game. Paper prototypes have a strong resemblance to tabletop games. In fact, you can often turn the paper prototype of a video game into a playable tabletop game, and use it to test some game mechanics.</p></li>
<li><p>You can use tabletop games—especially card games and board games—as learning tools to understand the more general concept of game mechanics. Dealing, shuffling, dice rolling, rules for moving pieces around the board, use of a sand timer, and rules for cooperative play are all examples of mechanics.</p></li>
<li><p>The mechanics of Go Fish include dealing cards, asking another player for a card, saying “Go Fish” when asked for a card you don’t have, determining the winner, etc. Take a minute and read the rules here: <a href="https://en.wikipedia.org/wiki/Go_Fish#The_game">https://en.wikipedia.org/wiki/Go_Fish#The_game</a>.</p></li>
</ul>
</div></aside>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>If you’ve never played Go Fish, take a few minutes and read the rules. We’ll use them later in the book!</p>
</div>
<p><strong>Even if we’re not writing code for video games, there’s a lot we can learn from tabletop games.</strong></p>
<p>A lot of our programs depend on <strong>random numbers</strong>. For example, you’ve already used the Random class to create random numbers for several of your apps. Most of us don’t actually have a lot of real-world experience with genuine random numbers…except when we play games. Rolling dice, shuffling cards, spinning spinners, flipping coins…these are all great examples of <strong>random number generators</strong>. The Random class is .NET’s random number generator—you’ll use it in many of your programs, and your experience using random numbers when playing tabletop games will make it a lot easier for you to understand what it does.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/206fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="a_random_test_drive">
<h5><span class="inlineimage"><img alt="Images" src="assets/207fig01.png"/></span> A random test drive</h5>
<p><a data-primary="casting" data-secondary="converting random double to other types" data-type="indexterm" id="idm46402345692920"/><a data-primary="Convert class" data-type="indexterm" id="idm46402345689784"/><a data-primary="NextDouble method" data-type="indexterm" id="idm46402345689048"/><a data-primary="Random class" data-type="indexterm" id="idm46402345688312"/>You’ll be using the .NET Random class throughout the book, so let’s get to know it better by kicking its tires and taking it for a spin. Fire up Visual Studio and follow along—and make sure you run your code multiple times, since you’ll get different random numbers each time.</p>
</div></aside>
<ol>
<li><p><strong>Create a new console app</strong>—all of this code will go in the Main method. Start by creating a new instance of Random, generating a random int, and writing it to the console:</p>
<pre data-type="programlisting"> Random random = new Random();
 int randomInt = random.Next();
 Console.WriteLine(randomInt);</pre>
<p>Specify a <strong>maximum value</strong> to get random numbers from 0 up to—but <u>not including</u>—the maximum value. A maximum of 10 generates random numbers from 0 to 9:</p>
<pre data-type="programlisting"> int zeroToNine = random.Next(10);
 Console.WriteLine(zeroToNine);</pre></li>
<li><p>Now <strong>simulate the roll of a die</strong>. You can specify a minimum and maximum value. A minimum of 1 and maximum of 7 generates random numbers from 1 to 6:</p>
<pre data-type="programlisting"> int dieRoll = random.Next(1, 7);
 Console.WriteLine(dieRoll);</pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/207fig02.png"/>
<h6/>
</div></figure>
</li>
<li><p>The <strong>NextDouble method</strong> generates random double values. Hover over the method name to see a tooltip—it generates a floating-point number from 0.0 up to 1.0:</p>
<pre data-type="programlisting"> double randomDouble = random.NextDouble();</pre>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/207fig03.png"/>
<h6/>
</div></figure>
<p>You can use <strong>multiply a random double</strong> to generate much larger random numbers. So if you want a random double value from 1 to 100, multiply the random double by 100:</p>
<pre data-type="programlisting"> Console.WriteLine(randomDouble * 100);</pre>
<p>Use <strong>casting</strong> to convert the random double to other types. Try running this code a bunch of times—you’ll see tiny precision differences in the float and decimal values.</p>
<pre data-type="programlisting"> Console.WriteLine((float)randomDouble * 100F);
 Console.WriteLine((decimal)randomDouble * 100M);</pre></li>
<li><p>Use a maximum value of 2 to <strong>simulate a coin toss</strong>. That generates a random value of either 0 or 1. Use the special <strong>Convert class</strong>, which has a static ToBoolean method that will convert it to a Boolean value:</p>
<pre data-type="programlisting"> int zeroOrOne = random.Next(2);
 bool coinFlip = Convert.ToBoolean(zeroOrOne);
 Console.WriteLine(coinFlip);</pre>
</li>
</ol>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-idd0010">
<h5><span class="inlineimage"><img alt="Images" src="assets/brainpower.png"/></span> Brain Power</h5>
<p>How would you use Random to choose a random string from an array of strings?</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/207fig04.png"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-pdf-bookmark="Welcome to Sloppy Joe’s Budget House o’ Discount Sandwiches!" data-type="sect1"><div class="sect1" id="welcome_to_sloppy_joeapostrophes_budget">
<h1>Welcome to Sloppy Joe’s Budget House o’ Discount Sandwiches!</h1>
<p>
Sloppy Joe has a pile of meat, a whole lotta bread, and more condiments than you can shake a stick at. What he doesn’t have is a menu! Can you build a program that makes a new <em>random</em> menu for him every day? You definitely can…with a <strong>new WPF app</strong>, some arrays, and a couple of useful new techniques.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-primary="collection initializers" data-type="indexterm" id="idm46402345660472"/><a data-primary="randomizing results" data-type="indexterm" id="idm46402345659176"/><a data-primary="Sloppy Joe’s Random Menu Item project" data-type="indexterm" id="idm46402345658440"/><a data-primary="WPF (Windows Presentation Foundation)" data-type="indexterm" id="idm46402345657672"/>Do this!</p>
</div>
<ol>
<li><p><strong>Add a new MenuItem class to your project and add its fields.</strong></p>
<p>Have a look at the class diagram. It has four fields: an instance of Random and three arrays to hold the various sandwich parts. The array fields use <strong>collection initializers</strong>, which let you define the items in an array by putting them inside curly braces.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/208fig01.png"/>
<h6/>
</div></figure>
<pre data-type="programlisting">class MenuItem
{
    public Random Randomizer = new Random();

    public string[] Proteins = { "Roast beef", "Salami", "Turkey",
                "Ham", "Pastrami", "Tofu" };
    public string[] Condiments = { "yellow mustard", "brown mustard",
                "honey mustard", "mayo", "relish", "french dressing" };
    public string[] Breads = { "rye", "white", "wheat", "pumpernickel", "a roll" };

           public string Description = "";
           public string Price;
}</pre></li>
<li><p><strong>Add the GenerateMenuItem method to the MenuItem class.</strong></p>
<p>This method uses the same Random.Next method you’ve seen many times to pick random items from the arrays in the Proteins, Condiments, and Breads fields and concatenate them together into a string.</p>
<pre data-type="programlisting">public void Generate()
{
    string randomProtein = Proteins[Randomizer.Next(Proteins.Length)];
    string randomCondiment = Condiments[Randomizer.Next(Condiments.Length)];
    string randomBread = Breads[Randomizer.Next(Breads.Length)];
    Description = randomProtein + " with " + randomCondiment + " on " + randomBread;

    decimal bucks = Randomizer.Next(2, 5);
    decimal cents = Randomizer.Next(1, 98);
    decimal price = bucks + (cents * .01M);
   Price = price.ToString("c");
}</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>This method makes a random price between 2.01 and 5.97 by converting two random ints to decimals. Have a close look at the last line—it returns</strong> <code><strong>price.ToString("c")</strong></code>. <strong>The parameter to the ToString method is a format. In this case, the</strong> <code><strong>"c"</strong></code> <strong>format tells ToString to format the value with the local currency: if you’re in the United States you’ll see a $; in the UK you’ll get a £, in the EU you’ll see €, etc.</strong></p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Go to the Visual Studio for Mac Learner’s Guide for the Mac version of this project.</strong></p>
</div></li>
<li><p><strong>Create the XAML to lay out the window.</strong></p>
<p>Your app will display random menu items in a window with two columns, a wide one for the menu item and a narrow one for the price. Each cell in the grid has a TextBlock control with its FontSize set to <code><strong>18px</strong></code>—except for the bottom row, which just has a single right-aligned TextBlock that spans both columns. The window’s title is “Welcome to Sloppy Joe’s Budget House o’ Discount Sandwiches!” and it’s got a height of <code><strong>350</strong></code> and width of <code><strong>550</strong></code>. The grid has a margin of <code><strong>20</strong></code>.</p>
<p>We’re building on the XAML you learned in the last two WPF projects. You can lay it out in the designer, type it in by hand, or do some of each.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/209fig01.png"/>
<h6/>
</div></figure></li>
<li><p><strong>Add the code-behind for your XAML window.</strong></p>
<p>The menu is generated by a method called MakeTheMenu, which your window calls right after it calls InitializeComponent. It uses an array of MenuItem classes to generate each item in the menu. We want the first three items to be normal menu items. The next two are only served on bagels. The last is a special item with its own set of ingredients.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/210fig01.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="how_its_works">
<h5><span class="inlineimage"><img alt="Images" src="assets/zoom.png"/></span> How its works</h5>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/211fig01.png"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/211fig01a.png"/>
<h6/>
</div></figure>
</div></aside></li>
<li><p><a data-primary="pseudo-random number generator" data-type="indexterm" id="idm46402345626824"/><span class="inlineimage"><img alt="Images" src="assets/in_five.png"/></span> <strong>Run your program and behold the new randomly generated menu.</strong></p></li>
</ol>
<p>Uh…something’s wrong. The prices on the menu are all the same, and the menu items are weird—the first three are the same, so are the next two, and they all seem to have the same protein. What’s going on?</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">If your computer is fast enough, your program may not run into this problem. If you run it on a much slower computer, you’ll see it.</span></p>
</div>
<p>It turns out that the .NET Random class is actually a <strong>pseudo-random number</strong> generator, which means that it uses a mathematical formula to generate a sequence of numbers that can pass certain statistical tests for randomness. That makes them good enough to use in any app we’ll build (but don’t use it as part of a security system that depends on truly random numbers!). That’s why the method is called Next—you’re getting the next number in the sequence. The formula starts with a “seed value” —it uses that value to find the next one in the sequence. When you create a new instance of Random, it uses the system clock to “seed” the formula, but you can provide your own seed. Try using the C# Interactive window to call <code><strong>new</strong></code> <code><strong>Random(12345).Next();</strong></code> a bunch of times. You’re telling it to create a new instance of Random with the same seed value (12345), so the Next method will give you the same “random” number each time.</p>
<p>When you see a bunch of different instances of Random give you the same value, it’s because they were all seeded close enough that the system clock didn’t change time, so they all have the same seed value. So how do we fix this? Use a single instance of Random by making the Randomizer field static so all MenuItems share a single Random instance:</p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">public</span> <code><strong>static</strong></code><span style="color:#9D9EA0;"> Random Randomizer = new Random();</span></pre>
<p>Run your program again—now the menu will be randomized.</p>
<figure class="informal"><div class="figure">
<img alt="Images" src="assets/211fig02.png"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-idd0008">
<h5>Bullet Points</h5>
<ul>
<li><p><a data-primary="{ } (curly brackets)" data-type="indexterm" id="idm46402345611576"/><a data-primary="CIL (Common Intermediate Language)" data-type="indexterm" id="idm46402345610536"/><a data-primary="CLR (Common Language Runtime)" data-type="indexterm" id="idm46402345609624"/><a data-primary="garbage collection" data-type="indexterm" id="idm46402345608072"/><a data-primary="null" data-type="indexterm" id="idm46402345607224"/><a data-primary="this keyword" data-type="indexterm" id="idm46402345606424"/>The <code><strong>new</strong></code> keyword <strong>returns a reference to an object</strong> that you can store in a reference variable.</p></li>
<li><p>You can have <strong>multiple references to the same object</strong>. You can change an object with one reference and access the results of that change with another.</p></li>
<li><p>For an object to stay in the heap, it has to be <strong>referenced</strong>. Once the last reference to an object disappears, it eventually gets garbage-collected and the memory it used is reclaimed.</p></li>
<li><p>Your .NET programs run in the <strong>Common Language Runtime</strong>, a “layer” between the OS and your program. The C# compiler builds your code into <strong>Common Intermediate Language (CIL)</strong>, which the CLR executes.</p></li>
<li><p>The <code><strong>this</strong></code> <strong>keyword</strong> lets an object get a reference to itself.</p></li>
<li><p><strong>Arrays</strong> are objects that hold multiple values. They can contain either values or references.</p></li>
<li><p><strong>Declare array variables</strong> by putting square brackets after the type in the variable declaration (like <code><strong>bool[] trueFalseValues</strong></code> or <code><strong>Dog[] kennel</strong></code>).</p></li>
<li><p>Use the <code><strong>new</strong></code> keyword to <strong>create a new array</strong>, specifying the array length in square brackets (like <code><strong>new bool[15]</strong></code> or <code><strong>new Dog[3]</strong></code>).</p></li>
<li><p>Use the Length <strong>method</strong> on an array to get its length (like kennel.Length).</p></li>
<li><p>Access an array value using its <strong>index</strong> in square brackets (like <code><strong>bool[3]</strong></code> or <code><strong>Dog[0]</strong></code>). Array indexes start at 0.</p></li>
<li><p><code><strong>null</strong></code> means a reference points to nothing. The <code><strong>null</strong></code> keyword is useful for testing if a reference is null, or clearing a reference variable so an object will get marked for garbage collection.</p></li>
<li><p>Use <strong>collection initializers</strong> to initialize an array by setting the array equal to the <code><strong>new</strong></code> keyword followed by the array type followed by a comma-delimited list in curly braces (like <code><strong>new int[] { 8, 6, 7, 5, 3, 0, 9 }</strong></code>). The array type is optional when setting a variable or field value in the same statement where it’s declared.</p></li>
<li><p>You can pass a <strong>format parameter</strong> to an object or value’s ToString method. If you’re calling a numeric type’s ToString method, passing it a value of <code><strong>"c"</strong></code> formats the value as a local currency.</p></li>
<li><p>The .NET Random class is a pseudo-random number generator seeded by the system clock. Use a single instance of Random to avoid multiple instances with the same seed generating the same sequence of numbers.</p></li>
</ul>
</div></aside>
</div></section>
</div></section></body></html>